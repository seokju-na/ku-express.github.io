{"version":3,"sources":["webpack:///webpack/bootstrap 8e7fd15dbc4ef4789602","webpack:///./src/vr/utils.js","webpack:///./src/ground/index.js","webpack:///./src/roller-coaster-lifter/index.js","webpack:///./src/roller-coaster-shadow/index.js","webpack:///./src/roller-coaster/index.js","webpack:///./src/vr/control.js","webpack:///./src/vr/effect.js","webpack:///./src/main.js","webpack:///./src/roller-coaster-lifter/geometry.js","webpack:///./src/roller-coaster-shadow/geometry.js","webpack:///./src/roller-coaster/roller-coaster.js"],"names":["isWebVRAvailable","navigator","getVRDisplays","undefined","getVRDisplay","callback","then","displays","catch","error","getHelpMessageElement","makeMessageElement","message","container","document","createElement","style","position","left","top","right","zIndex","align","fontFamily","fontSize","fontStyle","lineHeight","backgroundColor","color","padding","margin","display","innerHTML","appendChild","err","vrDisplay","getButton","canvas","button","bottom","width","border","cursor","textAlign","textContent","onclick","onButtonClick","isPresenting","exitPresent","requestPresent","source","window","addEventListener","groundMeshFactory","scene","height","geometry","THREE","PlaneBufferGeometry","applyMatrix","Matrix4","makeRotationX","Math","PI","positions","attributes","array","vertex","Vector3","i","length","fromArray","x","random","z","distance","distanceTo","y","max","toArray","computeVertexNormals","material","MeshLambertMaterial","mesh","Mesh","add","rollerCoasterLifterMeshFactory","curve","divisions","MeshPhongMaterial","rollerCoasterShadowMeshFactory","MeshBasicMaterial","depthWrite","transparent","rollerCoasterMeshFactory","vertexColors","VertexColors","VRControl","constructor","object","standingMatrix","scale","standing","userHeight","frameData","init","onError","VRFrameData","console","warn","setVRDisplay","value","getStandingMaxtrix","update","getFrameData","pose","orientation","quaternion","set","stageParameters","updateMatrix","sittingToStandingTransform","setY","dispose","VREffect","renderer","vrDisplays","eyeTranslationL","eyeTranslationR","renderRectL","renderRectR","gotVRDisplays","scope","rendererSize","getSize","rendererUpdateStyle","rendererPixelRatio","getPixelRatio","setSize","updateStyle","eyeParamsL","getEyeParameters","setPixelRatio","renderWidth","renderHeight","domElement","defaultLeftBounds","defaultRightBounds","onVRDisplayPresentChange","wasPresenting","eyeWidth","eyeHeight","setFullScreen","boolean","Promise","resolve","reject","Error","requestAnimationFrame","f","cancelAnimationFrame","h","submitFrame","autoSubmitFrame","cameraL","PerspectiveCamera","layers","enable","cameraR","render","camera","renderTarget","forceClear","autoUpdate","updateMatrixWorld","eyeParamsR","offset","Array","isArray","size","getLayers","leftBounds","rightBounds","layer","round","setRenderTarget","scissorTest","setScissorTest","autoClear","clear","parent","matrixWorld","decompose","copy","translateOnAxis","depthNear","near","depthFar","far","projectionMatrix","elements","leftProjectionMatrix","rightProjectionMatrix","fovToProjection","fieldOfView","viewport","scissor","setViewport","setScissor","removeEventListener","fovToNDCScaleOffset","fov","pxscale","leftTan","rightTan","pxoffset","pyscale","upTan","downTan","pyoffset","fovPortToProjection","rightHanded","zNear","zFar","handednessScale","mobj","m","scaleAndOffset","transpose","DEG2RAD","fovPort","tan","upDegrees","downDegrees","leftDegrees","rightDegrees","vrUtils","element","body","WebGLRenderer","antialias","setClearColor","devicePixelRatio","innerWidth","innerHeight","Scene","light","HemisphereLight","train","Object3D","PI2","v1","v2","getPointAt","t","p","sin","cos","multiplyScalar","getTangentAt","delta","t1","t2","min","sub","normalize","rollerCoasterMesh","rollerCoasterLifterMesh","rollerCoasterShadowMesh","background","CubeTextureLoader","setPath","load","control","effect","buttonElem","aspect","updateProjectionMatrix","tangent","lookAt","velocity","progress","prevTime","performance","now","animate","time","RollerCoasterLiftersGeometry","BufferGeometry","call","vertices","normals","Quaternion","up","point","tube1","tube2","tube3","vector1","vector2","vector3","vector4","normal1","normal2","normal3","normal4","extrudeShape","shape","fromPoint","toPoint","j","jl","point1","point2","applyQuaternion","push","angle","atan2","setFromAxisAngle","addAttribute","BufferAttribute","Float32Array","prototype","Object","create","RollerCoasterShadowGeometry","forward","prevQuaternion","prevPoint","subVectors","RollerCoasterGeometry","colors","color1","color2","step","step1","sides","vector","normal","drawShape","extrudeShapeSide","crossVectors"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;;AChEO,SAASA,gBAAT,GAA4B;AAC/B,WAAOC,UAAUC,aAAV,KAA4BC,SAAnC;AACH;;AAEM,SAASC,YAAT,CAAsBC,QAAtB,EAAgC;AACnC,QAAI,CAACL,kBAAL,EAAyB;AACrBK,iBAAS,gCAAT,EAA2C,IAA3C;AACA;AACH;;AAEDJ,cACKC,aADL,GAEKI,IAFL,CAEWC,QAAD,IAAc;AAChBF,iBAAS,IAAT,EAAeE,SAAS,CAAT,CAAf;AACH,KAJL,EAKKC,KALL,CAKYC,KAAD,IAAW;AACdJ,iBAASI,KAAT,EAAgB,IAAhB;AACH,KAPL;AAQH;;AAEM,SAASC,qBAAT,CAA+BL,QAA/B,EAAyC;AAC5C,UAAMM,qBAAsBC,OAAD,IAAa;AACpC,cAAMC,YAAYC,SAASC,aAAT,CAAuB,KAAvB,CAAlB;AACAF,kBAAUG,KAAV,CAAgBC,QAAhB,GAA2B,UAA3B;AACAJ,kBAAUG,KAAV,CAAgBE,IAAhB,GAAuB,GAAvB;AACAL,kBAAUG,KAAV,CAAgBG,GAAhB,GAAsB,GAAtB;AACAN,kBAAUG,KAAV,CAAgBI,KAAhB,GAAwB,GAAxB;AACAP,kBAAUG,KAAV,CAAgBK,MAAhB,GAAyB,KAAzB;AACAR,kBAAUS,KAAV,GAAkB,QAAlB;;AAEA,cAAMb,QAAQK,SAASC,aAAT,CAAuB,KAAvB,CAAd;AACAN,cAAMO,KAAN,CAAYO,UAAZ,GAAyB,YAAzB;AACAd,cAAMO,KAAN,CAAYQ,QAAZ,GAAuB,MAAvB;AACAf,cAAMO,KAAN,CAAYS,SAAZ,GAAwB,QAAxB;AACAhB,cAAMO,KAAN,CAAYU,UAAZ,GAAyB,MAAzB;AACAjB,cAAMO,KAAN,CAAYW,eAAZ,GAA8B,MAA9B;AACAlB,cAAMO,KAAN,CAAYY,KAAZ,GAAoB,MAApB;AACAnB,cAAMO,KAAN,CAAYa,OAAZ,GAAsB,WAAtB;AACApB,cAAMO,KAAN,CAAYc,MAAZ,GAAqB,MAArB;AACArB,cAAMO,KAAN,CAAYe,OAAZ,GAAsB,cAAtB;AACAtB,cAAMuB,SAAN,GAAkBpB,OAAlB;AACAC,kBAAUoB,WAAV,CAAsBxB,KAAtB;;AAEAJ,iBAASQ,SAAT;AACH,KAvBD;;AAyBAT,iBAAa,CAAC8B,GAAD,EAAMC,SAAN,KAAoB;AAC7B,YAAID,GAAJ,EAAS;AACLvB,+BAAmB,qGAAnB;AACH,SAFD,MAEO,IAAI,CAACwB,SAAL,EAAgB;AACnBxB,+BAAmB,2CAAnB;AACH,SAFM,MAEA;AACHN,qBAAS,IAAT;AACH;AACJ,KARD;AASH;;AAEM,SAAS+B,SAAT,CAAmBL,OAAnB,EAA4BM,MAA5B,EAAoC;AACvC,UAAMC,SAASxB,SAASC,aAAT,CAAuB,QAAvB,CAAf;AACAuB,WAAOtB,KAAP,CAAaC,QAAb,GAAwB,UAAxB;AACAqB,WAAOtB,KAAP,CAAaE,IAAb,GAAoB,kBAApB;AACAoB,WAAOtB,KAAP,CAAauB,MAAb,GAAsB,MAAtB;AACAD,WAAOtB,KAAP,CAAawB,KAAb,GAAqB,OAArB;AACAF,WAAOtB,KAAP,CAAayB,MAAb,GAAsB,GAAtB;AACAH,WAAOtB,KAAP,CAAaa,OAAb,GAAuB,KAAvB;AACAS,WAAOtB,KAAP,CAAa0B,MAAb,GAAsB,SAAtB;AACAJ,WAAOtB,KAAP,CAAaW,eAAb,GAA+B,MAA/B;AACAW,WAAOtB,KAAP,CAAaY,KAAb,GAAqB,MAArB;AACAU,WAAOtB,KAAP,CAAaO,UAAb,GAA0B,YAA1B;AACAe,WAAOtB,KAAP,CAAaQ,QAAb,GAAwB,MAAxB;AACAc,WAAOtB,KAAP,CAAaS,SAAb,GAAyB,QAAzB;AACAa,WAAOtB,KAAP,CAAa2B,SAAb,GAAyB,QAAzB;AACAL,WAAOtB,KAAP,CAAaK,MAAb,GAAsB,KAAtB;;AAEA,QAAIU,OAAJ,EAAa;AACTO,eAAOM,WAAP,GAAqB,UAArB;AACAN,eAAOO,OAAP,GAAiB,SAASC,aAAT,GAAyB;AACtCf,oBAAQgB,YAAR,GAAuBhB,QAAQiB,WAAR,EAAvB,GAA+CjB,QAAQkB,cAAR,CAAuB,CAAC,EAAEC,QAAQb,MAAV,EAAD,CAAvB,CAA/C;AACH,SAFD;;AAIAc,eAAOC,gBAAP,CAAwB,wBAAxB,EAAkD,MAAM;AACpDd,mBAAOM,WAAP,GAAqBb,QAAQgB,YAAR,GAAuB,SAAvB,GAAmC,UAAxD;AACH,SAFD;AAGH,KATD,MASO;AACHT,eAAOM,WAAP,GAAqB,eAArB;AACH;;AAED,WAAON,MAAP;AACH,C;;;;;;;;ACxFM,SAASe,iBAAT,CAA2BC,KAA3B,EAAkCd,KAAlC,EAAyCe,MAAzC,EAAiD;AACpD,UAAMC,WAAW,IAAIC,MAAMC,mBAAV,CAA8BlB,KAA9B,EAAqCe,MAArC,EAA6C,EAA7C,EAAiD,EAAjD,CAAjB;AACAC,aAASG,WAAT,CAAqB,IAAIF,MAAMG,OAAV,GAAoBC,aAApB,CAAkC,CAACC,KAAKC,EAAN,GAAW,CAA7C,CAArB;;AAEA,UAAMC,YAAYR,SAASS,UAAT,CAAoBhD,QAApB,CAA6BiD,KAA/C;AACA,UAAMC,SAAS,IAAIV,MAAMW,OAAV,EAAf;;AAEA,SAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIL,UAAUM,MAA9B,EAAsCD,KAAK,CAA3C,EAA8C;AAC1CF,eAAOI,SAAP,CAAiBP,SAAjB,EAA4BK,CAA5B;AACAF,eAAOK,CAAP,IAAYV,KAAKW,MAAL,KAAgB,EAAhB,GAAqB,CAAjC;AACAN,eAAOO,CAAP,IAAYZ,KAAKW,MAAL,KAAgB,EAAhB,GAAqB,CAAjC;AACA,cAAME,WAAaR,OAAOS,UAAP,CAAkBtB,MAAMrC,QAAxB,IAAoC,CAAtC,GAA4C,EAA7D;AACAkD,eAAOU,CAAP,GAAWf,KAAKW,MAAL,KAAgBX,KAAKgB,GAAL,CAAS,CAAT,EAAYH,QAAZ,CAA3B;AACAR,eAAOY,OAAP,CAAef,SAAf,EAA0BK,CAA1B;AACH;AACDb,aAASwB,oBAAT;;AAEA,UAAMC,WAAW,IAAIxB,MAAMyB,mBAAV,CAA8B;AAC3CtD,eAAO;AADoC,KAA9B,CAAjB;;AAIA,UAAMuD,OAAO,IAAI1B,MAAM2B,IAAV,CAAgB5B,QAAhB,EAA0ByB,QAA1B,CAAb;AACA3B,UAAM+B,GAAN,CAAUF,IAAV;AACH,C;;;;;;;;;ACvBD;;AAEO,SAASG,8BAAT,CAAwCC,KAAxC,EAA+CC,SAA/C,EAA0D;AAC7D,UAAMhC,WAAW,IAAI,0DAAJ,CAAgC+B,KAAhC,EAAuCC,SAAvC,CAAjB;AACA,UAAMP,WAAW,IAAIxB,MAAMgC,iBAAV,EAAjB;AACA,UAAMN,OAAO,IAAI1B,MAAM2B,IAAV,CAAe5B,QAAf,EAAyByB,QAAzB,CAAb;;AAEAE,SAAKlE,QAAL,CAAc4D,CAAd,GAAkB,GAAlB;;AAEA,WAAOM,IAAP;AACH,C;;;;;;;;;ACVD;;AAEO,SAASO,8BAAT,CAAwCH,KAAxC,EAA+CC,SAA/C,EAA0D;AAC7D,UAAMhC,WAAW,IAAI,0DAAJ,CAAgC+B,KAAhC,EAAuCC,SAAvC,CAAjB;AACA,UAAMP,WAAW,IAAIxB,MAAMkC,iBAAV,CAA4B;AACzC/D,eAAO,QADkC,EACxBgE,YAAY,KADY,EACLC,aAAa;AADR,KAA5B,CAAjB;AAGA,UAAMV,OAAO,IAAI1B,MAAM2B,IAAV,CAAe5B,QAAf,EAAyByB,QAAzB,CAAb;;AAEAE,SAAKlE,QAAL,CAAc4D,CAAd,GAAkB,GAAlB;;AAEA,WAAOM,IAAP;AACH,C;;;;;;;;;ACZD;;AAEO,SAASW,wBAAT,CAAkCP,KAAlC,EAAyCC,SAAzC,EAAoD;AACvD,UAAMhC,WAAW,IAAI,gEAAJ,CAA0B+B,KAA1B,EAAiCC,SAAjC,CAAjB;AACA,UAAMP,WAAW,IAAIxB,MAAMgC,iBAAV,CAA4B;AACzCM,sBAActC,MAAMuC;AADqB,KAA5B,CAAjB;;AAIA,WAAO,IAAIvC,MAAM2B,IAAV,CAAe5B,QAAf,EAAyByB,QAAzB,CAAP;AACH,C;;;;;;;;ACTD;;AAEA,MAAMgB,SAAN,CAAgB;AACZC,gBAAYC,MAAZ,EAAoB;AAChB,aAAKA,MAAL,GAAcA,MAAd;;AAEA,aAAKC,cAAL,GAAsB,IAAI3C,MAAMG,OAAV,EAAtB;AACA,aAAKyC,KAAL,GAAa,CAAb;AACA,aAAKC,QAAL,GAAgB,KAAhB;AACA,aAAKC,UAAL,GAAkB,GAAlB;AACA,aAAKC,SAAL,GAAiB,IAAjB;AACH;;AAEDC,SAAKC,OAAL,EAAc;AACV,YAAI,iBAAiBvD,MAArB,EAA6B;AACzB,iBAAKqD,SAAL,GAAiB,IAAIrD,OAAOwD,WAAX,EAAjB;AACH;;AAED,YAAI,uFAAA3G,EAAJ,EAAwB;AACpBI,YAAA,mFAAAA,CAAa,CAAC8B,GAAD,EAAMC,SAAN,KAAoB;AAC7B,oBAAID,GAAJ,EAAS;AACL0E,4BAAQC,IAAR,CAAa3E,GAAb;AACH,iBAFD,MAEO,IAAI,CAACC,SAAL,EAAgB;AACnBuE,4BAAQ,yBAAR;AACH,iBAFM,MAEA;AACH,yBAAKvE,SAAL,GAAiBA,SAAjB;AACH;AACJ,aARD;AASH;AACJ;;AAED/B,mBAAe;AACX,eAAO,KAAK+B,SAAZ;AACH;;AAED2E,iBAAaC,KAAb,EAAoB;AAChB,aAAK5E,SAAL,GAAiB4E,KAAjB;AACH;;AAEDC,yBAAqB;AACjB,eAAO,KAAKZ,cAAZ;AACH;;AAEDa,aAAS;AACL,YAAI,CAAC,KAAK9E,SAAV,EAAqB;AACjB;AACH;;AAED,aAAKA,SAAL,CAAe+E,YAAf,CAA4B,KAAKV,SAAjC;;AAEA,cAAMW,OAAO,KAAKX,SAAL,CAAeW,IAA5B;;AAEA,YAAIA,KAAKC,WAAL,KAAqB,IAAzB,EAA+B;AAC3B,iBAAKjB,MAAL,CAAYkB,UAAZ,CAAuB9C,SAAvB,CAAiC4C,KAAKC,WAAtC;AACH;;AAED,YAAID,KAAKlG,QAAL,KAAkB,IAAtB,EAA4B;AACxB,iBAAKkF,MAAL,CAAYlF,QAAZ,CAAqBsD,SAArB,CAA+B4C,KAAKlG,QAApC;AACH,SAFD,MAEO;AACH,iBAAKkF,MAAL,CAAYlF,QAAZ,CAAqBqG,GAArB,CAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B;AACH;;AAED,YAAI,KAAKhB,QAAT,EAAmB;AACf,gBAAI,KAAKnE,SAAL,CAAeoF,eAAnB,EAAoC;AAChC,qBAAKpB,MAAL,CAAYqB,YAAZ;AACA,qBAAKpB,cAAL,CAAoB7B,SAApB,CAA8B,KAAKpC,SAAL,CAAeoF,eAAf,CAA+BE,0BAA7D;AACA,qBAAKtB,MAAL,CAAYxC,WAAZ,CAAwB,KAAKyC,cAA7B;AACH,aAJD,MAIO;AACH,qBAAKD,MAAL,CAAYlF,QAAZ,CAAqByG,IAArB,CAA0B,KAAKvB,MAAL,CAAYlF,QAAZ,CAAqB4D,CAArB,GAAyB,KAAK0B,UAAxD;AACH;AACJ;AACJ;;AAEDoB,cAAU;AACN,aAAKxF,SAAL,GAAiB,IAAjB;AACH;AAzEW;;AA4EhB,yDAAe8D,SAAf,E;;;;;;;AC9EA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4NA,SAAS2B,QAAT,CAAkBC,QAAlB,EAA4BnB,OAA5B,EAAqC;;AAEjC,QAAIvE,SAAJ,EAAe2F,UAAf;AACA,QAAIC,kBAAkB,IAAItE,MAAMW,OAAV,EAAtB;AACA,QAAI4D,kBAAkB,IAAIvE,MAAMW,OAAV,EAAtB;AACA,QAAI6D,WAAJ,EAAiBC,WAAjB;;AAEA,QAAI1B,YAAY,IAAhB;;AAEA,QAAI,iBAAiBrD,MAArB,EAA6B;;AAEzBqD,oBAAY,IAAIrD,OAAOwD,WAAX,EAAZ;AAEH;;AAED,aAASwB,aAAT,CAAuB5H,QAAvB,EAAiC;;AAE7BuH,qBAAavH,QAAb;;AAEA,YAAIA,SAAS+D,MAAT,GAAkB,CAAtB,EAAyB;;AAErBnC,wBAAY5B,SAAS,CAAT,CAAZ;AAEH,SAJD,MAIO;;AAEH,gBAAImG,OAAJ,EAAaA,QAAQ,mBAAR;AAEhB;AAEJ;;AAED,QAAIzG,UAAUC,aAAd,EAA6B;;AAEzBD,kBAAUC,aAAV,GAA0BI,IAA1B,CAA+B6H,aAA/B,EAA8C3H,KAA9C,CAAoD,YAAY;;AAE5DoG,oBAAQC,IAAR,CAAa,2CAAb;AAEH,SAJD;AAMH;;AAED;;AAEA,SAAK9D,YAAL,GAAoB,KAApB;;AAEA,QAAIqF,QAAQ,IAAZ;;AAEA,QAAIC,eAAeR,SAASS,OAAT,EAAnB;AACA,QAAIC,sBAAsB,KAA1B;AACA,QAAIC,qBAAqBX,SAASY,aAAT,EAAzB;;AAEA,SAAKrI,YAAL,GAAoB,YAAY;;AAE5B,eAAO+B,SAAP;AAEH,KAJD;;AAMA,SAAK2E,YAAL,GAAoB,UAAUC,KAAV,EAAiB;;AAEjC5E,oBAAY4E,KAAZ;AAEH,KAJD;;AAMA,SAAK7G,aAAL,GAAqB,YAAY;;AAE7B0G,gBAAQC,IAAR,CAAa,sDAAb;AACA,eAAOiB,UAAP;AAEH,KALD;;AAOA,SAAKY,OAAL,GAAe,UAAUlG,KAAV,EAAiBe,MAAjB,EAAyBoF,WAAzB,EAAsC;;AAEjDN,uBAAe,EAAC7F,OAAOA,KAAR,EAAee,QAAQA,MAAvB,EAAf;AACAgF,8BAAsBI,WAAtB;;AAEA,YAAIP,MAAMrF,YAAV,EAAwB;;AAEpB,gBAAI6F,aAAazG,UAAU0G,gBAAV,CAA2B,MAA3B,CAAjB;AACAhB,qBAASiB,aAAT,CAAuB,CAAvB;AACAjB,qBAASa,OAAT,CAAiBE,WAAWG,WAAX,GAAyB,CAA1C,EAA6CH,WAAWI,YAAxD,EAAsE,KAAtE;AAEH,SAND,MAMO;;AAEHnB,qBAASiB,aAAT,CAAuBN,kBAAvB;AACAX,qBAASa,OAAT,CAAiBlG,KAAjB,EAAwBe,MAAxB,EAAgCoF,WAAhC;AAEH;AAEJ,KAlBD;;AAoBA;;AAEA,QAAItG,SAASwF,SAASoB,UAAtB;AACA,QAAIC,oBAAoB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,CAAxB;AACA,QAAIC,qBAAqB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,CAAzB;;AAEA,aAASC,wBAAT,GAAoC;;AAEhC,YAAIC,gBAAgBjB,MAAMrF,YAA1B;AACAqF,cAAMrF,YAAN,GAAqBZ,cAAchC,SAAd,IAA2BgC,UAAUY,YAA1D;;AAEA,YAAIqF,MAAMrF,YAAV,EAAwB;;AAEpB,gBAAI6F,aAAazG,UAAU0G,gBAAV,CAA2B,MAA3B,CAAjB;AACA,gBAAIS,WAAWV,WAAWG,WAA1B;AACA,gBAAIQ,YAAYX,WAAWI,YAA3B;;AAEA,gBAAI,CAACK,aAAL,EAAoB;;AAEhBb,qCAAqBX,SAASY,aAAT,EAArB;AACAJ,+BAAeR,SAASS,OAAT,EAAf;;AAEAT,yBAASiB,aAAT,CAAuB,CAAvB;AACAjB,yBAASa,OAAT,CAAiBY,WAAW,CAA5B,EAA+BC,SAA/B,EAA0C,KAA1C;AAEH;AAEJ,SAhBD,MAgBO,IAAIF,aAAJ,EAAmB;;AAEtBxB,qBAASiB,aAAT,CAAuBN,kBAAvB;AACAX,qBAASa,OAAT,CAAiBL,aAAa7F,KAA9B,EAAqC6F,aAAa9E,MAAlD,EAA0DgF,mBAA1D;AAEH;AAEJ;;AAEDpF,WAAOC,gBAAP,CAAwB,wBAAxB,EAAkDgG,wBAAlD,EAA4E,KAA5E;;AAEA,SAAKI,aAAL,GAAqB,UAAUC,OAAV,EAAmB;;AAEpC,eAAO,IAAIC,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;;AAE1C,gBAAIzH,cAAchC,SAAlB,EAA6B;;AAEzByJ,uBAAO,IAAIC,KAAJ,CAAU,uBAAV,CAAP;AACA;AAEH;;AAED,gBAAIzB,MAAMrF,YAAN,KAAuB0G,OAA3B,EAAoC;;AAEhCE;AACA;AAEH;;AAED,gBAAIF,OAAJ,EAAa;;AAETE,wBAAQxH,UAAUc,cAAV,CAAyB,CAAC,EAACC,QAAQb,MAAT,EAAD,CAAzB,CAAR;AAEH,aAJD,MAIO;;AAEHsH,wBAAQxH,UAAUa,WAAV,EAAR;AAEH;AAEJ,SA1BM,CAAP;AA4BH,KA9BD;;AAgCA,SAAKC,cAAL,GAAsB,YAAY;;AAE9B,eAAO,KAAKuG,aAAL,CAAmB,IAAnB,CAAP;AAEH,KAJD;;AAMA,SAAKxG,WAAL,GAAmB,YAAY;;AAE3B,eAAO,KAAKwG,aAAL,CAAmB,KAAnB,CAAP;AAEH,KAJD;;AAMA,SAAKM,qBAAL,GAA6B,UAAUC,CAAV,EAAa;;AAEtC,YAAI5H,cAAchC,SAAlB,EAA6B;;AAEzB,mBAAOgC,UAAU2H,qBAAV,CAAgCC,CAAhC,CAAP;AAEH,SAJD,MAIO;;AAEH,mBAAO5G,OAAO2G,qBAAP,CAA6BC,CAA7B,CAAP;AAEH;AAEJ,KAZD;;AAcA,SAAKC,oBAAL,GAA4B,UAAUC,CAAV,EAAa;;AAErC,YAAI9H,cAAchC,SAAlB,EAA6B;;AAEzBgC,sBAAU6H,oBAAV,CAA+BC,CAA/B;AAEH,SAJD,MAIO;;AAEH9G,mBAAO6G,oBAAP,CAA4BC,CAA5B;AAEH;AAEJ,KAZD;;AAcA,SAAKC,WAAL,GAAmB,YAAY;;AAE3B,YAAI/H,cAAchC,SAAd,IAA2BiI,MAAMrF,YAArC,EAAmD;;AAE/CZ,sBAAU+H,WAAV;AAEH;AAEJ,KARD;;AAUA,SAAKC,eAAL,GAAuB,IAAvB;;AAEA;;AAEA,QAAIC,UAAU,IAAI3G,MAAM4G,iBAAV,EAAd;AACAD,YAAQE,MAAR,CAAeC,MAAf,CAAsB,CAAtB;;AAEA,QAAIC,UAAU,IAAI/G,MAAM4G,iBAAV,EAAd;AACAG,YAAQF,MAAR,CAAeC,MAAf,CAAsB,CAAtB;;AAEA,SAAKE,MAAL,GAAc,UAAUnH,KAAV,EAAiBoH,MAAjB,EAAyBC,YAAzB,EAAuCC,UAAvC,EAAmD;;AAE7D,YAAIzI,aAAaiG,MAAMrF,YAAvB,EAAqC;;AAEjC,gBAAI8H,aAAavH,MAAMuH,UAAvB;;AAEA,gBAAIA,UAAJ,EAAgB;;AAEZvH,sBAAMwH,iBAAN;AACAxH,sBAAMuH,UAAN,GAAmB,KAAnB;AAEH;;AAED,gBAAIjC,aAAazG,UAAU0G,gBAAV,CAA2B,MAA3B,CAAjB;AACA,gBAAIkC,aAAa5I,UAAU0G,gBAAV,CAA2B,OAA3B,CAAjB;;AAEAd,4BAAgBxD,SAAhB,CAA0BqE,WAAWoC,MAArC;AACAhD,4BAAgBzD,SAAhB,CAA0BwG,WAAWC,MAArC;;AAEA,gBAAIC,MAAMC,OAAN,CAAc5H,KAAd,CAAJ,EAA0B;;AAEtBsD,wBAAQC,IAAR,CAAa,+EAAb;AACAvD,wBAAQA,MAAM,CAAN,CAAR;AAEH;;AAED;AACA;AACA,gBAAI6H,OAAOtD,SAASS,OAAT,EAAX;AACA,gBAAIgC,SAASnI,UAAUiJ,SAAV,EAAb;AACA,gBAAIC,UAAJ;AACA,gBAAIC,WAAJ;;AAEA,gBAAIhB,OAAOhG,MAAX,EAAmB;;AAEf,oBAAIiH,QAAQjB,OAAO,CAAP,CAAZ;;AAEAe,6BAAaE,MAAMF,UAAN,KAAqB,IAArB,IAA6BE,MAAMF,UAAN,CAAiB/G,MAAjB,KAA4B,CAAzD,GAA6DiH,MAAMF,UAAnE,GAAgFnC,iBAA7F;AACAoC,8BAAcC,MAAMD,WAAN,KAAsB,IAAtB,IAA8BC,MAAMD,WAAN,CAAkBhH,MAAlB,KAA6B,CAA3D,GAA+DiH,MAAMD,WAArE,GAAmFnC,kBAAjG;AAEH,aAPD,MAOO;;AAEHkC,6BAAanC,iBAAb;AACAoC,8BAAcnC,kBAAd;AAEH;;AAEDlB,0BAAc;AACVzD,mBAAGV,KAAK0H,KAAL,CAAWL,KAAK3I,KAAL,GAAa6I,WAAW,CAAX,CAAxB,CADO;AAEVxG,mBAAGf,KAAK0H,KAAL,CAAWL,KAAK5H,MAAL,GAAc8H,WAAW,CAAX,CAAzB,CAFO;AAGV7I,uBAAOsB,KAAK0H,KAAL,CAAWL,KAAK3I,KAAL,GAAa6I,WAAW,CAAX,CAAxB,CAHG;AAIV9H,wBAAQO,KAAK0H,KAAL,CAAWL,KAAK5H,MAAL,GAAc8H,WAAW,CAAX,CAAzB;AAJE,aAAd;AAMAnD,0BAAc;AACV1D,mBAAGV,KAAK0H,KAAL,CAAWL,KAAK3I,KAAL,GAAa8I,YAAY,CAAZ,CAAxB,CADO;AAEVzG,mBAAGf,KAAK0H,KAAL,CAAWL,KAAK5H,MAAL,GAAc+H,YAAY,CAAZ,CAAzB,CAFO;AAGV9I,uBAAOsB,KAAK0H,KAAL,CAAWL,KAAK3I,KAAL,GAAa8I,YAAY,CAAZ,CAAxB,CAHG;AAIV/H,wBAAQO,KAAK0H,KAAL,CAAWL,KAAK5H,MAAL,GAAc+H,YAAY,CAAZ,CAAzB;AAJE,aAAd;;AAOA,gBAAIX,YAAJ,EAAkB;;AAEd9C,yBAAS4D,eAAT,CAAyBd,YAAzB;AACAA,6BAAae,WAAb,GAA2B,IAA3B;AAEH,aALD,MAKO;;AAEH7D,yBAAS4D,eAAT,CAAyB,IAAzB;AACA5D,yBAAS8D,cAAT,CAAwB,IAAxB;AAEH;;AAED,gBAAI9D,SAAS+D,SAAT,IAAsBhB,UAA1B,EAAsC/C,SAASgE,KAAT;;AAEtC,gBAAInB,OAAOoB,MAAP,KAAkB,IAAtB,EAA4BpB,OAAOI,iBAAP;;AAE5BJ,mBAAOqB,WAAP,CAAmBC,SAAnB,CAA6B5B,QAAQnJ,QAArC,EAA+CmJ,QAAQ/C,UAAvD,EAAmE+C,QAAQ/D,KAA3E;;AAEAmE,oBAAQvJ,QAAR,CAAiBgL,IAAjB,CAAsB7B,QAAQnJ,QAA9B;AACAuJ,oBAAQnD,UAAR,CAAmB4E,IAAnB,CAAwB7B,QAAQ/C,UAAhC;AACAmD,oBAAQnE,KAAR,CAAc4F,IAAd,CAAmB7B,QAAQ/D,KAA3B;;AAEA+D,oBAAQ8B,eAAR,CAAwBnE,eAAxB,EAAyCqC,QAAQ/D,KAAR,CAAc7B,CAAvD;AACAgG,oBAAQ0B,eAAR,CAAwBlE,eAAxB,EAAyCwC,QAAQnE,KAAR,CAAc7B,CAAvD;;AAEA,gBAAIrC,UAAU+E,YAAd,EAA4B;;AAExB/E,0BAAUgK,SAAV,GAAsBzB,OAAO0B,IAA7B;AACAjK,0BAAUkK,QAAV,GAAqB3B,OAAO4B,GAA5B;;AAEAnK,0BAAU+E,YAAV,CAAuBV,SAAvB;;AAEA4D,wBAAQmC,gBAAR,CAAyBC,QAAzB,GAAoChG,UAAUiG,oBAA9C;AACAjC,wBAAQ+B,gBAAR,CAAyBC,QAAzB,GAAoChG,UAAUkG,qBAA9C;AAEH,aAVD,MAUO;;AAEHtC,wBAAQmC,gBAAR,GAA2BI,gBAAgB/D,WAAWgE,WAA3B,EAAwC,IAAxC,EAA8ClC,OAAO0B,IAArD,EAA2D1B,OAAO4B,GAAlE,CAA3B;AACA9B,wBAAQ+B,gBAAR,GAA2BI,gBAAgB5B,WAAW6B,WAA3B,EAAwC,IAAxC,EAA8ClC,OAAO0B,IAArD,EAA2D1B,OAAO4B,GAAlE,CAA3B;AAEH;;AAED;AACA,gBAAI3B,YAAJ,EAAkB;;AAEdA,6BAAakC,QAAb,CAAsBvF,GAAtB,CAA0BW,YAAYzD,CAAtC,EAAyCyD,YAAYpD,CAArD,EAAwDoD,YAAYzF,KAApE,EAA2EyF,YAAY1E,MAAvF;AACAoH,6BAAamC,OAAb,CAAqBxF,GAArB,CAAyBW,YAAYzD,CAArC,EAAwCyD,YAAYpD,CAApD,EAAuDoD,YAAYzF,KAAnE,EAA0EyF,YAAY1E,MAAtF;AAEH,aALD,MAKO;;AAEHsE,yBAASkF,WAAT,CAAqB9E,YAAYzD,CAAjC,EAAoCyD,YAAYpD,CAAhD,EAAmDoD,YAAYzF,KAA/D,EAAsEyF,YAAY1E,MAAlF;AACAsE,yBAASmF,UAAT,CAAoB/E,YAAYzD,CAAhC,EAAmCyD,YAAYpD,CAA/C,EAAkDoD,YAAYzF,KAA9D,EAAqEyF,YAAY1E,MAAjF;AAEH;AACDsE,qBAAS4C,MAAT,CAAgBnH,KAAhB,EAAuB8G,OAAvB,EAAgCO,YAAhC,EAA8CC,UAA9C;;AAEA;AACA,gBAAID,YAAJ,EAAkB;;AAEdA,6BAAakC,QAAb,CAAsBvF,GAAtB,CAA0BY,YAAY1D,CAAtC,EAAyC0D,YAAYrD,CAArD,EAAwDqD,YAAY1F,KAApE,EAA2E0F,YAAY3E,MAAvF;AACAoH,6BAAamC,OAAb,CAAqBxF,GAArB,CAAyBY,YAAY1D,CAArC,EAAwC0D,YAAYrD,CAApD,EAAuDqD,YAAY1F,KAAnE,EAA0E0F,YAAY3E,MAAtF;AAEH,aALD,MAKO;;AAEHsE,yBAASkF,WAAT,CAAqB7E,YAAY1D,CAAjC,EAAoC0D,YAAYrD,CAAhD,EAAmDqD,YAAY1F,KAA/D,EAAsE0F,YAAY3E,MAAlF;AACAsE,yBAASmF,UAAT,CAAoB9E,YAAY1D,CAAhC,EAAmC0D,YAAYrD,CAA/C,EAAkDqD,YAAY1F,KAA9D,EAAqE0F,YAAY3E,MAAjF;AAEH;AACDsE,qBAAS4C,MAAT,CAAgBnH,KAAhB,EAAuBkH,OAAvB,EAAgCG,YAAhC,EAA8CC,UAA9C;;AAEA,gBAAID,YAAJ,EAAkB;;AAEdA,6BAAakC,QAAb,CAAsBvF,GAAtB,CAA0B,CAA1B,EAA6B,CAA7B,EAAgC6D,KAAK3I,KAArC,EAA4C2I,KAAK5H,MAAjD;AACAoH,6BAAamC,OAAb,CAAqBxF,GAArB,CAAyB,CAAzB,EAA4B,CAA5B,EAA+B6D,KAAK3I,KAApC,EAA2C2I,KAAK5H,MAAhD;AACAoH,6BAAae,WAAb,GAA2B,KAA3B;AACA7D,yBAAS4D,eAAT,CAAyB,IAAzB;AAEH,aAPD,MAOO;;AAEH5D,yBAASkF,WAAT,CAAqB,CAArB,EAAwB,CAAxB,EAA2B5B,KAAK3I,KAAhC,EAAuC2I,KAAK5H,MAA5C;AACAsE,yBAAS8D,cAAT,CAAwB,KAAxB;AAEH;;AAED,gBAAId,UAAJ,EAAgB;;AAEZvH,sBAAMuH,UAAN,GAAmB,IAAnB;AAEH;;AAED,gBAAIzC,MAAM+B,eAAV,EAA2B;;AAEvB/B,sBAAM8B,WAAN;AAEH;;AAED;AAEH;;AAED;;AAEArC,iBAAS4C,MAAT,CAAgBnH,KAAhB,EAAuBoH,MAAvB,EAA+BC,YAA/B,EAA6CC,UAA7C;AAEH,KApKD;;AAsKA,SAAKjD,OAAL,GAAe,YAAY;;AAEvBxE,eAAO8J,mBAAP,CAA2B,wBAA3B,EAAqD7D,wBAArD,EAA+E,KAA/E;AAEH,KAJD;;AAMA;;AAEA,aAAS8D,mBAAT,CAA6BC,GAA7B,EAAkC;;AAE9B,YAAIC,UAAU,OAAQD,IAAIE,OAAJ,GAAcF,IAAIG,QAA1B,CAAd;AACA,YAAIC,WAAW,CAAEJ,IAAIE,OAAJ,GAAcF,IAAIG,QAApB,IAAiCF,OAAjC,GAA2C,GAA1D;AACA,YAAII,UAAU,OAAQL,IAAIM,KAAJ,GAAYN,IAAIO,OAAxB,CAAd;AACA,YAAIC,WAAW,CAAER,IAAIM,KAAJ,GAAYN,IAAIO,OAAlB,IAA8BF,OAA9B,GAAwC,GAAvD;AACA,eAAO,EAACnH,OAAO,CAAC+G,OAAD,EAAUI,OAAV,CAAR,EAA4BxC,QAAQ,CAACuC,QAAD,EAAWI,QAAX,CAApC,EAAP;AAEH;;AAED,aAASC,mBAAT,CAA6BT,GAA7B,EAAkCU,WAAlC,EAA+CC,KAA/C,EAAsDC,IAAtD,EAA4D;;AAExDF,sBAAcA,gBAAgB1N,SAAhB,GAA4B,IAA5B,GAAmC0N,WAAjD;AACAC,gBAAQA,UAAU3N,SAAV,GAAsB,IAAtB,GAA6B2N,KAArC;AACAC,eAAOA,SAAS5N,SAAT,GAAqB,OAArB,GAA+B4N,IAAtC;;AAEA,YAAIC,kBAAkBH,cAAc,CAAC,GAAf,GAAqB,GAA3C;;AAEA;AACA,YAAII,OAAO,IAAIxK,MAAMG,OAAV,EAAX;AACA,YAAIsK,IAAID,KAAKzB,QAAb;;AAEA;AACA,YAAI2B,iBAAiBjB,oBAAoBC,GAApB,CAArB;;AAEA;AACAe,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAeC,eAAe9H,KAAf,CAAqB,CAArB,CAAf;AACA6H,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAeC,eAAenD,MAAf,CAAsB,CAAtB,IAA2BgD,eAA1C;AACAE,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;;AAEA;AACA;AACA;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAeC,eAAe9H,KAAf,CAAqB,CAArB,CAAf;AACA6H,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,CAACC,eAAenD,MAAf,CAAsB,CAAtB,CAAD,GAA4BgD,eAA3C;AACAE,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;;AAEA;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAeH,QAASD,QAAQC,IAAjB,IAA0B,CAACC,eAA1C;AACAE,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAiBH,OAAOD,KAAT,IAAqBA,QAAQC,IAA7B,CAAf;;AAEA;AACAG,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAeF,eAAf;AACAE,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;;AAEAD,aAAKG,SAAL;AACA,eAAOH,IAAP;AAEH;;AAED,aAAStB,eAAT,CAAyBQ,GAAzB,EAA8BU,WAA9B,EAA2CC,KAA3C,EAAkDC,IAAlD,EAAwD;;AAEpD,YAAIM,UAAUvK,KAAKC,EAAL,GAAU,KAAxB;;AAEA,YAAIuK,UAAU;AACVb,mBAAO3J,KAAKyK,GAAL,CAASpB,IAAIqB,SAAJ,GAAgBH,OAAzB,CADG;AAEVX,qBAAS5J,KAAKyK,GAAL,CAASpB,IAAIsB,WAAJ,GAAkBJ,OAA3B,CAFC;AAGVhB,qBAASvJ,KAAKyK,GAAL,CAASpB,IAAIuB,WAAJ,GAAkBL,OAA3B,CAHC;AAIVf,sBAAUxJ,KAAKyK,GAAL,CAASpB,IAAIwB,YAAJ,GAAmBN,OAA5B;AAJA,SAAd;;AAOA,eAAOT,oBAAoBU,OAApB,EAA6BT,WAA7B,EAA0CC,KAA1C,EAAiDC,IAAjD,CAAP;AAEH;AAEJ;;AAED,yDAAenG,QAAf,E;;;;;;;;;;;;;;;AC/qBA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAI,CAAC,qEAAL,EAAiC;AAC7BgH,IAAA,yEAA+BC,OAAD,IAAa;AACvC/N,iBAASgO,IAAT,CAAc7M,WAAd,CAA0B4M,OAA1B;AACH,KAFD;AAGH;;AAED,MAAMhH,WAAW,IAAIpE,MAAMsL,aAAV,CAAwB,EAAEC,WAAW,IAAb,EAAxB,CAAjB;AACAnH,SAASoH,aAAT,CAAuB,QAAvB;AACApH,SAASiB,aAAT,CAAuB3F,OAAO+L,gBAA9B;AACArH,SAASa,OAAT,CAAiBvF,OAAOgM,UAAxB,EAAoChM,OAAOiM,WAA3C;;AAEAtO,SAASgO,IAAT,CAAc7M,WAAd,CAA0B4F,SAASoB,UAAnC;;AAEA,MAAM3F,QAAQ,IAAIG,MAAM4L,KAAV,EAAd;;AAEA;AACA,MAAMC,QAAQ,IAAI7L,MAAM8L,eAAV,CAA0B,QAA1B,EAAoC,QAApC,CAAd;AACAD,MAAMrO,QAAN,CAAeqG,GAAf,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB;AACAhE,MAAM+B,GAAN,CAAUiK,KAAV;;AAEA;AACA,MAAME,QAAQ,IAAI/L,MAAMgM,QAAV,EAAd;AACAnM,MAAM+B,GAAN,CAAUmK,KAAV;AACA,MAAM9E,SAAS,IAAIjH,MAAM4G,iBAAV,CAA4B,EAA5B,EAAgClH,OAAOgM,UAAP,GAAoBhM,OAAOiM,WAA3D,EAAwE,GAAxE,EAA6E,GAA7E,CAAf;AACAI,MAAMnK,GAAN,CAAUqF,MAAV;;AAEA;AACA,MAAMgF,MAAM5L,KAAKC,EAAL,GAAU,CAAtB;AACA,MAAMwB,QAAQ,CAAC,MAAM;AACjB,UAAMoK,KAAK,IAAIlM,MAAMW,OAAV,EAAX;AACA,UAAMwL,KAAK,IAAInM,MAAMW,OAAV,EAAX;;AAEA,WAAO;AACHyL,mBAAWC,CAAX,EAAc;AACV,kBAAMC,IAAID,IAAIJ,GAAd;;AAEA,kBAAMlL,IAAIV,KAAKkM,GAAL,CAASD,IAAI,CAAb,IAAkBjM,KAAKmM,GAAL,CAASF,IAAI,CAAb,CAAlB,GAAoC,EAA9C;AACA,kBAAMlL,IAAIf,KAAKkM,GAAL,CAASD,IAAI,EAAb,IAAmB,CAAnB,GAAuBjM,KAAKmM,GAAL,CAASF,IAAI,EAAb,IAAmB,CAA1C,GAA8C,CAAxD;AACA,kBAAMrL,IAAIZ,KAAKkM,GAAL,CAASD,CAAT,IAAcjM,KAAKkM,GAAL,CAASD,IAAI,CAAb,CAAd,GAAgC,EAA1C;;AAEA,mBAAOJ,GAAGrI,GAAH,CAAO9C,CAAP,EAAUK,CAAV,EAAaH,CAAb,EAAgBwL,cAAhB,CAA+B,CAA/B,CAAP;AACH,SATE;;AAWHC,qBAAaL,CAAb,EAAgB;AACZ,kBAAMM,QAAQ,OAAd;;AAEA,kBAAMC,KAAKvM,KAAKgB,GAAL,CAAS,CAAT,EAAYgL,IAAIM,KAAhB,CAAX;AACA,kBAAME,KAAKxM,KAAKyM,GAAL,CAAS,CAAT,EAAYT,IAAIM,KAAhB,CAAX;;AAEA,mBAAOR,GACF3D,IADE,CACG,KAAK4D,UAAL,CAAgBS,EAAhB,CADH,EAEFE,GAFE,CAEE,KAAKX,UAAL,CAAgBQ,EAAhB,CAFF,EAGFI,SAHE,EAAP;AAIH;AArBE,KAAP;AAuBH,CA3Ba,GAAd;;AA6BA,MAAMC,oBAAoB,wGAAA5K,CAAyBP,KAAzB,EAAgC,IAAhC,CAA1B;AACAjC,MAAM+B,GAAN,CAAUqL,iBAAV;;AAEA;AACA,MAAMC,0BAA0B,qHAAArL,CAA+BC,KAA/B,EAAsC,GAAtC,CAAhC;AACAjC,MAAM+B,GAAN,CAAUsL,uBAAV;;AAEA;AACA,MAAMC,0BAA0B,qHAAAlL,CAA+BH,KAA/B,EAAsC,GAAtC,CAAhC;AACAjC,MAAM+B,GAAN,CAAUuL,uBAAV;;AAEA;AACA,yFAAAvN,CAAkBC,KAAlB,EAAyB,GAAzB,EAA8B,GAA9B;AACAA,MAAMuN,UAAN,GAAmB,IAAIpN,MAAMqN,iBAAV,GACdC,OADc,CACN,YADM,EAEdC,IAFc,CAET,CAAC,UAAD,EAAa,WAAb,EAA0B,SAA1B,EAAqC,YAArC,EAAmD,WAAnD,EAAgE,UAAhE,CAFS,CAAnB;;AAIA;AACA,MAAMC,UAAU,IAAI,4DAAJ,CAAcvG,MAAd,CAAhB;AACA,MAAMwG,SAAS,IAAI,2DAAJ,CAAarJ,QAAb,CAAf;;AAEAoJ,QAAQxK,IAAR;;AAEA,gEAAqB,CAACvE,GAAD,EAAMH,OAAN,KAAkB;AACnC,QAAIG,GAAJ,EAAS;AACL;AACH;;AAED,UAAMiP,aAAa,6DAAkBpP,OAAlB,EAA2B8F,SAASoB,UAApC,CAAnB;AACAnI,aAASgO,IAAT,CAAc7M,WAAd,CAA0BkP,UAA1B;AACH,CAPD;;AASAhO,OAAOC,gBAAP,CAAwB,QAAxB,EAAkC,MAAM;AACpCsH,WAAO0G,MAAP,GAAgBjO,OAAOgM,UAAP,GAAoBhM,OAAOiM,WAA3C;AACA1E,WAAO2G,sBAAP;AACAH,WAAOxI,OAAP,CAAevF,OAAOgM,UAAtB,EAAkChM,OAAOiM,WAAzC;AACH,CAJD;;AAOA;AACA,MAAMnO,WAAW,IAAIwC,MAAMW,OAAV,EAAjB;AACA,MAAMkN,UAAU,IAAI7N,MAAMW,OAAV,EAAhB;AACA,MAAMmN,SAAS,IAAI9N,MAAMW,OAAV,EAAf;;AAEA,IAAIoN,WAAW,CAAf;AACA,IAAIC,WAAW,CAAf;AACA,IAAIC,WAAWvO,OAAOwO,WAAP,CAAmBC,GAAnB,EAAf;;AAEA,SAASC,OAAT,CAAiBC,IAAjB,EAAuB;AACnBZ,WAAOpH,qBAAP,CAA6B+H,OAA7B;;AAEA,UAAMzB,QAAQ0B,OAAOJ,QAArB;;AAEAD,gBAAYD,QAAZ;AACAC,eAAWA,WAAW,CAAtB;AACAxQ,aAASgL,IAAT,CAAc1G,MAAMsK,UAAN,CAAiB4B,QAAjB,CAAd;AACAxQ,aAAS4D,CAAT,IAAc,GAAd;AACA2K,UAAMvO,QAAN,CAAegL,IAAf,CAAoBhL,QAApB;AACAqQ,YAAQrF,IAAR,CAAa1G,MAAM4K,YAAN,CAAmBsB,QAAnB,CAAb;AACAD,gBAAYF,QAAQzM,CAAR,GAAY,SAAZ,GAAwBuL,KAApC;AACAoB,eAAW1N,KAAKgB,GAAL,CAAS,OAAT,EAAkBhB,KAAKyM,GAAL,CAAS,MAAT,EAAiBiB,QAAjB,CAAlB,CAAX;AACAhC,UAAM+B,MAAN,CAAaA,OAAOtF,IAAP,CAAYhL,QAAZ,EAAsBuP,GAAtB,CAA0Bc,OAA1B,CAAb;;AAEAL,YAAQhK,MAAR;AACAiK,WAAOzG,MAAP,CAAcnH,KAAd,EAAqBoH,MAArB;;AAEAgH,eAAWI,IAAX;AACH;;AAEDZ,OAAOpH,qBAAP,CAA6B+H,OAA7B,E;;;;;;;ACtIA,SAASE,4BAAT,CAAsCxM,KAAtC,EAA6CC,SAA7C,EAAwD;;AAEpD/B,UAAMuO,cAAN,CAAqBC,IAArB,CAA0B,IAA1B;;AAEA,QAAIC,WAAW,EAAf;AACA,QAAIC,UAAU,EAAd;;AAEA,QAAI9K,aAAa,IAAI5D,MAAM2O,UAAV,EAAjB;;AAEA,QAAIC,KAAK,IAAI5O,MAAMW,OAAV,CAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,CAAT;;AAEA,QAAIkO,QAAQ,IAAI7O,MAAMW,OAAV,EAAZ;AACA,QAAIkN,UAAU,IAAI7N,MAAMW,OAAV,EAAd;;AAEA;;AAEA,QAAImO,QAAQ,CACR,IAAI9O,MAAMW,OAAV,CAAkB,CAAlB,EAAqB,IAArB,EAA2B,CAAC,IAA5B,CADQ,EAER,IAAIX,MAAMW,OAAV,CAAkB,CAAlB,EAAqB,IAArB,EAA2B,IAA3B,CAFQ,EAGR,IAAIX,MAAMW,OAAV,CAAkB,CAAlB,EAAqB,CAAC,IAAtB,EAA4B,CAA5B,CAHQ,CAAZ;;AAMA,QAAIoO,QAAQ,CACR,IAAI/O,MAAMW,OAAV,CAAkB,CAAC,IAAnB,EAAyB,CAAzB,EAA4B,IAA5B,CADQ,EAER,IAAIX,MAAMW,OAAV,CAAkB,CAAC,IAAnB,EAAyB,CAAzB,EAA4B,CAAC,IAA7B,CAFQ,EAGR,IAAIX,MAAMW,OAAV,CAAkB,IAAlB,EAAwB,CAAxB,EAA2B,CAA3B,CAHQ,CAAZ;;AAMA,QAAIqO,QAAQ,CACR,IAAIhP,MAAMW,OAAV,CAAkB,IAAlB,EAAwB,CAAxB,EAA2B,CAAC,IAA5B,CADQ,EAER,IAAIX,MAAMW,OAAV,CAAkB,IAAlB,EAAwB,CAAxB,EAA2B,IAA3B,CAFQ,EAGR,IAAIX,MAAMW,OAAV,CAAkB,CAAC,IAAnB,EAAyB,CAAzB,EAA4B,CAA5B,CAHQ,CAAZ;;AAMA,QAAIsO,UAAU,IAAIjP,MAAMW,OAAV,EAAd;AACA,QAAIuO,UAAU,IAAIlP,MAAMW,OAAV,EAAd;AACA,QAAIwO,UAAU,IAAInP,MAAMW,OAAV,EAAd;AACA,QAAIyO,UAAU,IAAIpP,MAAMW,OAAV,EAAd;;AAEA,QAAI0O,UAAU,IAAIrP,MAAMW,OAAV,EAAd;AACA,QAAI2O,UAAU,IAAItP,MAAMW,OAAV,EAAd;AACA,QAAI4O,UAAU,IAAIvP,MAAMW,OAAV,EAAd;AACA,QAAI6O,UAAU,IAAIxP,MAAMW,OAAV,EAAd;;AAEA,aAAS8O,YAAT,CAAsBC,KAAtB,EAA6BC,SAA7B,EAAwCC,OAAxC,EAAiD;;AAE7C,aAAK,IAAIC,IAAI,CAAR,EAAWC,KAAKJ,MAAM7O,MAA3B,EAAmCgP,IAAIC,EAAvC,EAA2CD,GAA3C,EAAgD;;AAE5C,gBAAIE,SAASL,MAAMG,CAAN,CAAb;AACA,gBAAIG,SAASN,MAAM,CAAEG,IAAI,CAAN,IAAYC,EAAlB,CAAb;;AAEAb,oBAAQzG,IAAR,CAAauH,MAAb;AACAd,oBAAQgB,eAAR,CAAwBrM,UAAxB;AACAqL,oBAAQrN,GAAR,CAAY+N,SAAZ;;AAEAT,oBAAQ1G,IAAR,CAAawH,MAAb;AACAd,oBAAQe,eAAR,CAAwBrM,UAAxB;AACAsL,oBAAQtN,GAAR,CAAY+N,SAAZ;;AAEAR,oBAAQ3G,IAAR,CAAawH,MAAb;AACAb,oBAAQc,eAAR,CAAwBrM,UAAxB;AACAuL,oBAAQvN,GAAR,CAAYgO,OAAZ;;AAEAR,oBAAQ5G,IAAR,CAAauH,MAAb;AACAX,oBAAQa,eAAR,CAAwBrM,UAAxB;AACAwL,oBAAQxN,GAAR,CAAYgO,OAAZ;;AAEAnB,qBAASyB,IAAT,CAAcjB,QAAQlO,CAAtB,EAAyBkO,QAAQ7N,CAAjC,EAAoC6N,QAAQhO,CAA5C;AACAwN,qBAASyB,IAAT,CAAchB,QAAQnO,CAAtB,EAAyBmO,QAAQ9N,CAAjC,EAAoC8N,QAAQjO,CAA5C;AACAwN,qBAASyB,IAAT,CAAcd,QAAQrO,CAAtB,EAAyBqO,QAAQhO,CAAjC,EAAoCgO,QAAQnO,CAA5C;;AAEAwN,qBAASyB,IAAT,CAAchB,QAAQnO,CAAtB,EAAyBmO,QAAQ9N,CAAjC,EAAoC8N,QAAQjO,CAA5C;AACAwN,qBAASyB,IAAT,CAAcf,QAAQpO,CAAtB,EAAyBoO,QAAQ/N,CAAjC,EAAoC+N,QAAQlO,CAA5C;AACAwN,qBAASyB,IAAT,CAAcd,QAAQrO,CAAtB,EAAyBqO,QAAQhO,CAAjC,EAAoCgO,QAAQnO,CAA5C;;AAEA;;AAEAoO,oBAAQ7G,IAAR,CAAauH,MAAb;AACAV,oBAAQY,eAAR,CAAwBrM,UAAxB;AACAyL,oBAAQrC,SAAR;;AAEAsC,oBAAQ9G,IAAR,CAAawH,MAAb;AACAV,oBAAQW,eAAR,CAAwBrM,UAAxB;AACA0L,oBAAQtC,SAAR;;AAEAuC,oBAAQ/G,IAAR,CAAawH,MAAb;AACAT,oBAAQU,eAAR,CAAwBrM,UAAxB;AACA2L,oBAAQvC,SAAR;;AAEAwC,oBAAQhH,IAAR,CAAauH,MAAb;AACAP,oBAAQS,eAAR,CAAwBrM,UAAxB;AACA4L,oBAAQxC,SAAR;;AAEA0B,oBAAQwB,IAAR,CAAab,QAAQtO,CAArB,EAAwBsO,QAAQjO,CAAhC,EAAmCiO,QAAQpO,CAA3C;AACAyN,oBAAQwB,IAAR,CAAaZ,QAAQvO,CAArB,EAAwBuO,QAAQlO,CAAhC,EAAmCkO,QAAQrO,CAA3C;AACAyN,oBAAQwB,IAAR,CAAaV,QAAQzO,CAArB,EAAwByO,QAAQpO,CAAhC,EAAmCoO,QAAQvO,CAA3C;;AAEAyN,oBAAQwB,IAAR,CAAaZ,QAAQvO,CAArB,EAAwBuO,QAAQlO,CAAhC,EAAmCkO,QAAQrO,CAA3C;AACAyN,oBAAQwB,IAAR,CAAaX,QAAQxO,CAArB,EAAwBwO,QAAQnO,CAAhC,EAAmCmO,QAAQtO,CAA3C;AACAyN,oBAAQwB,IAAR,CAAaV,QAAQzO,CAArB,EAAwByO,QAAQpO,CAAhC,EAAmCoO,QAAQvO,CAA3C;AAEH;AAEJ;;AAED,QAAI0O,YAAY,IAAI3P,MAAMW,OAAV,EAAhB;AACA,QAAIiP,UAAU,IAAI5P,MAAMW,OAAV,EAAd;;AAEA,SAAK,IAAIC,IAAI,CAAb,EAAgBA,KAAKmB,SAArB,EAAgCnB,GAAhC,EAAqC;;AAEjCiO,cAAMrG,IAAN,CAAW1G,MAAMsK,UAAN,CAAiBxL,IAAImB,SAArB,CAAX;AACA8L,gBAAQrF,IAAR,CAAa1G,MAAM4K,YAAN,CAAmB9L,IAAImB,SAAvB,CAAb;;AAEA,YAAIoO,QAAQ9P,KAAK+P,KAAL,CAAWvC,QAAQ9M,CAAnB,EAAsB8M,QAAQ5M,CAA9B,CAAZ;;AAEA2C,mBAAWyM,gBAAX,CAA4BzB,EAA5B,EAAgCuB,KAAhC;;AAEA;;AAEA,YAAItB,MAAMzN,CAAN,GAAU,EAAd,EAAkB;;AAEduO,sBAAU9L,GAAV,CAAc,CAAC,IAAf,EAAqB,CAAC,IAAtB,EAA4B,CAA5B;AACA8L,sBAAUM,eAAV,CAA0BrM,UAA1B;AACA+L,sBAAU/N,GAAV,CAAciN,KAAd;;AAEAe,oBAAQ/L,GAAR,CAAY,IAAZ,EAAkB,CAAC,IAAnB,EAAyB,CAAzB;AACA+L,oBAAQK,eAAR,CAAwBrM,UAAxB;AACAgM,oBAAQhO,GAAR,CAAYiN,KAAZ;;AAEAY,yBAAaX,KAAb,EAAoBa,SAApB,EAA+BC,OAA/B;;AAEAD,sBAAU9L,GAAV,CAAc,CAAC,GAAf,EAAoB,CAAC,GAArB,EAA0B,CAA1B;AACA8L,sBAAUM,eAAV,CAA0BrM,UAA1B;AACA+L,sBAAU/N,GAAV,CAAciN,KAAd;;AAEAe,oBAAQ/L,GAAR,CAAY,CAAC,GAAb,EAAkB,CAACgL,MAAMzN,CAAzB,EAA4B,CAA5B;AACAwO,oBAAQK,eAAR,CAAwBrM,UAAxB;AACAgM,oBAAQhO,GAAR,CAAYiN,KAAZ;;AAEAY,yBAAaV,KAAb,EAAoBY,SAApB,EAA+BC,OAA/B;;AAEAD,sBAAU9L,GAAV,CAAc,GAAd,EAAmB,CAAC,GAApB,EAAyB,CAAzB;AACA8L,sBAAUM,eAAV,CAA0BrM,UAA1B;AACA+L,sBAAU/N,GAAV,CAAciN,KAAd;;AAEAe,oBAAQ/L,GAAR,CAAY,GAAZ,EAAiB,CAACgL,MAAMzN,CAAxB,EAA2B,CAA3B;AACAwO,oBAAQK,eAAR,CAAwBrM,UAAxB;AACAgM,oBAAQhO,GAAR,CAAYiN,KAAZ;;AAEAY,yBAAaT,KAAb,EAAoBW,SAApB,EAA+BC,OAA/B;AAEH,SAhCD,MAgCO;;AAEHD,sBAAU9L,GAAV,CAAc,CAAd,EAAiB,CAAC,GAAlB,EAAuB,CAAvB;AACA8L,sBAAUM,eAAV,CAA0BrM,UAA1B;AACA+L,sBAAU/N,GAAV,CAAciN,KAAd;;AAEAe,oBAAQ/L,GAAR,CAAY,CAAZ,EAAe,CAACgL,MAAMzN,CAAtB,EAAyB,CAAzB;AACAwO,oBAAQK,eAAR,CAAwBrM,UAAxB;AACAgM,oBAAQhO,GAAR,CAAYiN,KAAZ;;AAEAY,yBAAaT,KAAb,EAAoBW,SAApB,EAA+BC,OAA/B;AAEH;AAEJ;;AAED,SAAKU,YAAL,CAAkB,UAAlB,EAA8B,IAAItQ,MAAMuQ,eAAV,CAA0B,IAAIC,YAAJ,CAAiB/B,QAAjB,CAA1B,EAAsD,CAAtD,CAA9B;AACA,SAAK6B,YAAL,CAAkB,QAAlB,EAA4B,IAAItQ,MAAMuQ,eAAV,CAA0B,IAAIC,YAAJ,CAAiB9B,OAAjB,CAA1B,EAAqD,CAArD,CAA5B;AACH;;AAEDJ,6BAA6BmC,SAA7B,GAAyCC,OAAOC,MAAP,CAAc3Q,MAAMuO,cAAN,CAAqBkC,SAAnC,CAAzC;;AAEA,yDAAenC,4BAAf,E;;;;;;;AC7KA,SAASsC,2BAAT,CAAqC9O,KAArC,EAA4CC,SAA5C,EAAuD;;AAEnD/B,UAAMuO,cAAN,CAAqBC,IAArB,CAA0B,IAA1B;;AAEA,QAAIC,WAAW,EAAf;;AAEA,QAAIG,KAAK,IAAI5O,MAAMW,OAAV,CAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,CAAT;AACA,QAAIkQ,UAAU,IAAI7Q,MAAMW,OAAV,EAAd;;AAEA,QAAIiD,aAAa,IAAI5D,MAAM2O,UAAV,EAAjB;AACA,QAAImC,iBAAiB,IAAI9Q,MAAM2O,UAAV,EAArB;AACAmC,mBAAeT,gBAAf,CAAgCzB,EAAhC,EAAoCvO,KAAKC,EAAL,GAAU,CAA9C;;AAEA,QAAIuO,QAAQ,IAAI7O,MAAMW,OAAV,EAAZ;;AAEA,QAAIoQ,YAAY,IAAI/Q,MAAMW,OAAV,EAAhB;AACAoQ,cAAUvI,IAAV,CAAe1G,MAAMsK,UAAN,CAAiB,CAAjB,CAAf;AACA2E,cAAU3P,CAAV,GAAc,CAAd;;AAEA,QAAI6N,UAAU,IAAIjP,MAAMW,OAAV,EAAd;AACA,QAAIuO,UAAU,IAAIlP,MAAMW,OAAV,EAAd;AACA,QAAIwO,UAAU,IAAInP,MAAMW,OAAV,EAAd;AACA,QAAIyO,UAAU,IAAIpP,MAAMW,OAAV,EAAd;;AAEA,SAAK,IAAIC,IAAI,CAAb,EAAgBA,KAAKmB,SAArB,EAAgCnB,GAAhC,EAAqC;;AAEjCiO,cAAMrG,IAAN,CAAW1G,MAAMsK,UAAN,CAAiBxL,IAAImB,SAArB,CAAX;AACA8M,cAAMzN,CAAN,GAAU,CAAV;;AAEAyP,gBAAQG,UAAR,CAAmBnC,KAAnB,EAA0BkC,SAA1B;;AAEA,YAAIZ,QAAQ9P,KAAK+P,KAAL,CAAWS,QAAQ9P,CAAnB,EAAsB8P,QAAQ5P,CAA9B,CAAZ;;AAEA2C,mBAAWyM,gBAAX,CAA4BzB,EAA5B,EAAgCuB,KAAhC;;AAEAlB,gBAAQpL,GAAR,CAAY,CAAC,GAAb,EAAkB,CAAlB,EAAqB,CAArB;AACAoL,gBAAQgB,eAAR,CAAwBrM,UAAxB;AACAqL,gBAAQrN,GAAR,CAAYiN,KAAZ;;AAEAK,gBAAQrL,GAAR,CAAY,GAAZ,EAAiB,CAAjB,EAAoB,CAApB;AACAqL,gBAAQe,eAAR,CAAwBrM,UAAxB;AACAsL,gBAAQtN,GAAR,CAAYiN,KAAZ;;AAEAM,gBAAQtL,GAAR,CAAY,GAAZ,EAAiB,CAAjB,EAAoB,CAApB;AACAsL,gBAAQc,eAAR,CAAwBa,cAAxB;AACA3B,gBAAQvN,GAAR,CAAYmP,SAAZ;;AAEA3B,gBAAQvL,GAAR,CAAY,CAAC,GAAb,EAAkB,CAAlB,EAAqB,CAArB;AACAuL,gBAAQa,eAAR,CAAwBa,cAAxB;AACA1B,gBAAQxN,GAAR,CAAYmP,SAAZ;;AAEAtC,iBAASyB,IAAT,CAAcjB,QAAQlO,CAAtB,EAAyBkO,QAAQ7N,CAAjC,EAAoC6N,QAAQhO,CAA5C;AACAwN,iBAASyB,IAAT,CAAchB,QAAQnO,CAAtB,EAAyBmO,QAAQ9N,CAAjC,EAAoC8N,QAAQjO,CAA5C;AACAwN,iBAASyB,IAAT,CAAcd,QAAQrO,CAAtB,EAAyBqO,QAAQhO,CAAjC,EAAoCgO,QAAQnO,CAA5C;;AAEAwN,iBAASyB,IAAT,CAAchB,QAAQnO,CAAtB,EAAyBmO,QAAQ9N,CAAjC,EAAoC8N,QAAQjO,CAA5C;AACAwN,iBAASyB,IAAT,CAAcf,QAAQpO,CAAtB,EAAyBoO,QAAQ/N,CAAjC,EAAoC+N,QAAQlO,CAA5C;AACAwN,iBAASyB,IAAT,CAAcd,QAAQrO,CAAtB,EAAyBqO,QAAQhO,CAAjC,EAAoCgO,QAAQnO,CAA5C;;AAEA8P,kBAAUvI,IAAV,CAAeqG,KAAf;AACAiC,uBAAetI,IAAf,CAAoB5E,UAApB;AAEH;;AAED,SAAK0M,YAAL,CAAkB,UAAlB,EAA8B,IAAItQ,MAAMuQ,eAAV,CAA0B,IAAIC,YAAJ,CAAiB/B,QAAjB,CAA1B,EAAsD,CAAtD,CAA9B;AAEH;;AAEDmC,4BAA4BH,SAA5B,GAAwCC,OAAOC,MAAP,CAAc3Q,MAAMuO,cAAN,CAAqBkC,SAAnC,CAAxC;;AAEA,yDAAeG,2BAAf,E;;;;;;;ACtEA,SAASK,qBAAT,CAA+BnP,KAA/B,EAAsCC,SAAtC,EAAiD;;AAE7C/B,UAAMuO,cAAN,CAAqBC,IAArB,CAA0B,IAA1B;;AAEA,QAAIC,WAAW,EAAf;AACA,QAAIC,UAAU,EAAd;AACA,QAAIwC,SAAS,EAAb;;AAEA;AACA,QAAIC,SAAS,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAAb,CAT6C,CASrB;AACxB,QAAIC,SAAS,CAAC,CAAD,EAAI,GAAJ,EAAS,GAAT,CAAb,CAV6C,CAUjB;;AAE5B,QAAIxC,KAAK,IAAI5O,MAAMW,OAAV,CAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,CAAT;AACA,QAAIkQ,UAAU,IAAI7Q,MAAMW,OAAV,EAAd;AACA,QAAIhD,QAAQ,IAAIqC,MAAMW,OAAV,EAAZ;;AAEA;AACA,QAAIiD,aAAa,IAAI5D,MAAM2O,UAAV,EAAjB;AACA,QAAImC,iBAAiB,IAAI9Q,MAAM2O,UAAV,EAArB;AACAmC,mBAAeT,gBAAf,CAAgCzB,EAAhC,EAAoCvO,KAAKC,EAAL,GAAU,CAA9C;;AAEA,QAAIuO,QAAQ,IAAI7O,MAAMW,OAAV,EAAZ;AACA,QAAIoQ,YAAY,IAAI/Q,MAAMW,OAAV,EAAhB;AACAoQ,cAAUvI,IAAV,CAAe1G,MAAMsK,UAAN,CAAiB,CAAjB,CAAf;;AAEA;AACA;AACA,QAAIiF,OAAO;AACP;AACA,QAAIrR,MAAMW,OAAV,CAAkB,CAAC,KAAnB,EAA0B,CAA1B,EAA6B,CAA7B,CAFO,EAGP,IAAIX,MAAMW,OAAV,CAAkB,CAAlB,EAAqB,CAAC,KAAtB,EAA6B,CAA7B,CAHO,EAIP,IAAIX,MAAMW,OAAV,CAAkB,CAAlB,EAAqB,CAAC,KAAtB,EAA6B,CAA7B,CAJO;AAKP;AACA,QAAIX,MAAMW,OAAV,CAAkB,CAAlB,EAAqB,CAAC,KAAtB,EAA6B,CAA7B,CANO,EAOP,IAAIX,MAAMW,OAAV,CAAkB,KAAlB,EAAyB,CAAzB,EAA4B,CAA5B,CAPO,EAQP,IAAIX,MAAMW,OAAV,CAAkB,CAAlB,EAAqB,CAAC,KAAtB,EAA6B,CAA7B,CARO,CAAX;;AAWA,QAAIsL,MAAM5L,KAAKC,EAAL,GAAU,CAApB,CAtC6C,CAsCtB;AACvB,QAAIgR,QAAQ,EAAZ;AACA,SAAK,IAAI1Q,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,GAAvB,EAA4B;;AAExB,YAAIuP,QAAUvP,IAAI,CAAN,GAAYqL,GAAxB,CAFwB,CAEK;AAC7BqF,cAAMpB,IAAN,CAAW,IAAIlQ,MAAMW,OAAV,CAAkB,CAAlB,EAAqBN,KAAKkM,GAAL,CAAS4D,KAAT,IAAkB,IAAvC,EAA6C9P,KAAKmM,GAAL,CAAS2D,KAAT,IAAkB,IAA/D,CAAX;AAEH;;AAED;AACA,QAAIoB,QAAQ,CAAZ,CAhD6C,CAgD9B;AACf,QAAIzC,QAAQ,EAAZ;;AAEA,SAAK,IAAIlO,IAAI,CAAb,EAAgBA,IAAI2Q,KAApB,EAA2B3Q,GAA3B,EAAgC;;AAE5B,YAAIuP,QAAUvP,IAAI2Q,KAAN,GAAgBtF,GAA5B,CAF4B,CAEK;AACjC6C,cAAMoB,IAAN,CAAW,IAAIlQ,MAAMW,OAAV,CAAkBN,KAAKkM,GAAL,CAAS4D,KAAT,IAAkB,IAApC,EAA0C9P,KAAKmM,GAAL,CAAS2D,KAAT,IAAkB,IAA5D,EAAkE,CAAlE,CAAX,EAH4B,CAGsD;AAErF;AACD;AACA,QAAIoB,QAAQ,CAAZ,CA1D6C,CA0D9B;AACf,QAAIxC,QAAQ,EAAZ;;AAEA,SAAK,IAAInO,IAAI,CAAb,EAAgBA,IAAI2Q,KAApB,EAA2B3Q,GAA3B,EAAgC;;AAE5B,YAAIuP,QAAUvP,IAAI2Q,KAAN,GAAgBtF,GAA5B,CAF4B,CAEK;AACjC8C,cAAMmB,IAAN,CAAW,IAAIlQ,MAAMW,OAAV,CAAkBN,KAAKkM,GAAL,CAAS4D,KAAT,IAAkB,KAApC,EAA2C9P,KAAKmM,GAAL,CAAS2D,KAAT,IAAkB,KAA7D,EAAoE,CAApE,CAAX,EAH4B,CAGwD;AAEvF;;AAED,QAAIqB,SAAS,IAAIxR,MAAMW,OAAV,EAAb;AACA,QAAI8Q,SAAS,IAAIzR,MAAMW,OAAV,EAAb;;AAEA,aAAS+Q,SAAT,CAAmBhC,KAAnB,EAA0BvR,KAA1B,EAAiC;AAAE;;AAE/BsT,eAAO5N,GAAP,CAAW,CAAX,EAAc,CAAd,EAAiB,CAAC,CAAlB,EAAqBoM,eAArB,CAAqCrM,UAArC,EAF6B,CAEqB;;AAElD,aAAK,IAAIiM,IAAI,CAAb,EAAgBA,IAAIH,MAAM7O,MAA1B,EAAkCgP,GAAlC,EAAuC;;AAEnC2B,mBAAOhJ,IAAP,CAAYkH,MAAMG,CAAN,CAAZ;AACA2B,mBAAOvB,eAAP,CAAuBrM,UAAvB;AACA4N,mBAAO5P,GAAP,CAAWiN,KAAX;;AAEAJ,qBAASyB,IAAT,CAAcsB,OAAOzQ,CAArB,EAAwByQ,OAAOpQ,CAA/B,EAAkCoQ,OAAOvQ,CAAzC;AACAyN,oBAAQwB,IAAR,CAAauB,OAAO1Q,CAApB,EAAuB0Q,OAAOrQ,CAA9B,EAAiCqQ,OAAOxQ,CAAxC;AACAiQ,mBAAOhB,IAAP,CAAY/R,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AAEH;;AAEDsT,eAAO5N,GAAP,CAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,EAAoBoM,eAApB,CAAoCrM,UAApC,EAhB6B,CAgBoB;;AAEjD,aAAK,IAAIiM,IAAIH,MAAM7O,MAAN,GAAe,CAA5B,EAA+BgP,KAAK,CAApC,EAAuCA,GAAvC,EAA4C;;AAExC2B,mBAAOhJ,IAAP,CAAYkH,MAAMG,CAAN,CAAZ;AACA2B,mBAAOvB,eAAP,CAAuBrM,UAAvB;AACA4N,mBAAO5P,GAAP,CAAWiN,KAAX;;AAEAJ,qBAASyB,IAAT,CAAcsB,OAAOzQ,CAArB,EAAwByQ,OAAOpQ,CAA/B,EAAkCoQ,OAAOvQ,CAAzC;AACAyN,oBAAQwB,IAAR,CAAauB,OAAO1Q,CAApB,EAAuB0Q,OAAOrQ,CAA9B,EAAiCqQ,OAAOxQ,CAAxC;AACAiQ,mBAAOhB,IAAP,CAAY/R,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AAEH;AAEJ;;AAED,QAAI8Q,UAAU,IAAIjP,MAAMW,OAAV,EAAd;AACA,QAAIuO,UAAU,IAAIlP,MAAMW,OAAV,EAAd;AACA,QAAIwO,UAAU,IAAInP,MAAMW,OAAV,EAAd;AACA,QAAIyO,UAAU,IAAIpP,MAAMW,OAAV,EAAd;;AAEA,QAAI0O,UAAU,IAAIrP,MAAMW,OAAV,EAAd;AACA,QAAI2O,UAAU,IAAItP,MAAMW,OAAV,EAAd;AACA,QAAI4O,UAAU,IAAIvP,MAAMW,OAAV,EAAd;AACA,QAAI6O,UAAU,IAAIxP,MAAMW,OAAV,EAAd;;AAEA,aAAS8O,YAAT,CAAsBC,KAAtB,EAA6BnI,MAA7B,EAAqCpJ,KAArC,EAA4C;AAAE;;AAE1C,aAAK,IAAI0R,IAAI,CAAR,EAAWC,KAAKJ,MAAM7O,MAA3B,EAAmCgP,IAAIC,EAAvC,EAA2CD,GAA3C,EAAgD;;AAE5C,gBAAIE,SAASL,MAAMG,CAAN,CAAb;AACA,gBAAIG,SAASN,MAAM,CAAEG,IAAI,CAAN,IAAYC,EAAlB,CAAb;;AAEAb,oBAAQzG,IAAR,CAAauH,MAAb,EAAqBnO,GAArB,CAAyB2F,MAAzB;AACA0H,oBAAQgB,eAAR,CAAwBrM,UAAxB;AACAqL,oBAAQrN,GAAR,CAAYiN,KAAZ;;AAEAK,oBAAQ1G,IAAR,CAAawH,MAAb,EAAqBpO,GAArB,CAAyB2F,MAAzB;AACA2H,oBAAQe,eAAR,CAAwBrM,UAAxB;AACAsL,oBAAQtN,GAAR,CAAYiN,KAAZ;;AAEAM,oBAAQ3G,IAAR,CAAawH,MAAb,EAAqBpO,GAArB,CAAyB2F,MAAzB;AACA4H,oBAAQc,eAAR,CAAwBa,cAAxB;AACA3B,oBAAQvN,GAAR,CAAYmP,SAAZ;;AAEA3B,oBAAQ5G,IAAR,CAAauH,MAAb,EAAqBnO,GAArB,CAAyB2F,MAAzB;AACA6H,oBAAQa,eAAR,CAAwBa,cAAxB;AACA1B,oBAAQxN,GAAR,CAAYmP,SAAZ;;AAEAtC,qBAASyB,IAAT,CAAcjB,QAAQlO,CAAtB,EAAyBkO,QAAQ7N,CAAjC,EAAoC6N,QAAQhO,CAA5C;AACAwN,qBAASyB,IAAT,CAAchB,QAAQnO,CAAtB,EAAyBmO,QAAQ9N,CAAjC,EAAoC8N,QAAQjO,CAA5C;AACAwN,qBAASyB,IAAT,CAAcd,QAAQrO,CAAtB,EAAyBqO,QAAQhO,CAAjC,EAAoCgO,QAAQnO,CAA5C;;AAEAwN,qBAASyB,IAAT,CAAchB,QAAQnO,CAAtB,EAAyBmO,QAAQ9N,CAAjC,EAAoC8N,QAAQjO,CAA5C;AACAwN,qBAASyB,IAAT,CAAcf,QAAQpO,CAAtB,EAAyBoO,QAAQ/N,CAAjC,EAAoC+N,QAAQlO,CAA5C;AACAwN,qBAASyB,IAAT,CAAcd,QAAQrO,CAAtB,EAAyBqO,QAAQhO,CAAjC,EAAoCgO,QAAQnO,CAA5C;;AAEA;;AAEAoO,oBAAQ7G,IAAR,CAAauH,MAAb;AACAV,oBAAQY,eAAR,CAAwBrM,UAAxB;AACAyL,oBAAQrC,SAAR;;AAEAsC,oBAAQ9G,IAAR,CAAawH,MAAb;AACAV,oBAAQW,eAAR,CAAwBrM,UAAxB;AACA0L,oBAAQtC,SAAR;;AAEAuC,oBAAQ/G,IAAR,CAAawH,MAAb;AACAT,oBAAQU,eAAR,CAAwBa,cAAxB;AACAvB,oBAAQvC,SAAR;;AAEAwC,oBAAQhH,IAAR,CAAauH,MAAb;AACAP,oBAAQS,eAAR,CAAwBa,cAAxB;AACAtB,oBAAQxC,SAAR;;AAEA0B,oBAAQwB,IAAR,CAAab,QAAQtO,CAArB,EAAwBsO,QAAQjO,CAAhC,EAAmCiO,QAAQpO,CAA3C;AACAyN,oBAAQwB,IAAR,CAAaZ,QAAQvO,CAArB,EAAwBuO,QAAQlO,CAAhC,EAAmCkO,QAAQrO,CAA3C;AACAyN,oBAAQwB,IAAR,CAAaV,QAAQzO,CAArB,EAAwByO,QAAQpO,CAAhC,EAAmCoO,QAAQvO,CAA3C;;AAEAyN,oBAAQwB,IAAR,CAAaZ,QAAQvO,CAArB,EAAwBuO,QAAQlO,CAAhC,EAAmCkO,QAAQrO,CAA3C;AACAyN,oBAAQwB,IAAR,CAAaX,QAAQxO,CAArB,EAAwBwO,QAAQnO,CAAhC,EAAmCmO,QAAQtO,CAA3C;AACAyN,oBAAQwB,IAAR,CAAaV,QAAQzO,CAArB,EAAwByO,QAAQpO,CAAhC,EAAmCoO,QAAQvO,CAA3C;;AAEAiQ,mBAAOhB,IAAP,CAAY/R,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AACA+S,mBAAOhB,IAAP,CAAY/R,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AACA+S,mBAAOhB,IAAP,CAAY/R,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;;AAEA+S,mBAAOhB,IAAP,CAAY/R,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AACA+S,mBAAOhB,IAAP,CAAY/R,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AACA+S,mBAAOhB,IAAP,CAAY/R,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AAEH;AAEJ;;AAED,aAASwT,gBAAT,CAA0BjC,KAA1B,EAAiCC,SAAjC,EAA4CC,OAA5C,EAAqDzR,KAArD,EAA4D;;AAExD,aAAK,IAAI0R,IAAI,CAAR,EAAWC,KAAKJ,MAAM7O,MAA3B,EAAmCgP,IAAIC,EAAvC,EAA2CD,GAA3C,EAAgD;;AAE5C,gBAAIE,SAASL,MAAMG,CAAN,CAAb;AACA,gBAAIG,SAASN,MAAM,CAAEG,IAAI,CAAN,IAAYC,EAAlB,CAAb;;AAEAb,oBAAQzG,IAAR,CAAauH,MAAb;AACAd,oBAAQgB,eAAR,CAAwBrM,UAAxB;AACAqL,oBAAQrN,GAAR,CAAY+N,SAAZ;;AAEAT,oBAAQ1G,IAAR,CAAawH,MAAb;AACAd,oBAAQe,eAAR,CAAwBrM,UAAxB;AACAsL,oBAAQtN,GAAR,CAAY+N,SAAZ;;AAEAR,oBAAQ3G,IAAR,CAAawH,MAAb;AACAb,oBAAQc,eAAR,CAAwBrM,UAAxB;AACAuL,oBAAQvN,GAAR,CAAYgO,OAAZ;;AAEAR,oBAAQ5G,IAAR,CAAauH,MAAb;AACAX,oBAAQa,eAAR,CAAwBrM,UAAxB;AACAwL,oBAAQxN,GAAR,CAAYgO,OAAZ;;AAEAnB,qBAASyB,IAAT,CAAcjB,QAAQlO,CAAtB,EAAyBkO,QAAQ7N,CAAjC,EAAoC6N,QAAQhO,CAA5C;AACAwN,qBAASyB,IAAT,CAAchB,QAAQnO,CAAtB,EAAyBmO,QAAQ9N,CAAjC,EAAoC8N,QAAQjO,CAA5C;AACAwN,qBAASyB,IAAT,CAAcd,QAAQrO,CAAtB,EAAyBqO,QAAQhO,CAAjC,EAAoCgO,QAAQnO,CAA5C;;AAEAwN,qBAASyB,IAAT,CAAchB,QAAQnO,CAAtB,EAAyBmO,QAAQ9N,CAAjC,EAAoC8N,QAAQjO,CAA5C;AACAwN,qBAASyB,IAAT,CAAcf,QAAQpO,CAAtB,EAAyBoO,QAAQ/N,CAAjC,EAAoC+N,QAAQlO,CAA5C;AACAwN,qBAASyB,IAAT,CAAcd,QAAQrO,CAAtB,EAAyBqO,QAAQhO,CAAjC,EAAoCgO,QAAQnO,CAA5C;;AAEA;;AAEAoO,oBAAQ7G,IAAR,CAAauH,MAAb;AACAV,oBAAQY,eAAR,CAAwBrM,UAAxB;AACAyL,oBAAQrC,SAAR;;AAEAsC,oBAAQ9G,IAAR,CAAawH,MAAb;AACAV,oBAAQW,eAAR,CAAwBrM,UAAxB;AACA0L,oBAAQtC,SAAR;;AAEAuC,oBAAQ/G,IAAR,CAAawH,MAAb;AACAT,oBAAQU,eAAR,CAAwBrM,UAAxB;AACA2L,oBAAQvC,SAAR;;AAEAwC,oBAAQhH,IAAR,CAAauH,MAAb;AACAP,oBAAQS,eAAR,CAAwBrM,UAAxB;AACA4L,oBAAQxC,SAAR;;AAEA0B,oBAAQwB,IAAR,CAAab,QAAQtO,CAArB,EAAwBsO,QAAQjO,CAAhC,EAAmCiO,QAAQpO,CAA3C;AACAyN,oBAAQwB,IAAR,CAAaZ,QAAQvO,CAArB,EAAwBuO,QAAQlO,CAAhC,EAAmCkO,QAAQrO,CAA3C;AACAyN,oBAAQwB,IAAR,CAAaV,QAAQzO,CAArB,EAAwByO,QAAQpO,CAAhC,EAAmCoO,QAAQvO,CAA3C;;AAEAyN,oBAAQwB,IAAR,CAAaZ,QAAQvO,CAArB,EAAwBuO,QAAQlO,CAAhC,EAAmCkO,QAAQrO,CAA3C;AACAyN,oBAAQwB,IAAR,CAAaX,QAAQxO,CAArB,EAAwBwO,QAAQnO,CAAhC,EAAmCmO,QAAQtO,CAA3C;AACAyN,oBAAQwB,IAAR,CAAaV,QAAQzO,CAArB,EAAwByO,QAAQpO,CAAhC,EAAmCoO,QAAQvO,CAA3C;;AAEAiQ,mBAAOhB,IAAP,CAAY/R,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AACA+S,mBAAOhB,IAAP,CAAY/R,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AACA+S,mBAAOhB,IAAP,CAAY/R,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;;AAEA+S,mBAAOhB,IAAP,CAAY/R,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AACA+S,mBAAOhB,IAAP,CAAY/R,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AACA+S,mBAAOhB,IAAP,CAAY/R,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AAEH;AAEJ;;AAED,QAAIoJ,SAAS,IAAIvH,MAAMW,OAAV,EAAb;AACA,QAAIgP,YAAY,IAAI3P,MAAMW,OAAV,EAAhB;AACA,QAAIiP,UAAU,IAAI5P,MAAMW,OAAV,EAAd;;AAGA,SAAK,IAAIC,IAAI,CAAb,EAAgBA,KAAKmB,SAArB,EAAgCnB,GAAhC,EAAqC;;AAEjCiO,cAAMrG,IAAN,CAAW1G,MAAMsK,UAAN,CAAiBxL,IAAImB,SAArB,CAAX;;AAEA6M,WAAG/K,GAAH,CAAO,CAAP,EAAU,CAAV,EAAa,CAAb;;AAEAgN,gBAAQG,UAAR,CAAmBnC,KAAnB,EAA0BkC,SAA1B,EAAqC/D,SAArC;AACArP,cAAMiU,YAAN,CAAmBhD,EAAnB,EAAuBiC,OAAvB,EAAgC7D,SAAhC;AACA4B,WAAGgD,YAAH,CAAgBf,OAAhB,EAAyBlT,KAAzB;;AAEA,YAAIwS,QAAQ9P,KAAK+P,KAAL,CAAWS,QAAQ9P,CAAnB,EAAsB8P,QAAQ5P,CAA9B,CAAZ;;AAEA2C,mBAAWyM,gBAAX,CAA4BzB,EAA5B,EAAgCuB,KAAhC;;AAEA,YAAIvP,IAAI,CAAJ,KAAU,CAAd,EAAiB;AACb;AACA;AACA+O,sBAAU9L,GAAV,CAAc,CAAC,GAAf,EAAoB,CAAC,IAArB,EAA2B,CAA3B;AACA8L,sBAAUM,eAAV,CAA0BrM,UAA1B;AACA+L,sBAAU/N,GAAV,CAAciN,KAAd;;AAEAe,oBAAQ/L,GAAR,CAAY,CAAZ,EAAe,CAAC,KAAhB,EAAuB,CAAvB;AACA+L,oBAAQK,eAAR,CAAwBrM,UAAxB;AACAgM,oBAAQhO,GAAR,CAAYiN,KAAZ;AACA8C,6BAAiBL,KAAjB,EAAwB3B,SAAxB,EAAmCC,OAAnC,EAA4CwB,MAA5C;;AAEAzB,sBAAU9L,GAAV,CAAc,GAAd,EAAmB,CAAC,IAApB,EAA0B,CAA1B;AACA8L,sBAAUM,eAAV,CAA0BrM,UAA1B;AACA+L,sBAAU/N,GAAV,CAAciN,KAAd;;AAEAe,oBAAQ/L,GAAR,CAAY,CAAZ,EAAe,CAAC,KAAhB,EAAuB,CAAvB;AACA+L,oBAAQK,eAAR,CAAwBrM,UAAxB;AACAgM,oBAAQhO,GAAR,CAAYiN,KAAZ;AACA8C,6BAAiBL,KAAjB,EAAwB3B,SAAxB,EAAmCC,OAAnC,EAA4CwB,MAA5C;AACH;;AAED;AACA3B,qBAAaX,KAAb,EAAoBvH,OAAO1D,GAAP,CAAW,CAAX,EAAc,CAAC,KAAf,EAAsB,CAAtB,CAApB,EAA8CuN,MAA9C;AACA;AACA3B,qBAAaV,KAAb,EAAoBxH,OAAO1D,GAAP,CAAW,GAAX,EAAgB,CAAhB,EAAmB,CAAnB,CAApB,EAA2CsN,MAA3C;AACA1B,qBAAaV,KAAb,EAAoBxH,OAAO1D,GAAP,CAAW,CAAC,GAAZ,EAAiB,CAAjB,EAAoB,CAApB,CAApB,EAA4CsN,MAA5C;;AAEAJ,kBAAUvI,IAAV,CAAeqG,KAAf;AACAiC,uBAAetI,IAAf,CAAoB5E,UAApB;AAEH;;AAED;;AAEA,SAAK0M,YAAL,CAAkB,UAAlB,EAA8B,IAAItQ,MAAMuQ,eAAV,CAA0B,IAAIC,YAAJ,CAAiB/B,QAAjB,CAA1B,EAAsD,CAAtD,CAA9B;AACA,SAAK6B,YAAL,CAAkB,QAAlB,EAA4B,IAAItQ,MAAMuQ,eAAV,CAA0B,IAAIC,YAAJ,CAAiB9B,OAAjB,CAA1B,EAAqD,CAArD,CAA5B;AACA,SAAK4B,YAAL,CAAkB,OAAlB,EAA2B,IAAItQ,MAAMuQ,eAAV,CAA0B,IAAIC,YAAJ,CAAiBU,MAAjB,CAA1B,EAAoD,CAApD,CAA3B;AAEH;;AAEDD,sBAAsBR,SAAtB,GAAkCC,OAAOC,MAAP,CAAc3Q,MAAMuO,cAAN,CAAqBkC,SAAnC,CAAlC;;AAEA,yDAAeQ,qBAAf,E","file":"main.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 8e7fd15dbc4ef4789602","export function isWebVRAvailable() {\n    return navigator.getVRDisplays !== undefined;\n}\n\nexport function getVRDisplay(callback) {\n    if (!isWebVRAvailable()) {\n        callback('browser not support vr display', null);\n        return;\n    }\n\n    navigator\n        .getVRDisplays()\n        .then((displays) => {\n            callback(null, displays[0]);\n        })\n        .catch((error) => {\n            callback(error, null);\n        });\n}\n\nexport function getHelpMessageElement(callback) {\n    const makeMessageElement = (message) => {\n        const container = document.createElement('div');\n        container.style.position = 'absolute';\n        container.style.left = '0';\n        container.style.top = '0';\n        container.style.right = '0';\n        container.style.zIndex = '999';\n        container.align = 'center';\n\n        const error = document.createElement('div');\n        error.style.fontFamily = 'sans-serif';\n        error.style.fontSize = '16px';\n        error.style.fontStyle = 'normal';\n        error.style.lineHeight = '26px';\n        error.style.backgroundColor = '#fff';\n        error.style.color = '#000';\n        error.style.padding = '10px 20px';\n        error.style.margin = '50px';\n        error.style.display = 'inline-block';\n        error.innerHTML = message;\n        container.appendChild(error);\n\n        callback(container);\n    };\n\n    getVRDisplay((err, vrDisplay) => {\n        if (err) {\n            makeMessageElement('Your browser does not support WebVR. See <a href=\"http://webvr.info\">webvr.info</a> for assistance.');\n        } else if (!vrDisplay) {\n            makeMessageElement('WebVR supported, but no VRDisplays found.');\n        } else {\n            callback(null);\n        }\n    });\n}\n\nexport function getButton(display, canvas) {\n    const button = document.createElement('button');\n    button.style.position = 'absolute';\n    button.style.left = 'calc(50% - 50px)';\n    button.style.bottom = '20px';\n    button.style.width = '100px';\n    button.style.border = '0';\n    button.style.padding = '8px';\n    button.style.cursor = 'pointer';\n    button.style.backgroundColor = '#000';\n    button.style.color = '#fff';\n    button.style.fontFamily = 'sans-serif';\n    button.style.fontSize = '13px';\n    button.style.fontStyle = 'normal';\n    button.style.textAlign = 'center';\n    button.style.zIndex = '999';\n\n    if (display) {\n        button.textContent = 'ENTER VR';\n        button.onclick = function onButtonClick() {\n            display.isPresenting ? display.exitPresent() : display.requestPresent([{ source: canvas }]);\n        };\n\n        window.addEventListener('vrdisplaypresentchange', () => {\n            button.textContent = display.isPresenting ? 'EXIT VR' : 'ENTER VR';\n        });\n    } else {\n        button.textContent = 'NO VR DISPLAY';\n    }\n\n    return button;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/vr/utils.js","export function groundMeshFactory(scene, width, height) {\n    const geometry = new THREE.PlaneBufferGeometry(width, height, 15, 15);\n    geometry.applyMatrix(new THREE.Matrix4().makeRotationX(-Math.PI / 2));\n\n    const positions = geometry.attributes.position.array;\n    const vertex = new THREE.Vector3();\n\n    for (let i = 0; i < positions.length; i += 3) {\n        vertex.fromArray(positions, i);\n        vertex.x += Math.random() * 10 - 5;\n        vertex.z += Math.random() * 10 - 5;\n        const distance = ( vertex.distanceTo(scene.position) / 5 ) - 25;\n        vertex.y = Math.random() * Math.max(0, distance);\n        vertex.toArray(positions, i);\n    }\n    geometry.computeVertexNormals();\n\n    const material = new THREE.MeshLambertMaterial({\n        color: 0x407000\n    });\n\n    const mesh = new THREE.Mesh( geometry, material );\n    scene.add(mesh);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/ground/index.js","import RollerCoasterLifterGeometry from './geometry';\n\nexport function rollerCoasterLifterMeshFactory(curve, divisions) {\n    const geometry = new RollerCoasterLifterGeometry(curve, divisions);\n    const material = new THREE.MeshPhongMaterial();\n    const mesh = new THREE.Mesh(geometry, material);\n\n    mesh.position.y = 0.1;\n\n    return mesh;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/roller-coaster-lifter/index.js","import RollerCoasterShadowGeometry from './geometry';\n\nexport function rollerCoasterShadowMeshFactory(curve, divisions) {\n    const geometry = new RollerCoasterShadowGeometry(curve, divisions);\n    const material = new THREE.MeshBasicMaterial({\n        color: 0x305000, depthWrite: false, transparent: true\n    });\n    const mesh = new THREE.Mesh(geometry, material);\n\n    mesh.position.y = 0.1;\n\n    return mesh;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/roller-coaster-shadow/index.js","import RollerCoasterGeometry from './roller-coaster';\n\nexport function rollerCoasterMeshFactory(curve, divisions) {\n    const geometry = new RollerCoasterGeometry(curve, divisions);\n    const material = new THREE.MeshPhongMaterial({\n        vertexColors: THREE.VertexColors\n    });\n\n    return new THREE.Mesh(geometry, material);\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/roller-coaster/index.js","import { isWebVRAvailable, getVRDisplay } from './utils';\n\nclass VRControl {\n    constructor(object) {\n        this.object = object;\n\n        this.standingMatrix = new THREE.Matrix4();\n        this.scale = 1;\n        this.standing = false;\n        this.userHeight = 1.6;\n        this.frameData = null;\n    }\n\n    init(onError) {\n        if ('VRFrameData' in window) {\n            this.frameData = new window.VRFrameData();\n        }\n\n        if (isWebVRAvailable()) {\n            getVRDisplay((err, vrDisplay) => {\n                if (err) {\n                    console.warn(err);\n                } else if (!vrDisplay) {\n                    onError('VR input not available.');\n                } else {\n                    this.vrDisplay = vrDisplay;\n                }\n            });\n        }\n    }\n\n    getVRDisplay() {\n        return this.vrDisplay;\n    }\n\n    setVRDisplay(value) {\n        this.vrDisplay = value;\n    }\n\n    getStandingMaxtrix() {\n        return this.standingMatrix;\n    }\n\n    update() {\n        if (!this.vrDisplay) {\n            return;\n        }\n\n        this.vrDisplay.getFrameData(this.frameData);\n\n        const pose = this.frameData.pose;\n\n        if (pose.orientation !== null) {\n            this.object.quaternion.fromArray(pose.orientation);\n        }\n\n        if (pose.position !== null) {\n            this.object.position.fromArray(pose.position);\n        } else {\n            this.object.position.set(0, 0, 0);\n        }\n\n        if (this.standing) {\n            if (this.vrDisplay.stageParameters) {\n                this.object.updateMatrix();\n                this.standingMatrix.fromArray(this.vrDisplay.stageParameters.sittingToStandingTransform);\n                this.object.applyMatrix(this.standingMatrix);\n            } else {\n                this.object.position.setY(this.object.position.y + this.userHeight);\n            }\n        }\n    }\n\n    dispose() {\n        this.vrDisplay = null;\n    }\n}\n\nexport default VRControl;\n\n\n\n// WEBPACK FOOTER //\n// ./src/vr/control.js","/*\nclass VREffect {\n    constructor(renderer) {\n        this.renderer = renderer;\n\n        this.vrDisplay = null;\n        this.frameData = null;\n\n        this.eyeTranslationL = new THREE.Vector3();\n        this.eyeTranslationR = new THREE.Vector3();\n\n        this.isPresenting = false;\n\n        this.rendererSize = renderer.getSize();\n        this.rendererUpdateStyle = false;\n        this.rendererPixelRatio = renderer.getPixelRatio();\n\n        this.canvas = renderer.domElement;\n        this.defaultLeftBounds = [0.0, 0.0, 0.5, 1.0];\n        this.defaultRightBounds = [0.5, 0.0, 0.5, 1.0];\n\n        this.autoSubmitFrame = true;\n    }\n\n    _onVRDisplayPresentChange() {\n        const wasPresenting = this.isPresenting;\n        this.isPresenting = !!this.vrDisplay && this.vrDisplay.isPresenting;\n\n        if (this.isPresenting) {\n            const eyeParamsL = this.vrDisplay.getEyeParameters('left');\n            const eyeWidth = eyeParamsL.renderWidth;\n            const eyeHeight = eyeParamsL.renderHeight;\n\n            if (!wasPresenting) {\n                this.rendererPixelRatio = this.renderer.getPixelRatio();\n                this.rendererSize = this.renderer.getSize();\n\n                this.renderer.setPixelRatio(1);\n                this.renderer.setSize(eyeWidth * 2, eyeHeight, false);\n            }\n        } else if (wasPresenting) {\n            this.renderer.setPixelRatio(this.rendererPixelRatio);\n            this.renderer.setSize(this.rendererSize.width, this.rendererSize.height, this.rendererUpdateStyle);\n        }\n    }\n\n    init(onError) {\n        if ('VRFrameData' in window) {\n            this.frameData = new window.VRFrameData();\n        }\n\n        if (isWebVRAvailable()) {\n            getVRDisplay((err, vrDisplay) => {\n                if (err || !vrDisplay) {\n                    onError('HMD not available');\n                } else {\n                    this.vrDisplay = vrDisplay;\n                }\n            });\n        }\n\n        window.addEventListener('vrdisplaypresentchange', () => {\n            this._onVRDisplayPresentChange();\n        });\n    }\n\n    getVRDisplay() {\n        return this.vrDisplay;\n    }\n\n    setVRDisplay(value) {\n        this.vrDisplay = value;\n    }\n\n    setSize(width, height, updateStyle) {\n        this.rendererSize = { width, height };\n        this.rendererUpdateStyle = updateStyle;\n\n        if (this.isPresenting) {\n            const eyeParamsL = this.vrDisplay.getEyeParameters('left');\n\n            this.renderer.setPixelRatio(1);\n            this.renderer.setSize(eyeParamsL.renderWidth * 2, eyeParamsL.renderHeight, false);\n\n        } else {\n            this.renderer.setPixelRatio(this.rendererPixelRatio);\n            this.renderer.setSize(width, height, updateStyle);\n        }\n    }\n\n    setFullScreen(boolean) {\n        return new Promise((resolve) => {\n            if (this.isPresenting === boolean) {\n                resolve();\n                return;\n            }\n\n            if (boolean) {\n                resolve(this.vrDisplay.requestPresent({ source: this.canvas }));\n            } else {\n                resolve(this.vrDisplay.exitPresent());\n            }\n        });\n    }\n\n    requestPresent() {\n        return this.setFullScreen(true);\n    }\n\n    exitPresent() {\n        return this.setFullScreen(false);\n    }\n\n    requestAnimationFrame(f) {\n        if (this.vrDisplay) {\n            return this.vrDisplay.requestAnimationFrame(f);\n        }\n\n        return window.requestAnimationFrame(f);\n    }\n\n    cancelAnimationFrame(h) {\n        if (this.vrDisplay) {\n            this.vrDisplay.cancelAnimationFrame(h);\n        } else {\n            window.cancelAnimationFrame(h);\n        }\n    }\n\n    submitFrame() {\n        if (this.vrDisplay && this.isPresenting) {\n            this.vrDisplay.submitFrame();\n        }\n    }\n\n    render(scene, camera, renderTarget, forceClear) {\n        const cameraL = new THREE.PerspectiveCamera();\n        const cameraR = new THREE.PerspectiveCamera();\n\n        cameraL.layers.enable(1);\n        cameraR.layers.enable(2);\n\n        if (this.vrDisplay && this.isPresenting) {\n            const autoUpdate = scene.autoUpdate;\n\n            if (autoUpdate) {\n                scene.updateMatrixWorld();\n                scene.autoUpdate = false;\n            }\n\n            const eyeParamsL = this.vrDisplay.getEyeParameters('left');\n            const eyeParamsR = this.vrDisplay.getEyeParameters('right');\n\n            this.eyeTranslationL.fromArray(eyeParamsL.offset);\n            this.eyeTranslationR.fromArray(eyeParamsR.offset);\n\n            const size = this.renderer.getSize();\n            const layers = this.vrDisplay.getLayers();\n\n            let leftBounds;\n            let rightBounds;\n\n            if (layers.length) {\n                const layer = layers[0];\n\n                leftBounds = layer.leftBounds !== null && layer.leftBounds.length === 4 ? layer.leftBounds : this.defaultLeftBounds;\n                rightBounds = layer.rightBounds !== null && layer.rightBounds.length === 4 ? layer.rightBounds : this.defaultRightBounds;\n\n            } else {\n                leftBounds = defaultLeftBounds;\n                rightBounds = defaultRightBounds;\n            }\n\n            const renderReactL = {\n                x: Math.round(size.width * leftBounds[0]),\n                y: Math.round(size.height * leftBounds[1]),\n                width: Math.round(size.width * leftBounds[2]),\n                height: Math.round(size.height * leftBounds[3])\n            };\n\n            const renderRectR = {\n                x: Math.round(size.width * rightBounds[0]),\n                y: Math.round(size.height * rightBounds[1]),\n                width: Math.round(size.width * rightBounds[2]),\n                height: Math.round(size.height * rightBounds[3])\n            };\n\n            if (renderTarget) {\n                this.renderer.setRenderTarget(renderTarget);\n                renderTarget.scissorTest = true;\n            } else {\n                this.renderer.setRenderTarget(null);\n                this.renderer.setScissorTest(true);\n            }\n\n            if (this.renderer.autoClear || forceClear) {\n                this.renderer.clear();\n            }\n\n            if (camera.parent === null) {\n                camera.updateMatrixWorld();\n            }\n\n            camera.matrixWorld.decompose(cameraL.position, cameraL.quaternion, cameraL.scale);\n\n            cameraR.position.copy(cameraL.position);\n            cameraR.quaternion.copy(cameraL.quaternion);\n            cameraR.scale.copy(cameraL.scale);\n\n            cameraL.translateOnAxis(this.eyeTranslationL, cameraL.scale.x);\n            cameraR.translateOnAxis(this.eyeTranslationR, cameraR.scale.x);\n\n            if (this.vrDisplay.getFrameData) {\n\n            }\n        }\n    }\n}\n*/\n\nfunction VREffect(renderer, onError) {\n\n    var vrDisplay, vrDisplays;\n    var eyeTranslationL = new THREE.Vector3();\n    var eyeTranslationR = new THREE.Vector3();\n    var renderRectL, renderRectR;\n\n    var frameData = null;\n\n    if ('VRFrameData' in window) {\n\n        frameData = new window.VRFrameData();\n\n    }\n\n    function gotVRDisplays(displays) {\n\n        vrDisplays = displays;\n\n        if (displays.length > 0) {\n\n            vrDisplay = displays[0];\n\n        } else {\n\n            if (onError) onError('HMD not available');\n\n        }\n\n    }\n\n    if (navigator.getVRDisplays) {\n\n        navigator.getVRDisplays().then(gotVRDisplays).catch(function () {\n\n            console.warn('THREE.VREffect: Unable to get VR Displays');\n\n        });\n\n    }\n\n    //\n\n    this.isPresenting = false;\n\n    var scope = this;\n\n    var rendererSize = renderer.getSize();\n    var rendererUpdateStyle = false;\n    var rendererPixelRatio = renderer.getPixelRatio();\n\n    this.getVRDisplay = function () {\n\n        return vrDisplay;\n\n    };\n\n    this.setVRDisplay = function (value) {\n\n        vrDisplay = value;\n\n    };\n\n    this.getVRDisplays = function () {\n\n        console.warn('THREE.VREffect: getVRDisplays() is being deprecated.');\n        return vrDisplays;\n\n    };\n\n    this.setSize = function (width, height, updateStyle) {\n\n        rendererSize = {width: width, height: height};\n        rendererUpdateStyle = updateStyle;\n\n        if (scope.isPresenting) {\n\n            var eyeParamsL = vrDisplay.getEyeParameters('left');\n            renderer.setPixelRatio(1);\n            renderer.setSize(eyeParamsL.renderWidth * 2, eyeParamsL.renderHeight, false);\n\n        } else {\n\n            renderer.setPixelRatio(rendererPixelRatio);\n            renderer.setSize(width, height, updateStyle);\n\n        }\n\n    };\n\n    // VR presentation\n\n    var canvas = renderer.domElement;\n    var defaultLeftBounds = [0.0, 0.0, 0.5, 1.0];\n    var defaultRightBounds = [0.5, 0.0, 0.5, 1.0];\n\n    function onVRDisplayPresentChange() {\n\n        var wasPresenting = scope.isPresenting;\n        scope.isPresenting = vrDisplay !== undefined && vrDisplay.isPresenting;\n\n        if (scope.isPresenting) {\n\n            var eyeParamsL = vrDisplay.getEyeParameters('left');\n            var eyeWidth = eyeParamsL.renderWidth;\n            var eyeHeight = eyeParamsL.renderHeight;\n\n            if (!wasPresenting) {\n\n                rendererPixelRatio = renderer.getPixelRatio();\n                rendererSize = renderer.getSize();\n\n                renderer.setPixelRatio(1);\n                renderer.setSize(eyeWidth * 2, eyeHeight, false);\n\n            }\n\n        } else if (wasPresenting) {\n\n            renderer.setPixelRatio(rendererPixelRatio);\n            renderer.setSize(rendererSize.width, rendererSize.height, rendererUpdateStyle);\n\n        }\n\n    }\n\n    window.addEventListener('vrdisplaypresentchange', onVRDisplayPresentChange, false);\n\n    this.setFullScreen = function (boolean) {\n\n        return new Promise(function (resolve, reject) {\n\n            if (vrDisplay === undefined) {\n\n                reject(new Error('No VR hardware found.'));\n                return;\n\n            }\n\n            if (scope.isPresenting === boolean) {\n\n                resolve();\n                return;\n\n            }\n\n            if (boolean) {\n\n                resolve(vrDisplay.requestPresent([{source: canvas}]));\n\n            } else {\n\n                resolve(vrDisplay.exitPresent());\n\n            }\n\n        });\n\n    };\n\n    this.requestPresent = function () {\n\n        return this.setFullScreen(true);\n\n    };\n\n    this.exitPresent = function () {\n\n        return this.setFullScreen(false);\n\n    };\n\n    this.requestAnimationFrame = function (f) {\n\n        if (vrDisplay !== undefined) {\n\n            return vrDisplay.requestAnimationFrame(f);\n\n        } else {\n\n            return window.requestAnimationFrame(f);\n\n        }\n\n    };\n\n    this.cancelAnimationFrame = function (h) {\n\n        if (vrDisplay !== undefined) {\n\n            vrDisplay.cancelAnimationFrame(h);\n\n        } else {\n\n            window.cancelAnimationFrame(h);\n\n        }\n\n    };\n\n    this.submitFrame = function () {\n\n        if (vrDisplay !== undefined && scope.isPresenting) {\n\n            vrDisplay.submitFrame();\n\n        }\n\n    };\n\n    this.autoSubmitFrame = true;\n\n    // render\n\n    var cameraL = new THREE.PerspectiveCamera();\n    cameraL.layers.enable(1);\n\n    var cameraR = new THREE.PerspectiveCamera();\n    cameraR.layers.enable(2);\n\n    this.render = function (scene, camera, renderTarget, forceClear) {\n\n        if (vrDisplay && scope.isPresenting) {\n\n            var autoUpdate = scene.autoUpdate;\n\n            if (autoUpdate) {\n\n                scene.updateMatrixWorld();\n                scene.autoUpdate = false;\n\n            }\n\n            var eyeParamsL = vrDisplay.getEyeParameters('left');\n            var eyeParamsR = vrDisplay.getEyeParameters('right');\n\n            eyeTranslationL.fromArray(eyeParamsL.offset);\n            eyeTranslationR.fromArray(eyeParamsR.offset);\n\n            if (Array.isArray(scene)) {\n\n                console.warn('THREE.VREffect.render() no longer supports arrays. Use object.layers instead.');\n                scene = scene[0];\n\n            }\n\n            // When rendering we don't care what the recommended size is, only what the actual size\n            // of the backbuffer is.\n            var size = renderer.getSize();\n            var layers = vrDisplay.getLayers();\n            var leftBounds;\n            var rightBounds;\n\n            if (layers.length) {\n\n                var layer = layers[0];\n\n                leftBounds = layer.leftBounds !== null && layer.leftBounds.length === 4 ? layer.leftBounds : defaultLeftBounds;\n                rightBounds = layer.rightBounds !== null && layer.rightBounds.length === 4 ? layer.rightBounds : defaultRightBounds;\n\n            } else {\n\n                leftBounds = defaultLeftBounds;\n                rightBounds = defaultRightBounds;\n\n            }\n\n            renderRectL = {\n                x: Math.round(size.width * leftBounds[0]),\n                y: Math.round(size.height * leftBounds[1]),\n                width: Math.round(size.width * leftBounds[2]),\n                height: Math.round(size.height * leftBounds[3])\n            };\n            renderRectR = {\n                x: Math.round(size.width * rightBounds[0]),\n                y: Math.round(size.height * rightBounds[1]),\n                width: Math.round(size.width * rightBounds[2]),\n                height: Math.round(size.height * rightBounds[3])\n            };\n\n            if (renderTarget) {\n\n                renderer.setRenderTarget(renderTarget);\n                renderTarget.scissorTest = true;\n\n            } else {\n\n                renderer.setRenderTarget(null);\n                renderer.setScissorTest(true);\n\n            }\n\n            if (renderer.autoClear || forceClear) renderer.clear();\n\n            if (camera.parent === null) camera.updateMatrixWorld();\n\n            camera.matrixWorld.decompose(cameraL.position, cameraL.quaternion, cameraL.scale);\n\n            cameraR.position.copy(cameraL.position);\n            cameraR.quaternion.copy(cameraL.quaternion);\n            cameraR.scale.copy(cameraL.scale);\n\n            cameraL.translateOnAxis(eyeTranslationL, cameraL.scale.x);\n            cameraR.translateOnAxis(eyeTranslationR, cameraR.scale.x);\n\n            if (vrDisplay.getFrameData) {\n\n                vrDisplay.depthNear = camera.near;\n                vrDisplay.depthFar = camera.far;\n\n                vrDisplay.getFrameData(frameData);\n\n                cameraL.projectionMatrix.elements = frameData.leftProjectionMatrix;\n                cameraR.projectionMatrix.elements = frameData.rightProjectionMatrix;\n\n            } else {\n\n                cameraL.projectionMatrix = fovToProjection(eyeParamsL.fieldOfView, true, camera.near, camera.far);\n                cameraR.projectionMatrix = fovToProjection(eyeParamsR.fieldOfView, true, camera.near, camera.far);\n\n            }\n\n            // render left eye\n            if (renderTarget) {\n\n                renderTarget.viewport.set(renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height);\n                renderTarget.scissor.set(renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height);\n\n            } else {\n\n                renderer.setViewport(renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height);\n                renderer.setScissor(renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height);\n\n            }\n            renderer.render(scene, cameraL, renderTarget, forceClear);\n\n            // render right eye\n            if (renderTarget) {\n\n                renderTarget.viewport.set(renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height);\n                renderTarget.scissor.set(renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height);\n\n            } else {\n\n                renderer.setViewport(renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height);\n                renderer.setScissor(renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height);\n\n            }\n            renderer.render(scene, cameraR, renderTarget, forceClear);\n\n            if (renderTarget) {\n\n                renderTarget.viewport.set(0, 0, size.width, size.height);\n                renderTarget.scissor.set(0, 0, size.width, size.height);\n                renderTarget.scissorTest = false;\n                renderer.setRenderTarget(null);\n\n            } else {\n\n                renderer.setViewport(0, 0, size.width, size.height);\n                renderer.setScissorTest(false);\n\n            }\n\n            if (autoUpdate) {\n\n                scene.autoUpdate = true;\n\n            }\n\n            if (scope.autoSubmitFrame) {\n\n                scope.submitFrame();\n\n            }\n\n            return;\n\n        }\n\n        // Regular render mode if not HMD\n\n        renderer.render(scene, camera, renderTarget, forceClear);\n\n    };\n\n    this.dispose = function () {\n\n        window.removeEventListener('vrdisplaypresentchange', onVRDisplayPresentChange, false);\n\n    };\n\n    //\n\n    function fovToNDCScaleOffset(fov) {\n\n        var pxscale = 2.0 / ( fov.leftTan + fov.rightTan );\n        var pxoffset = ( fov.leftTan - fov.rightTan ) * pxscale * 0.5;\n        var pyscale = 2.0 / ( fov.upTan + fov.downTan );\n        var pyoffset = ( fov.upTan - fov.downTan ) * pyscale * 0.5;\n        return {scale: [pxscale, pyscale], offset: [pxoffset, pyoffset]};\n\n    }\n\n    function fovPortToProjection(fov, rightHanded, zNear, zFar) {\n\n        rightHanded = rightHanded === undefined ? true : rightHanded;\n        zNear = zNear === undefined ? 0.01 : zNear;\n        zFar = zFar === undefined ? 10000.0 : zFar;\n\n        var handednessScale = rightHanded ? -1.0 : 1.0;\n\n        // start with an identity matrix\n        var mobj = new THREE.Matrix4();\n        var m = mobj.elements;\n\n        // and with scale/offset info for normalized device coords\n        var scaleAndOffset = fovToNDCScaleOffset(fov);\n\n        // X result, map clip edges to [-w,+w]\n        m[0 * 4 + 0] = scaleAndOffset.scale[0];\n        m[0 * 4 + 1] = 0.0;\n        m[0 * 4 + 2] = scaleAndOffset.offset[0] * handednessScale;\n        m[0 * 4 + 3] = 0.0;\n\n        // Y result, map clip edges to [-w,+w]\n        // Y offset is negated because this proj matrix transforms from world coords with Y=up,\n        // but the NDC scaling has Y=down (thanks D3D?)\n        m[1 * 4 + 0] = 0.0;\n        m[1 * 4 + 1] = scaleAndOffset.scale[1];\n        m[1 * 4 + 2] = -scaleAndOffset.offset[1] * handednessScale;\n        m[1 * 4 + 3] = 0.0;\n\n        // Z result (up to the app)\n        m[2 * 4 + 0] = 0.0;\n        m[2 * 4 + 1] = 0.0;\n        m[2 * 4 + 2] = zFar / ( zNear - zFar ) * -handednessScale;\n        m[2 * 4 + 3] = ( zFar * zNear ) / ( zNear - zFar );\n\n        // W result (= Z in)\n        m[3 * 4 + 0] = 0.0;\n        m[3 * 4 + 1] = 0.0;\n        m[3 * 4 + 2] = handednessScale;\n        m[3 * 4 + 3] = 0.0;\n\n        mobj.transpose();\n        return mobj;\n\n    }\n\n    function fovToProjection(fov, rightHanded, zNear, zFar) {\n\n        var DEG2RAD = Math.PI / 180.0;\n\n        var fovPort = {\n            upTan: Math.tan(fov.upDegrees * DEG2RAD),\n            downTan: Math.tan(fov.downDegrees * DEG2RAD),\n            leftTan: Math.tan(fov.leftDegrees * DEG2RAD),\n            rightTan: Math.tan(fov.rightDegrees * DEG2RAD)\n        };\n\n        return fovPortToProjection(fovPort, rightHanded, zNear, zFar);\n\n    }\n\n}\n\nexport default VREffect;\n\n\n\n// WEBPACK FOOTER //\n// ./src/vr/effect.js","import { rollerCoasterMeshFactory } from './roller-coaster';\nimport { rollerCoasterLifterMeshFactory } from './roller-coaster-lifter';\nimport { rollerCoasterShadowMeshFactory } from './roller-coaster-shadow';\nimport { groundMeshFactory } from './ground';\nimport VRControl from './vr/control';\nimport VREffect from './vr/effect';\nimport * as vrUtils from './vr/utils';\n\nif (!vrUtils.isWebVRAvailable()) {\n    vrUtils.getHelpMessageElement((element) => {\n        document.body.appendChild(element);\n    });\n}\n\nconst renderer = new THREE.WebGLRenderer({ antialias: true });\nrenderer.setClearColor(0xf0f0ff);\nrenderer.setPixelRatio(window.devicePixelRatio);\nrenderer.setSize(window.innerWidth, window.innerHeight);\n\ndocument.body.appendChild(renderer.domElement);\n\nconst scene = new THREE.Scene();\n\n// Light\nconst light = new THREE.HemisphereLight(0xfff0f0, 0x606066);\nlight.position.set(1, 1, 1);\nscene.add(light);\n\n// Train\nconst train = new THREE.Object3D();\nscene.add(train);\nconst camera = new THREE.PerspectiveCamera(40, window.innerWidth / window.innerHeight, 0.1, 500);\ntrain.add(camera);\n\n// Roller coaster rail\nconst PI2 = Math.PI * 2;\nconst curve = (() => {\n    const v1 = new THREE.Vector3();\n    const v2 = new THREE.Vector3();\n\n    return {\n        getPointAt(t) {\n            const p = t * PI2;\n\n            const x = Math.sin(p * 3) * Math.cos(p * 4) * 50;\n            const y = Math.sin(p * 10) * 2 + Math.cos(p * 17) * 2 + 5;\n            const z = Math.sin(p) * Math.sin(p * 4) * 50;\n\n            return v1.set(x, y, z).multiplyScalar(2);\n        },\n\n        getTangentAt(t) {\n            const delta = 0.00001;\n\n            const t1 = Math.max(0, t - delta);\n            const t2 = Math.min(1, t + delta);\n\n            return v2\n                .copy(this.getPointAt(t2))\n                .sub(this.getPointAt(t1))\n                .normalize();\n        }\n    }\n})();\n\nconst rollerCoasterMesh = rollerCoasterMeshFactory(curve, 1500);\nscene.add(rollerCoasterMesh);\n\n// Roller coaster lifters\nconst rollerCoasterLifterMesh = rollerCoasterLifterMeshFactory(curve, 100);\nscene.add(rollerCoasterLifterMesh);\n\n// Roller coaster shadow\nconst rollerCoasterShadowMesh = rollerCoasterShadowMeshFactory(curve, 500);\nscene.add(rollerCoasterShadowMesh);\n\n// Terrain\ngroundMeshFactory(scene, 500, 500);\nscene.background = new THREE.CubeTextureLoader()\n    .setPath('../images/')\n    .load(['left.bmp', 'right.bmp', 'top.bmp', 'bottom.bmp', 'front.bmp', 'back.bmp']);\n\n// VR\nconst control = new VRControl(camera);\nconst effect = new VREffect(renderer);\n\ncontrol.init();\n\nvrUtils.getVRDisplay((err, display) => {\n    if (err) {\n        return;\n    }\n\n    const buttonElem = vrUtils.getButton(display, renderer.domElement);\n    document.body.appendChild(buttonElem);\n});\n\nwindow.addEventListener('resize', () => {\n    camera.aspect = window.innerWidth / window.innerHeight;\n    camera.updateProjectionMatrix();\n    effect.setSize(window.innerWidth, window.innerHeight);\n});\n\n\n// Animation\nconst position = new THREE.Vector3();\nconst tangent = new THREE.Vector3();\nconst lookAt = new THREE.Vector3();\n\nlet velocity = 0;\nlet progress = 0;\nlet prevTime = window.performance.now();\n\nfunction animate(time) {\n    effect.requestAnimationFrame(animate);\n\n    const delta = time - prevTime;\n\n    progress += velocity;\n    progress = progress % 1;\n    position.copy(curve.getPointAt(progress));\n    position.y += 0.3;\n    train.position.copy(position);\n    tangent.copy(curve.getTangentAt(progress));\n    velocity -= tangent.y * 0.0000001 * delta;\n    velocity = Math.max(0.00001, Math.min(0.0002, velocity));\n    train.lookAt(lookAt.copy(position).sub(tangent));\n\n    control.update();\n    effect.render(scene, camera);\n\n    prevTime = time;\n}\n\neffect.requestAnimationFrame(animate);\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","function RollerCoasterLiftersGeometry(curve, divisions) {\n\n    THREE.BufferGeometry.call(this);\n\n    var vertices = [];\n    var normals = [];\n\n    var quaternion = new THREE.Quaternion();\n\n    var up = new THREE.Vector3(0, 1, 0);\n\n    var point = new THREE.Vector3();\n    var tangent = new THREE.Vector3();\n\n    // shapes\n\n    var tube1 = [\n        new THREE.Vector3(0, 0.05, -0.05),\n        new THREE.Vector3(0, 0.05, 0.05),\n        new THREE.Vector3(0, -0.05, 0)\n    ];\n\n    var tube2 = [\n        new THREE.Vector3(-0.05, 0, 0.05),\n        new THREE.Vector3(-0.05, 0, -0.05),\n        new THREE.Vector3(0.05, 0, 0)\n    ];\n\n    var tube3 = [\n        new THREE.Vector3(0.05, 0, -0.05),\n        new THREE.Vector3(0.05, 0, 0.05),\n        new THREE.Vector3(-0.05, 0, 0)\n    ];\n\n    var vector1 = new THREE.Vector3();\n    var vector2 = new THREE.Vector3();\n    var vector3 = new THREE.Vector3();\n    var vector4 = new THREE.Vector3();\n\n    var normal1 = new THREE.Vector3();\n    var normal2 = new THREE.Vector3();\n    var normal3 = new THREE.Vector3();\n    var normal4 = new THREE.Vector3();\n\n    function extrudeShape(shape, fromPoint, toPoint) {\n\n        for (var j = 0, jl = shape.length; j < jl; j++) {\n\n            var point1 = shape[j];\n            var point2 = shape[( j + 1 ) % jl];\n\n            vector1.copy(point1);\n            vector1.applyQuaternion(quaternion);\n            vector1.add(fromPoint);\n\n            vector2.copy(point2);\n            vector2.applyQuaternion(quaternion);\n            vector2.add(fromPoint);\n\n            vector3.copy(point2);\n            vector3.applyQuaternion(quaternion);\n            vector3.add(toPoint);\n\n            vector4.copy(point1);\n            vector4.applyQuaternion(quaternion);\n            vector4.add(toPoint);\n\n            vertices.push(vector1.x, vector1.y, vector1.z);\n            vertices.push(vector2.x, vector2.y, vector2.z);\n            vertices.push(vector4.x, vector4.y, vector4.z);\n\n            vertices.push(vector2.x, vector2.y, vector2.z);\n            vertices.push(vector3.x, vector3.y, vector3.z);\n            vertices.push(vector4.x, vector4.y, vector4.z);\n\n            //\n\n            normal1.copy(point1);\n            normal1.applyQuaternion(quaternion);\n            normal1.normalize();\n\n            normal2.copy(point2);\n            normal2.applyQuaternion(quaternion);\n            normal2.normalize();\n\n            normal3.copy(point2);\n            normal3.applyQuaternion(quaternion);\n            normal3.normalize();\n\n            normal4.copy(point1);\n            normal4.applyQuaternion(quaternion);\n            normal4.normalize();\n\n            normals.push(normal1.x, normal1.y, normal1.z);\n            normals.push(normal2.x, normal2.y, normal2.z);\n            normals.push(normal4.x, normal4.y, normal4.z);\n\n            normals.push(normal2.x, normal2.y, normal2.z);\n            normals.push(normal3.x, normal3.y, normal3.z);\n            normals.push(normal4.x, normal4.y, normal4.z);\n\n        }\n\n    };\n\n    var fromPoint = new THREE.Vector3();\n    var toPoint = new THREE.Vector3();\n\n    for (var i = 1; i <= divisions; i++) {\n\n        point.copy(curve.getPointAt(i / divisions));\n        tangent.copy(curve.getTangentAt(i / divisions));\n\n        var angle = Math.atan2(tangent.x, tangent.z);\n\n        quaternion.setFromAxisAngle(up, angle);\n\n        //\n\n        if (point.y > 10) {\n\n            fromPoint.set(-0.75, -0.35, 0);\n            fromPoint.applyQuaternion(quaternion);\n            fromPoint.add(point);\n\n            toPoint.set(0.75, -0.35, 0);\n            toPoint.applyQuaternion(quaternion);\n            toPoint.add(point);\n\n            extrudeShape(tube1, fromPoint, toPoint);\n\n            fromPoint.set(-0.7, -0.3, 0);\n            fromPoint.applyQuaternion(quaternion);\n            fromPoint.add(point);\n\n            toPoint.set(-0.7, -point.y, 0);\n            toPoint.applyQuaternion(quaternion);\n            toPoint.add(point);\n\n            extrudeShape(tube2, fromPoint, toPoint);\n\n            fromPoint.set(0.7, -0.3, 0);\n            fromPoint.applyQuaternion(quaternion);\n            fromPoint.add(point);\n\n            toPoint.set(0.7, -point.y, 0);\n            toPoint.applyQuaternion(quaternion);\n            toPoint.add(point);\n\n            extrudeShape(tube3, fromPoint, toPoint);\n\n        } else {\n\n            fromPoint.set(0, -0.2, 0);\n            fromPoint.applyQuaternion(quaternion);\n            fromPoint.add(point);\n\n            toPoint.set(0, -point.y, 0);\n            toPoint.applyQuaternion(quaternion);\n            toPoint.add(point);\n\n            extrudeShape(tube3, fromPoint, toPoint);\n\n        }\n\n    }\n\n    this.addAttribute('position', new THREE.BufferAttribute(new Float32Array(vertices), 3));\n    this.addAttribute('normal', new THREE.BufferAttribute(new Float32Array(normals), 3));\n}\n\nRollerCoasterLiftersGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);\n\nexport default RollerCoasterLiftersGeometry;\n\n\n\n// WEBPACK FOOTER //\n// ./src/roller-coaster-lifter/geometry.js","function RollerCoasterShadowGeometry(curve, divisions) {\n\n    THREE.BufferGeometry.call(this);\n\n    var vertices = [];\n\n    var up = new THREE.Vector3(0, 1, 0);\n    var forward = new THREE.Vector3();\n\n    var quaternion = new THREE.Quaternion();\n    var prevQuaternion = new THREE.Quaternion();\n    prevQuaternion.setFromAxisAngle(up, Math.PI / 2);\n\n    var point = new THREE.Vector3();\n\n    var prevPoint = new THREE.Vector3();\n    prevPoint.copy(curve.getPointAt(0));\n    prevPoint.y = 0;\n\n    var vector1 = new THREE.Vector3();\n    var vector2 = new THREE.Vector3();\n    var vector3 = new THREE.Vector3();\n    var vector4 = new THREE.Vector3();\n\n    for (var i = 1; i <= divisions; i++) {\n\n        point.copy(curve.getPointAt(i / divisions));\n        point.y = 0;\n\n        forward.subVectors(point, prevPoint);\n\n        var angle = Math.atan2(forward.x, forward.z);\n\n        quaternion.setFromAxisAngle(up, angle);\n\n        vector1.set(-0.3, 0, 0);\n        vector1.applyQuaternion(quaternion);\n        vector1.add(point);\n\n        vector2.set(0.3, 0, 0);\n        vector2.applyQuaternion(quaternion);\n        vector2.add(point);\n\n        vector3.set(0.3, 0, 0);\n        vector3.applyQuaternion(prevQuaternion);\n        vector3.add(prevPoint);\n\n        vector4.set(-0.3, 0, 0);\n        vector4.applyQuaternion(prevQuaternion);\n        vector4.add(prevPoint);\n\n        vertices.push(vector1.x, vector1.y, vector1.z);\n        vertices.push(vector2.x, vector2.y, vector2.z);\n        vertices.push(vector4.x, vector4.y, vector4.z);\n\n        vertices.push(vector2.x, vector2.y, vector2.z);\n        vertices.push(vector3.x, vector3.y, vector3.z);\n        vertices.push(vector4.x, vector4.y, vector4.z);\n\n        prevPoint.copy(point);\n        prevQuaternion.copy(quaternion);\n\n    }\n\n    this.addAttribute('position', new THREE.BufferAttribute(new Float32Array(vertices), 3));\n\n};\n\nRollerCoasterShadowGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);\n\nexport default RollerCoasterShadowGeometry;\n\n\n\n// WEBPACK FOOTER //\n// ./src/roller-coaster-shadow/geometry.js","function RollerCoasterGeometry(curve, divisions) {\n\n    THREE.BufferGeometry.call(this);\n\n    var vertices = [];\n    var normals = [];\n    var colors = [];\n\n    //레일 그릴 때 필요한 색\n    var color1 = [1, 1, 1];\t//하얀색\n    var color2 = [1, 0.3, 0.2];\t//노란색\n\n    var up = new THREE.Vector3(0, 1, 0);\n    var forward = new THREE.Vector3();\n    var right = new THREE.Vector3();\n\n    //quaternion은 4x4 행렬을 의미함\n    var quaternion = new THREE.Quaternion();\n    var prevQuaternion = new THREE.Quaternion();\n    prevQuaternion.setFromAxisAngle(up, Math.PI / 2);\n\n    var point = new THREE.Vector3();\n    var prevPoint = new THREE.Vector3();\n    prevPoint.copy(curve.getPointAt(0));\n\n    // shapes\n    //가운데 레일 옆 세모 두 개\n    var step = [\n        //왼쪽 세모\n        new THREE.Vector3(-0.225, 0, 0),\n        new THREE.Vector3(0, -0.050, 0),\n        new THREE.Vector3(0, -0.175, 0),\n        //오른쪽 세모\n        new THREE.Vector3(0, -0.050, 0),\n        new THREE.Vector3(0.225, 0, 0),\n        new THREE.Vector3(0, -0.175, 0)\n    ];\n\n    var PI2 = Math.PI * 2; //360도\n    var step1 = [];\n    for (var i = 0; i < 5; i++) {\n\n        var angle = ( i / 5 ) * PI2;\t//angle이 72, 144, 216, 288, 360 다섯 가지가 됨\n        step1.push(new THREE.Vector3(0, Math.sin(angle) * 0.02, Math.cos(angle) * 0.02));\n\n    }\n\n    //가운데 레일에 관한 설정\n    var sides = 5;\t//오각 원통 모양을 의미하는 듯\n    var tube1 = [];\n\n    for (var i = 0; i < sides; i++) {\n\n        var angle = ( i / sides ) * PI2;\t//angle이 72, 144, 216, 288, 360 다섯 가지가 됨\n        tube1.push(new THREE.Vector3(Math.sin(angle) * 0.06, Math.cos(angle) * 0.06, 0));\t//0.06은 사이즈에 관한 상수 값, sin^2+cos^2 = 1\n\n    }\n    //양 옆의 레일에 관한 설정\n    var sides = 6;\t//육각 원통 모양을 의미하는 듯\n    var tube2 = [];\n\n    for (var i = 0; i < sides; i++) {\n\n        var angle = ( i / sides ) * PI2;\t//angle이 60, 120, 180, 240, 300, 360 여섯 가지가 됨\n        tube2.push(new THREE.Vector3(Math.sin(angle) * 0.025, Math.cos(angle) * 0.025, 0));\t//0.025라서 가운데 레일보다 사이즈가 작음\n\n    }\n\n    var vector = new THREE.Vector3();\n    var normal = new THREE.Vector3();\n\n    function drawShape(shape, color) {\t//해당 색을 가지는 도형 그리기\n\n        normal.set(0, 0, -1).applyQuaternion(quaternion);\t//normal vector가 이동 방향의 반대(우리가 앞을 볼 때 보이는 면)\n\n        for (var j = 0; j < shape.length; j++) {\n\n            vector.copy(shape[j]);\n            vector.applyQuaternion(quaternion);\n            vector.add(point);\n\n            vertices.push(vector.x, vector.y, vector.z);\n            normals.push(normal.x, normal.y, normal.z);\n            colors.push(color[0], color[1], color[2]);\n\n        }\n\n        normal.set(0, 0, 1).applyQuaternion(quaternion);\t//normal vector가 이동 방향(우리가 뒤를 볼 때 보이는 면)\n\n        for (var j = shape.length - 1; j >= 0; j--) {\n\n            vector.copy(shape[j]);\n            vector.applyQuaternion(quaternion);\n            vector.add(point);\n\n            vertices.push(vector.x, vector.y, vector.z);\n            normals.push(normal.x, normal.y, normal.z);\n            colors.push(color[0], color[1], color[2]);\n\n        }\n\n    };\n\n    var vector1 = new THREE.Vector3();\n    var vector2 = new THREE.Vector3();\n    var vector3 = new THREE.Vector3();\n    var vector4 = new THREE.Vector3();\n\n    var normal1 = new THREE.Vector3();\n    var normal2 = new THREE.Vector3();\n    var normal3 = new THREE.Vector3();\n    var normal4 = new THREE.Vector3();\n\n    function extrudeShape(shape, offset, color) {\t//얘는 삼각형 같은 평면도형을 그리는 drawShape는 다르게 레일처럼 입체도형을 그리는데 사용하는 듯.\n\n        for (var j = 0, jl = shape.length; j < jl; j++) {\n\n            var point1 = shape[j];\n            var point2 = shape[( j + 1 ) % jl];\n\n            vector1.copy(point1).add(offset);\n            vector1.applyQuaternion(quaternion);\n            vector1.add(point);\n\n            vector2.copy(point2).add(offset);\n            vector2.applyQuaternion(quaternion);\n            vector2.add(point);\n\n            vector3.copy(point2).add(offset);\n            vector3.applyQuaternion(prevQuaternion);\n            vector3.add(prevPoint);\n\n            vector4.copy(point1).add(offset);\n            vector4.applyQuaternion(prevQuaternion);\n            vector4.add(prevPoint);\n\n            vertices.push(vector1.x, vector1.y, vector1.z);\n            vertices.push(vector2.x, vector2.y, vector2.z);\n            vertices.push(vector4.x, vector4.y, vector4.z);\n\n            vertices.push(vector2.x, vector2.y, vector2.z);\n            vertices.push(vector3.x, vector3.y, vector3.z);\n            vertices.push(vector4.x, vector4.y, vector4.z);\n\n            //\n\n            normal1.copy(point1);\n            normal1.applyQuaternion(quaternion);\n            normal1.normalize();\n\n            normal2.copy(point2);\n            normal2.applyQuaternion(quaternion);\n            normal2.normalize();\n\n            normal3.copy(point2);\n            normal3.applyQuaternion(prevQuaternion);\n            normal3.normalize();\n\n            normal4.copy(point1);\n            normal4.applyQuaternion(prevQuaternion);\n            normal4.normalize();\n\n            normals.push(normal1.x, normal1.y, normal1.z);\n            normals.push(normal2.x, normal2.y, normal2.z);\n            normals.push(normal4.x, normal4.y, normal4.z);\n\n            normals.push(normal2.x, normal2.y, normal2.z);\n            normals.push(normal3.x, normal3.y, normal3.z);\n            normals.push(normal4.x, normal4.y, normal4.z);\n\n            colors.push(color[0], color[1], color[2]);\n            colors.push(color[0], color[1], color[2]);\n            colors.push(color[0], color[1], color[2]);\n\n            colors.push(color[0], color[1], color[2]);\n            colors.push(color[0], color[1], color[2]);\n            colors.push(color[0], color[1], color[2]);\n\n        }\n\n    };\n\n    function extrudeShapeSide(shape, fromPoint, toPoint, color) {\n\n        for (var j = 0, jl = shape.length; j < jl; j++) {\n\n            var point1 = shape[j];\n            var point2 = shape[( j + 1 ) % jl];\n\n            vector1.copy(point1);\n            vector1.applyQuaternion(quaternion);\n            vector1.add(fromPoint);\n\n            vector2.copy(point2);\n            vector2.applyQuaternion(quaternion);\n            vector2.add(fromPoint);\n\n            vector3.copy(point2);\n            vector3.applyQuaternion(quaternion);\n            vector3.add(toPoint);\n\n            vector4.copy(point1);\n            vector4.applyQuaternion(quaternion);\n            vector4.add(toPoint);\n\n            vertices.push(vector1.x, vector1.y, vector1.z);\n            vertices.push(vector2.x, vector2.y, vector2.z);\n            vertices.push(vector4.x, vector4.y, vector4.z);\n\n            vertices.push(vector2.x, vector2.y, vector2.z);\n            vertices.push(vector3.x, vector3.y, vector3.z);\n            vertices.push(vector4.x, vector4.y, vector4.z);\n\n            //\n\n            normal1.copy(point1);\n            normal1.applyQuaternion(quaternion);\n            normal1.normalize();\n\n            normal2.copy(point2);\n            normal2.applyQuaternion(quaternion);\n            normal2.normalize();\n\n            normal3.copy(point2);\n            normal3.applyQuaternion(quaternion);\n            normal3.normalize();\n\n            normal4.copy(point1);\n            normal4.applyQuaternion(quaternion);\n            normal4.normalize();\n\n            normals.push(normal1.x, normal1.y, normal1.z);\n            normals.push(normal2.x, normal2.y, normal2.z);\n            normals.push(normal4.x, normal4.y, normal4.z);\n\n            normals.push(normal2.x, normal2.y, normal2.z);\n            normals.push(normal3.x, normal3.y, normal3.z);\n            normals.push(normal4.x, normal4.y, normal4.z);\n\n            colors.push(color[0], color[1], color[2]);\n            colors.push(color[0], color[1], color[2]);\n            colors.push(color[0], color[1], color[2]);\n\n            colors.push(color[0], color[1], color[2]);\n            colors.push(color[0], color[1], color[2]);\n            colors.push(color[0], color[1], color[2]);\n\n        }\n\n    };\n\n    var offset = new THREE.Vector3();\n    var fromPoint = new THREE.Vector3();\n    var toPoint = new THREE.Vector3();\n\n\n    for (var i = 1; i <= divisions; i++) {\n\n        point.copy(curve.getPointAt(i / divisions));\n\n        up.set(0, 1, 0);\n\n        forward.subVectors(point, prevPoint).normalize();\n        right.crossVectors(up, forward).normalize();\n        up.crossVectors(forward, right);\n\n        var angle = Math.atan2(forward.x, forward.z);\n\n        quaternion.setFromAxisAngle(up, angle);\n\n        if (i % 2 === 0) {\n            //가운데 노란 레일 양 옆에 노란색 세모 두 개 그리기\n            //drawShape( step, color2 );\n            fromPoint.set(-0.2, -0.02, 0);\n            fromPoint.applyQuaternion(quaternion);\n            fromPoint.add(point);\n\n            toPoint.set(0, -0.135, 0);\n            toPoint.applyQuaternion(quaternion);\n            toPoint.add(point);\n            extrudeShapeSide(step1, fromPoint, toPoint, color2);\n\n            fromPoint.set(0.2, -0.02, 0);\n            fromPoint.applyQuaternion(quaternion);\n            fromPoint.add(point);\n\n            toPoint.set(0, -0.135, 0);\n            toPoint.applyQuaternion(quaternion);\n            toPoint.add(point);\n            extrudeShapeSide(step1, fromPoint, toPoint, color2);\n        }\n\n        //가운데에 노란색 레일 그리기\n        extrudeShape(tube1, offset.set(0, -0.125, 0), color2);\n        //양 옆에 하얀색 레일 그리기\n        extrudeShape(tube2, offset.set(0.2, 0, 0), color1);\n        extrudeShape(tube2, offset.set(-0.2, 0, 0), color1);\n\n        prevPoint.copy(point);\n        prevQuaternion.copy(quaternion);\n\n    }\n\n    // console.log( vertices.length );\n\n    this.addAttribute('position', new THREE.BufferAttribute(new Float32Array(vertices), 3));\n    this.addAttribute('normal', new THREE.BufferAttribute(new Float32Array(normals), 3));\n    this.addAttribute('color', new THREE.BufferAttribute(new Float32Array(colors), 3));\n\n}\n\nRollerCoasterGeometry.prototype = Object.create(THREE.BufferGeometry.prototype);\n\nexport default RollerCoasterGeometry;\n\n\n\n// WEBPACK FOOTER //\n// ./src/roller-coaster/roller-coaster.js"],"sourceRoot":""}