{"version":3,"sources":["webpack:///webpack/bootstrap d0982c9a7eb45b007d23","webpack:///./src/vr/utils.js","webpack:///./src/geometries/roller-coaster.js","webpack:///./src/vr/control.js","webpack:///./src/vr/effect.js","webpack:///./src/main.js"],"names":["isWebVRAvailable","navigator","getVRDisplays","undefined","getVRDisplay","callback","then","displays","catch","error","getHelpMessageElement","makeMessageElement","message","container","document","createElement","style","position","left","top","right","zIndex","align","fontFamily","fontSize","fontStyle","lineHeight","backgroundColor","color","padding","margin","display","innerHTML","appendChild","err","vrDisplay","RollerCoasterGeometry","THREE","BufferGeometry","constructor","curve","divisions","vertices","normals","colors","color1","color2","up","Vector3","forward","quaternion","Quaternion","prevQuaternion","setFromAxisAngle","Math","PI","point","prevPoint","copy","getPointAt","step","PI2","sides","tube1","i","angle","push","sin","cos","tube2","vector","normal","drawShape","shape","set","applyQuaternion","j","length","add","x","y","z","vector1","vector2","vector3","vector4","normal1","normal2","normal3","normal4","extrudeShape","offset","jl","point1","point2","normalize","subVectors","crossVectors","atan2","addAttribute","BufferAttribute","Float32Array","VRControl","object","standingMatrix","Matrix4","scale","standing","userHeight","frameData","init","onError","window","VRFrameData","console","warn","setVRDisplay","value","getStandingMaxtrix","update","getFrameData","pose","orientation","fromArray","stageParameters","updateMatrix","sittingToStandingTransform","applyMatrix","setY","dispose","VREffect","renderer","vrDisplays","eyeTranslationL","eyeTranslationR","renderRectL","renderRectR","gotVRDisplays","log","isPresenting","scope","rendererSize","getSize","rendererUpdateStyle","rendererPixelRatio","getPixelRatio","setSize","width","height","updateStyle","eyeParamsL","getEyeParameters","setPixelRatio","renderWidth","renderHeight","canvas","domElement","defaultLeftBounds","defaultRightBounds","onVRDisplayPresentChange","wasPresenting","eyeWidth","eyeHeight","addEventListener","setFullScreen","boolean","Promise","resolve","reject","Error","requestPresent","source","exitPresent","requestAnimationFrame","f","cancelAnimationFrame","h","submitFrame","autoSubmitFrame","cameraL","PerspectiveCamera","layers","enable","cameraR","render","scene","camera","renderTarget","forceClear","autoUpdate","updateMatrixWorld","eyeParamsR","Array","isArray","size","getLayers","leftBounds","rightBounds","layer","round","setRenderTarget","scissorTest","setScissorTest","autoClear","clear","parent","matrixWorld","decompose","translateOnAxis","depthNear","near","depthFar","far","projectionMatrix","elements","leftProjectionMatrix","rightProjectionMatrix","fovToProjection","fieldOfView","viewport","scissor","setViewport","setScissor","removeEventListener","fovToNDCScaleOffset","fov","pxscale","leftTan","rightTan","pxoffset","pyscale","upTan","downTan","pyoffset","fovPortToProjection","rightHanded","zNear","zFar","handednessScale","mobj","m","scaleAndOffset","transpose","DEG2RAD","fovPort","tan","upDegrees","downDegrees","leftDegrees","rightDegrees","element","body","WebGLRenderer","antialias","setClearColor","devicePixelRatio","innerWidth","innerHeight","Scene","light","HemisphereLight","train","Object3D","v1","v2","t","p","multiplyScalar","getTangentAt","delta","t1","max","t2","min","sub","rollerCoasterGeometry","material","MeshPhongMaterial","vertexColors","VertexColors","mesh","Mesh","control","effect","aspect","updateProjectionMatrix","tangent","lookAt","velocity","progress","prevTime","performance","now","animate","time"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;;;AChEO,SAASA,gBAAT,GAA4B;AAC/B,WAAOC,UAAUC,aAAV,KAA4BC,SAAnC;AACH;;AAEM,SAASC,YAAT,CAAsBC,QAAtB,EAAgC;AACnC,QAAI,CAACL,kBAAL,EAAyB;AACrBK,iBAAS,gCAAT,EAA2C,IAA3C;AACA;AACH;;AAEDJ,cACKC,aADL,GAEKI,IAFL,CAEWC,QAAD,IAAc;AAChBF,iBAAS,IAAT,EAAeE,SAAS,CAAT,CAAf;AACH,KAJL,EAKKC,KALL,CAKYC,KAAD,IAAW;AACdJ,iBAASI,KAAT,EAAgB,IAAhB;AACH,KAPL;AAQH;;AAEM,SAASC,qBAAT,CAA+BL,QAA/B,EAAyC;AAC5C,UAAMM,qBAAsBC,OAAD,IAAa;AACpC,cAAMC,YAAYC,SAASC,aAAT,CAAuB,KAAvB,CAAlB;AACAF,kBAAUG,KAAV,CAAgBC,QAAhB,GAA2B,UAA3B;AACAJ,kBAAUG,KAAV,CAAgBE,IAAhB,GAAuB,GAAvB;AACAL,kBAAUG,KAAV,CAAgBG,GAAhB,GAAsB,GAAtB;AACAN,kBAAUG,KAAV,CAAgBI,KAAhB,GAAwB,GAAxB;AACAP,kBAAUG,KAAV,CAAgBK,MAAhB,GAAyB,KAAzB;AACAR,kBAAUS,KAAV,GAAkB,QAAlB;;AAEA,cAAMb,QAAQK,SAASC,aAAT,CAAuB,KAAvB,CAAd;AACAN,cAAMO,KAAN,CAAYO,UAAZ,GAAyB,YAAzB;AACAd,cAAMO,KAAN,CAAYQ,QAAZ,GAAuB,MAAvB;AACAf,cAAMO,KAAN,CAAYS,SAAZ,GAAwB,QAAxB;AACAhB,cAAMO,KAAN,CAAYU,UAAZ,GAAyB,MAAzB;AACAjB,cAAMO,KAAN,CAAYW,eAAZ,GAA8B,MAA9B;AACAlB,cAAMO,KAAN,CAAYY,KAAZ,GAAoB,MAApB;AACAnB,cAAMO,KAAN,CAAYa,OAAZ,GAAsB,WAAtB;AACApB,cAAMO,KAAN,CAAYc,MAAZ,GAAqB,MAArB;AACArB,cAAMO,KAAN,CAAYe,OAAZ,GAAsB,cAAtB;AACAtB,cAAMuB,SAAN,GAAkBpB,OAAlB;AACAC,kBAAUoB,WAAV,CAAsBxB,KAAtB;;AAEAJ,iBAASQ,SAAT;AACH,KAvBD;;AAyBAT,iBAAa,CAAC8B,GAAD,EAAMC,SAAN,KAAoB;AAC7B,YAAID,GAAJ,EAAS;AACLvB,+BAAmB,qGAAnB;AACH,SAFD,MAEO,IAAI,CAACwB,SAAL,EAAgB;AACnBxB,+BAAmB,2CAAnB;AACH,SAFM,MAEA;AACHN,qBAAS,IAAT;AACH;AACJ,KARD;AASH,C;;;;;;;ACvDD,MAAM+B,qBAAN,SAAoCC,MAAMC,cAA1C,CAAyD;AACrDC,gBAAYC,KAAZ,EAAmBC,SAAnB,EAA8B;AAC1B;;AAEA,YAAIC,WAAW,EAAf;AACA,YAAIC,UAAU,EAAd;AACA,YAAIC,SAAS,EAAb;;AAEA,YAAIC,SAAS,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAAb;AACA,YAAIC,SAAS,CAAC,CAAD,EAAI,CAAJ,EAAO,CAAP,CAAb;;AAEA,YAAIC,KAAK,IAAIV,MAAMW,OAAV,CAAkB,CAAlB,EAAqB,CAArB,EAAwB,CAAxB,CAAT;AACA,YAAIC,UAAU,IAAIZ,MAAMW,OAAV,EAAd;AACA,YAAI5B,QAAQ,IAAIiB,MAAMW,OAAV,EAAZ;;AAEA,YAAIE,aAAa,IAAIb,MAAMc,UAAV,EAAjB;AACA,YAAIC,iBAAiB,IAAIf,MAAMc,UAAV,EAArB;AACAC,uBAAeC,gBAAf,CAAgCN,EAAhC,EAAoCO,KAAKC,EAAL,GAAU,CAA9C;;AAEA,YAAIC,QAAQ,IAAInB,MAAMW,OAAV,EAAZ;AACA,YAAIS,YAAY,IAAIpB,MAAMW,OAAV,EAAhB;AACAS,kBAAUC,IAAV,CAAelB,MAAMmB,UAAN,CAAiB,CAAjB,CAAf;;AAEA;;AAEA,YAAIC,OAAO,CACP,IAAIvB,MAAMW,OAAV,CAAkB,CAAC,KAAnB,EAA0B,CAA1B,EAA6B,CAA7B,CADO,EAEP,IAAIX,MAAMW,OAAV,CAAkB,CAAlB,EAAqB,CAAC,KAAtB,EAA6B,CAA7B,CAFO,EAGP,IAAIX,MAAMW,OAAV,CAAkB,CAAlB,EAAqB,CAAC,KAAtB,EAA6B,CAA7B,CAHO,EAKP,IAAIX,MAAMW,OAAV,CAAkB,CAAlB,EAAqB,CAAC,KAAtB,EAA6B,CAA7B,CALO,EAMP,IAAIX,MAAMW,OAAV,CAAkB,KAAlB,EAAyB,CAAzB,EAA4B,CAA5B,CANO,EAOP,IAAIX,MAAMW,OAAV,CAAkB,CAAlB,EAAqB,CAAC,KAAtB,EAA6B,CAA7B,CAPO,CAAX;;AAUA,YAAIa,MAAMP,KAAKC,EAAL,GAAU,CAApB;;AAEA,YAAIO,QAAQ,CAAZ;AACA,YAAIC,QAAQ,EAAZ;;AAEA,aAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIF,KAApB,EAA2BE,GAA3B,EAAgC;;AAE5B,gBAAIC,QAAUD,IAAIF,KAAN,GAAgBD,GAA5B;AACAE,kBAAMG,IAAN,CAAW,IAAI7B,MAAMW,OAAV,CAAkBM,KAAKa,GAAL,CAASF,KAAT,IAAkB,IAApC,EAA0CX,KAAKc,GAAL,CAASH,KAAT,IAAkB,IAA5D,EAAkE,CAAlE,CAAX;AAEH;;AAED,YAAIH,QAAQ,CAAZ;AACA,YAAIO,QAAQ,EAAZ;;AAEA,aAAK,IAAIL,IAAI,CAAb,EAAgBA,IAAIF,KAApB,EAA2BE,GAA3B,EAAgC;;AAE5B,gBAAIC,QAAUD,IAAIF,KAAN,GAAgBD,GAA5B;AACAQ,kBAAMH,IAAN,CAAW,IAAI7B,MAAMW,OAAV,CAAkBM,KAAKa,GAAL,CAASF,KAAT,IAAkB,KAApC,EAA2CX,KAAKc,GAAL,CAASH,KAAT,IAAkB,KAA7D,EAAoE,CAApE,CAAX;AAEH;;AAED,YAAIK,SAAS,IAAIjC,MAAMW,OAAV,EAAb;AACA,YAAIuB,SAAS,IAAIlC,MAAMW,OAAV,EAAb;;AAEA,iBAASwB,SAAT,CAAmBC,KAAnB,EAA0B7C,KAA1B,EAAiC;;AAE7B2C,mBAAOG,GAAP,CAAW,CAAX,EAAc,CAAd,EAAiB,CAAC,CAAlB,EAAqBC,eAArB,CAAqCzB,UAArC;;AAEA,iBAAK,IAAI0B,IAAI,CAAb,EAAgBA,IAAIH,MAAMI,MAA1B,EAAkCD,GAAlC,EAAuC;;AAEnCN,uBAAOZ,IAAP,CAAYe,MAAMG,CAAN,CAAZ;AACAN,uBAAOK,eAAP,CAAuBzB,UAAvB;AACAoB,uBAAOQ,GAAP,CAAWtB,KAAX;;AAEAd,yBAASwB,IAAT,CAAcI,OAAOS,CAArB,EAAwBT,OAAOU,CAA/B,EAAkCV,OAAOW,CAAzC;AACAtC,wBAAQuB,IAAR,CAAaK,OAAOQ,CAApB,EAAuBR,OAAOS,CAA9B,EAAiCT,OAAOU,CAAxC;AACArC,uBAAOsB,IAAP,CAAYtC,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AAEH;;AAED2C,mBAAOG,GAAP,CAAW,CAAX,EAAc,CAAd,EAAiB,CAAjB,EAAoBC,eAApB,CAAoCzB,UAApC;;AAEA,iBAAK,IAAI0B,IAAI,CAAb,EAAgBA,IAAIH,MAAMI,MAA1B,EAAkCD,GAAlC,EAAuC;;AAEnCN,uBAAOZ,IAAP,CAAYe,MAAMG,CAAN,CAAZ;AACAN,uBAAOK,eAAP,CAAuBzB,UAAvB;AACAoB,uBAAOQ,GAAP,CAAWtB,KAAX;;AAEAd,yBAASwB,IAAT,CAAcI,OAAOS,CAArB,EAAwBT,OAAOU,CAA/B,EAAkCV,OAAOW,CAAzC;AACAtC,wBAAQuB,IAAR,CAAaK,OAAOQ,CAApB,EAAuBR,OAAOS,CAA9B,EAAiCT,OAAOU,CAAxC;AACArC,uBAAOsB,IAAP,CAAYtC,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AAEH;AAEJ;;AAED,YAAIsD,UAAU,IAAI7C,MAAMW,OAAV,EAAd;AACA,YAAImC,UAAU,IAAI9C,MAAMW,OAAV,EAAd;AACA,YAAIoC,UAAU,IAAI/C,MAAMW,OAAV,EAAd;AACA,YAAIqC,UAAU,IAAIhD,MAAMW,OAAV,EAAd;;AAEA,YAAIsC,UAAU,IAAIjD,MAAMW,OAAV,EAAd;AACA,YAAIuC,UAAU,IAAIlD,MAAMW,OAAV,EAAd;AACA,YAAIwC,UAAU,IAAInD,MAAMW,OAAV,EAAd;AACA,YAAIyC,UAAU,IAAIpD,MAAMW,OAAV,EAAd;;AAEA,iBAAS0C,YAAT,CAAsBjB,KAAtB,EAA6BkB,MAA7B,EAAqC/D,KAArC,EAA4C;;AAExC,iBAAK,IAAIgD,IAAI,CAAR,EAAWgB,KAAKnB,MAAMI,MAA3B,EAAmCD,IAAIgB,EAAvC,EAA2ChB,GAA3C,EAAgD;;AAE5C,oBAAIiB,SAASpB,MAAMG,CAAN,CAAb;AACA,oBAAIkB,SAASrB,MAAM,CAAEG,IAAI,CAAN,IAAYgB,EAAlB,CAAb;;AAEAV,wBAAQxB,IAAR,CAAamC,MAAb,EAAqBf,GAArB,CAAyBa,MAAzB;AACAT,wBAAQP,eAAR,CAAwBzB,UAAxB;AACAgC,wBAAQJ,GAAR,CAAYtB,KAAZ;;AAEA2B,wBAAQzB,IAAR,CAAaoC,MAAb,EAAqBhB,GAArB,CAAyBa,MAAzB;AACAR,wBAAQR,eAAR,CAAwBzB,UAAxB;AACAiC,wBAAQL,GAAR,CAAYtB,KAAZ;;AAEA4B,wBAAQ1B,IAAR,CAAaoC,MAAb,EAAqBhB,GAArB,CAAyBa,MAAzB;AACAP,wBAAQT,eAAR,CAAwBvB,cAAxB;AACAgC,wBAAQN,GAAR,CAAYrB,SAAZ;;AAEA4B,wBAAQ3B,IAAR,CAAamC,MAAb,EAAqBf,GAArB,CAAyBa,MAAzB;AACAN,wBAAQV,eAAR,CAAwBvB,cAAxB;AACAiC,wBAAQP,GAAR,CAAYrB,SAAZ;;AAEAf,yBAASwB,IAAT,CAAcgB,QAAQH,CAAtB,EAAyBG,QAAQF,CAAjC,EAAoCE,QAAQD,CAA5C;AACAvC,yBAASwB,IAAT,CAAciB,QAAQJ,CAAtB,EAAyBI,QAAQH,CAAjC,EAAoCG,QAAQF,CAA5C;AACAvC,yBAASwB,IAAT,CAAckB,QAAQL,CAAtB,EAAyBK,QAAQJ,CAAjC,EAAoCI,QAAQH,CAA5C;;AAEAvC,yBAASwB,IAAT,CAAcgB,QAAQH,CAAtB,EAAyBG,QAAQF,CAAjC,EAAoCE,QAAQD,CAA5C;AACAvC,yBAASwB,IAAT,CAAckB,QAAQL,CAAtB,EAAyBK,QAAQJ,CAAjC,EAAoCI,QAAQH,CAA5C;AACAvC,yBAASwB,IAAT,CAAcmB,QAAQN,CAAtB,EAAyBM,QAAQL,CAAjC,EAAoCK,QAAQJ,CAA5C;;AAEA;;AAEAK,wBAAQ5B,IAAR,CAAamC,MAAb;AACAP,wBAAQX,eAAR,CAAwBzB,UAAxB;AACAoC,wBAAQS,SAAR;;AAEAR,wBAAQ7B,IAAR,CAAaoC,MAAb;AACAP,wBAAQZ,eAAR,CAAwBzB,UAAxB;AACAqC,wBAAQQ,SAAR;;AAEAP,wBAAQ9B,IAAR,CAAaoC,MAAb;AACAN,wBAAQb,eAAR,CAAwBvB,cAAxB;AACAoC,wBAAQO,SAAR;;AAEAN,wBAAQ/B,IAAR,CAAamC,MAAb;AACAJ,wBAAQd,eAAR,CAAwBvB,cAAxB;AACAqC,wBAAQM,SAAR;;AAEApD,wBAAQuB,IAAR,CAAaoB,QAAQP,CAArB,EAAwBO,QAAQN,CAAhC,EAAmCM,QAAQL,CAA3C;AACAtC,wBAAQuB,IAAR,CAAaqB,QAAQR,CAArB,EAAwBQ,QAAQP,CAAhC,EAAmCO,QAAQN,CAA3C;AACAtC,wBAAQuB,IAAR,CAAasB,QAAQT,CAArB,EAAwBS,QAAQR,CAAhC,EAAmCQ,QAAQP,CAA3C;;AAEAtC,wBAAQuB,IAAR,CAAaoB,QAAQP,CAArB,EAAwBO,QAAQN,CAAhC,EAAmCM,QAAQL,CAA3C;AACAtC,wBAAQuB,IAAR,CAAasB,QAAQT,CAArB,EAAwBS,QAAQR,CAAhC,EAAmCQ,QAAQP,CAA3C;AACAtC,wBAAQuB,IAAR,CAAauB,QAAQV,CAArB,EAAwBU,QAAQT,CAAhC,EAAmCS,QAAQR,CAA3C;;AAGArC,uBAAOsB,IAAP,CAAYtC,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AACAgB,uBAAOsB,IAAP,CAAYtC,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AACAgB,uBAAOsB,IAAP,CAAYtC,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;;AAEAgB,uBAAOsB,IAAP,CAAYtC,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AACAgB,uBAAOsB,IAAP,CAAYtC,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AACAgB,uBAAOsB,IAAP,CAAYtC,MAAM,CAAN,CAAZ,EAAsBA,MAAM,CAAN,CAAtB,EAAgCA,MAAM,CAAN,CAAhC;AAEH;AAEJ;;AAED,YAAI+D,SAAS,IAAItD,MAAMW,OAAV,EAAb;;AAEA,aAAK,IAAIgB,IAAI,CAAb,EAAgBA,KAAKvB,SAArB,EAAgCuB,GAAhC,EAAqC;;AAEjCR,kBAAME,IAAN,CAAWlB,MAAMmB,UAAN,CAAiBK,IAAIvB,SAArB,CAAX;;AAEAM,eAAG2B,GAAH,CAAO,CAAP,EAAU,CAAV,EAAa,CAAb;;AAEAzB,oBAAQ+C,UAAR,CAAmBxC,KAAnB,EAA0BC,SAA1B,EAAqCsC,SAArC;AACA3E,kBAAM6E,YAAN,CAAmBlD,EAAnB,EAAuBE,OAAvB,EAAgC8C,SAAhC;AACAhD,eAAGkD,YAAH,CAAgBhD,OAAhB,EAAyB7B,KAAzB;;AAEA,gBAAI6C,QAAQX,KAAK4C,KAAL,CAAWjD,QAAQ8B,CAAnB,EAAsB9B,QAAQgC,CAA9B,CAAZ;;AAEA/B,uBAAWG,gBAAX,CAA4BN,EAA5B,EAAgCkB,KAAhC;;AAEA,gBAAID,IAAI,CAAJ,KAAU,CAAd,EAAiB;;AAEbQ,0BAAUZ,IAAV,EAAgBd,MAAhB;AAEH;;AAED4C,yBAAa3B,KAAb,EAAoB4B,OAAOjB,GAAP,CAAW,CAAX,EAAc,CAAC,KAAf,EAAsB,CAAtB,CAApB,EAA8C5B,MAA9C;AACA4C,yBAAarB,KAAb,EAAoBsB,OAAOjB,GAAP,CAAW,GAAX,EAAgB,CAAhB,EAAmB,CAAnB,CAApB,EAA2C7B,MAA3C;AACA6C,yBAAarB,KAAb,EAAoBsB,OAAOjB,GAAP,CAAW,CAAC,GAAZ,EAAiB,CAAjB,EAAoB,CAApB,CAApB,EAA4C7B,MAA5C;;AAEAY,sBAAUC,IAAV,CAAeF,KAAf;AACAJ,2BAAeM,IAAf,CAAoBR,UAApB;AAEH;;AAED;;AAEA,aAAKiD,YAAL,CAAkB,UAAlB,EAA8B,IAAI9D,MAAM+D,eAAV,CAA0B,IAAIC,YAAJ,CAAiB3D,QAAjB,CAA1B,EAAsD,CAAtD,CAA9B;AACA,aAAKyD,YAAL,CAAkB,QAAlB,EAA4B,IAAI9D,MAAM+D,eAAV,CAA0B,IAAIC,YAAJ,CAAiB1D,OAAjB,CAA1B,EAAqD,CAArD,CAA5B;AACA,aAAKwD,YAAL,CAAkB,OAAlB,EAA2B,IAAI9D,MAAM+D,eAAV,CAA0B,IAAIC,YAAJ,CAAiBzD,MAAjB,CAA1B,EAAoD,CAApD,CAA3B;AACH;AAhNoD;;AAmNzD,yDAAeR,qBAAf,E;;;;;;;;ACnNA;;AAEA,MAAMkE,SAAN,CAAgB;AACZ/D,gBAAYgE,MAAZ,EAAoB;AAChB,aAAKA,MAAL,GAAcA,MAAd;;AAEA,aAAKC,cAAL,GAAsB,IAAInE,MAAMoE,OAAV,EAAtB;AACA,aAAKC,KAAL,GAAa,CAAb;AACA,aAAKC,QAAL,GAAgB,KAAhB;AACA,aAAKC,UAAL,GAAkB,GAAlB;AACA,aAAKC,SAAL,GAAiB,IAAjB;AACH;;AAEDC,SAAKC,OAAL,EAAc;AACV,YAAI,iBAAiBC,MAArB,EAA6B;AACzB,iBAAKH,SAAL,GAAiB,IAAIG,OAAOC,WAAX,EAAjB;AACH;;AAED,YAAI,uFAAAjH,EAAJ,EAAwB;AACpBI,YAAA,mFAAAA,CAAa,CAAC8B,GAAD,EAAMC,SAAN,KAAoB;AAC7B,oBAAID,GAAJ,EAAS;AACLgF,4BAAQC,IAAR,CAAajF,GAAb;AACH,iBAFD,MAEO,IAAI,CAACC,SAAL,EAAgB;AACnB4E,4BAAQ,yBAAR;AACH,iBAFM,MAEA;AACH,yBAAK5E,SAAL,GAAiBA,SAAjB;AACH;AACJ,aARD;AASH;AACJ;;AAED/B,mBAAe;AACX,eAAO,KAAK+B,SAAZ;AACH;;AAEDiF,iBAAaC,KAAb,EAAoB;AAChB,aAAKlF,SAAL,GAAiBkF,KAAjB;AACH;;AAEDC,yBAAqB;AACjB,eAAO,KAAKd,cAAZ;AACH;;AAEDe,aAAS;AACL,YAAI,CAAC,KAAKpF,SAAV,EAAqB;AACjB;AACH;;AAED,aAAKA,SAAL,CAAeqF,YAAf,CAA4B,KAAKX,SAAjC;;AAEA,cAAMY,OAAO,KAAKZ,SAAL,CAAeY,IAA5B;;AAEA,YAAIA,KAAKC,WAAL,KAAqB,IAAzB,EAA+B;AAC3B,iBAAKnB,MAAL,CAAYrD,UAAZ,CAAuByE,SAAvB,CAAiCF,KAAKC,WAAtC;AACH;;AAED,YAAID,KAAKxG,QAAL,KAAkB,IAAtB,EAA4B;AACxB,iBAAKsF,MAAL,CAAYtF,QAAZ,CAAqB0G,SAArB,CAA+BF,KAAKxG,QAApC;AACH,SAFD,MAEO;AACH,iBAAKsF,MAAL,CAAYtF,QAAZ,CAAqByD,GAArB,CAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B;AACH;;AAED,YAAI,KAAKiC,QAAT,EAAmB;AACf,gBAAI,KAAKxE,SAAL,CAAeyF,eAAnB,EAAoC;AAChC,qBAAKrB,MAAL,CAAYsB,YAAZ;AACA,qBAAKrB,cAAL,CAAoBmB,SAApB,CAA8B,KAAKxF,SAAL,CAAeyF,eAAf,CAA+BE,0BAA7D;AACA,qBAAKvB,MAAL,CAAYwB,WAAZ,CAAwB,KAAKvB,cAA7B;AACH,aAJD,MAIO;AACH,qBAAKD,MAAL,CAAYtF,QAAZ,CAAqB+G,IAArB,CAA0B,KAAKzB,MAAL,CAAYtF,QAAZ,CAAqB+D,CAArB,GAAyB,KAAK4B,UAAxD;AACH;AACJ;AACJ;;AAEDqB,cAAU;AACN,aAAK9F,SAAL,GAAiB,IAAjB;AACH;AAzEW;;AA4EhB,yDAAemE,SAAf,E;;;;;;;AC9EA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4NA,SAAS4B,QAAT,CAAkBC,QAAlB,EAA4BpB,OAA5B,EAAqC;;AAEjC,QAAI5E,SAAJ,EAAeiG,UAAf;AACA,QAAIC,kBAAkB,IAAIhG,MAAMW,OAAV,EAAtB;AACA,QAAIsF,kBAAkB,IAAIjG,MAAMW,OAAV,EAAtB;AACA,QAAIuF,WAAJ,EAAiBC,WAAjB;;AAEA,QAAI3B,YAAY,IAAhB;;AAEA,QAAI,iBAAiBG,MAArB,EAA6B;;AAEzBH,oBAAY,IAAIG,OAAOC,WAAX,EAAZ;AAEH;;AAED,aAASwB,aAAT,CAAuBlI,QAAvB,EAAiC;;AAE7B6H,qBAAa7H,QAAb;;AAEA,YAAIA,SAASsE,MAAT,GAAkB,CAAtB,EAAyB;;AAErB1C,wBAAY5B,SAAS,CAAT,CAAZ;AAEH,SAJD,MAIO;;AAEH,gBAAIwG,OAAJ,EAAaA,QAAQ,mBAAR;AAEhB;AAEJ;;AAEDG,YAAQwB,GAAR,CAAYzI,UAAUC,aAAtB;;AAEA,QAAID,UAAUC,aAAd,EAA6B;;AAEzBD,kBAAUC,aAAV,GAA0BI,IAA1B,CAA+BmI,aAA/B,EAA8CjI,KAA9C,CAAoD,YAAY;;AAE5D0G,oBAAQC,IAAR,CAAa,2CAAb;AAEH,SAJD;AAMH;;AAED;;AAEA,SAAKwB,YAAL,GAAoB,KAApB;;AAEA,QAAIC,QAAQ,IAAZ;;AAEA,QAAIC,eAAeV,SAASW,OAAT,EAAnB;AACA,QAAIC,sBAAsB,KAA1B;AACA,QAAIC,qBAAqBb,SAASc,aAAT,EAAzB;;AAEA,SAAK7I,YAAL,GAAoB,YAAY;;AAE5B,eAAO+B,SAAP;AAEH,KAJD;;AAMA,SAAKiF,YAAL,GAAoB,UAAUC,KAAV,EAAiB;;AAEjClF,oBAAYkF,KAAZ;AAEH,KAJD;;AAMA,SAAKnH,aAAL,GAAqB,YAAY;;AAE7BgH,gBAAQC,IAAR,CAAa,sDAAb;AACA,eAAOiB,UAAP;AAEH,KALD;;AAOA,SAAKc,OAAL,GAAe,UAAUC,KAAV,EAAiBC,MAAjB,EAAyBC,WAAzB,EAAsC;;AAEjDR,uBAAe,EAACM,OAAOA,KAAR,EAAeC,QAAQA,MAAvB,EAAf;AACAL,8BAAsBM,WAAtB;;AAEA,YAAIT,MAAMD,YAAV,EAAwB;;AAEpB,gBAAIW,aAAanH,UAAUoH,gBAAV,CAA2B,MAA3B,CAAjB;AACApB,qBAASqB,aAAT,CAAuB,CAAvB;AACArB,qBAASe,OAAT,CAAiBI,WAAWG,WAAX,GAAyB,CAA1C,EAA6CH,WAAWI,YAAxD,EAAsE,KAAtE;AAEH,SAND,MAMO;;AAEHvB,qBAASqB,aAAT,CAAuBR,kBAAvB;AACAb,qBAASe,OAAT,CAAiBC,KAAjB,EAAwBC,MAAxB,EAAgCC,WAAhC;AAEH;AAEJ,KAlBD;;AAoBA;;AAEA,QAAIM,SAASxB,SAASyB,UAAtB;AACA,QAAIC,oBAAoB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,CAAxB;AACA,QAAIC,qBAAqB,CAAC,GAAD,EAAM,GAAN,EAAW,GAAX,EAAgB,GAAhB,CAAzB;;AAEA,aAASC,wBAAT,GAAoC;;AAEhC,YAAIC,gBAAgBpB,MAAMD,YAA1B;AACAC,cAAMD,YAAN,GAAqBxG,cAAchC,SAAd,IAA2BgC,UAAUwG,YAA1D;;AAEA,YAAIC,MAAMD,YAAV,EAAwB;;AAEpB,gBAAIW,aAAanH,UAAUoH,gBAAV,CAA2B,MAA3B,CAAjB;AACA,gBAAIU,WAAWX,WAAWG,WAA1B;AACA,gBAAIS,YAAYZ,WAAWI,YAA3B;;AAEA,gBAAI,CAACM,aAAL,EAAoB;;AAEhBhB,qCAAqBb,SAASc,aAAT,EAArB;AACAJ,+BAAeV,SAASW,OAAT,EAAf;;AAEAX,yBAASqB,aAAT,CAAuB,CAAvB;AACArB,yBAASe,OAAT,CAAiBe,WAAW,CAA5B,EAA+BC,SAA/B,EAA0C,KAA1C;AAEH;AAEJ,SAhBD,MAgBO,IAAIF,aAAJ,EAAmB;;AAEtB7B,qBAASqB,aAAT,CAAuBR,kBAAvB;AACAb,qBAASe,OAAT,CAAiBL,aAAaM,KAA9B,EAAqCN,aAAaO,MAAlD,EAA0DL,mBAA1D;AAEH;AAEJ;;AAED/B,WAAOmD,gBAAP,CAAwB,wBAAxB,EAAkDJ,wBAAlD,EAA4E,KAA5E;;AAEA,SAAKK,aAAL,GAAqB,UAAUC,OAAV,EAAmB;;AAEpC,eAAO,IAAIC,OAAJ,CAAY,UAAUC,OAAV,EAAmBC,MAAnB,EAA2B;;AAE1C,gBAAIrI,cAAchC,SAAlB,EAA6B;;AAEzBqK,uBAAO,IAAIC,KAAJ,CAAU,uBAAV,CAAP;AACA;AAEH;;AAED,gBAAI7B,MAAMD,YAAN,KAAuB0B,OAA3B,EAAoC;;AAEhCE;AACA;AAEH;;AAED,gBAAIF,OAAJ,EAAa;;AAETE,wBAAQpI,UAAUuI,cAAV,CAAyB,CAAC,EAACC,QAAQhB,MAAT,EAAD,CAAzB,CAAR;AAEH,aAJD,MAIO;;AAEHY,wBAAQpI,UAAUyI,WAAV,EAAR;AAEH;AAEJ,SA1BM,CAAP;AA4BH,KA9BD;;AAgCA,SAAKF,cAAL,GAAsB,YAAY;;AAE9B,eAAO,KAAKN,aAAL,CAAmB,IAAnB,CAAP;AAEH,KAJD;;AAMA,SAAKQ,WAAL,GAAmB,YAAY;;AAE3B,eAAO,KAAKR,aAAL,CAAmB,KAAnB,CAAP;AAEH,KAJD;;AAMA,SAAKS,qBAAL,GAA6B,UAAUC,CAAV,EAAa;;AAEtC,YAAI3I,cAAchC,SAAlB,EAA6B;;AAEzB,mBAAOgC,UAAU0I,qBAAV,CAAgCC,CAAhC,CAAP;AAEH,SAJD,MAIO;;AAEH,mBAAO9D,OAAO6D,qBAAP,CAA6BC,CAA7B,CAAP;AAEH;AAEJ,KAZD;;AAcA,SAAKC,oBAAL,GAA4B,UAAUC,CAAV,EAAa;;AAErC,YAAI7I,cAAchC,SAAlB,EAA6B;;AAEzBgC,sBAAU4I,oBAAV,CAA+BC,CAA/B;AAEH,SAJD,MAIO;;AAEHhE,mBAAO+D,oBAAP,CAA4BC,CAA5B;AAEH;AAEJ,KAZD;;AAcA,SAAKC,WAAL,GAAmB,YAAY;;AAE3B,YAAI9I,cAAchC,SAAd,IAA2ByI,MAAMD,YAArC,EAAmD;;AAE/CxG,sBAAU8I,WAAV;AAEH;AAEJ,KARD;;AAUA,SAAKC,eAAL,GAAuB,IAAvB;;AAEA;;AAEA,QAAIC,UAAU,IAAI9I,MAAM+I,iBAAV,EAAd;AACAD,YAAQE,MAAR,CAAeC,MAAf,CAAsB,CAAtB;;AAEA,QAAIC,UAAU,IAAIlJ,MAAM+I,iBAAV,EAAd;AACAG,YAAQF,MAAR,CAAeC,MAAf,CAAsB,CAAtB;;AAEA,SAAKE,MAAL,GAAc,UAAUC,KAAV,EAAiBC,MAAjB,EAAyBC,YAAzB,EAAuCC,UAAvC,EAAmD;;AAE7D,YAAIzJ,aAAayG,MAAMD,YAAvB,EAAqC;;AAEjC,gBAAIkD,aAAaJ,MAAMI,UAAvB;;AAEA,gBAAIA,UAAJ,EAAgB;;AAEZJ,sBAAMK,iBAAN;AACAL,sBAAMI,UAAN,GAAmB,KAAnB;AAEH;;AAED,gBAAIvC,aAAanH,UAAUoH,gBAAV,CAA2B,MAA3B,CAAjB;AACA,gBAAIwC,aAAa5J,UAAUoH,gBAAV,CAA2B,OAA3B,CAAjB;;AAEAlB,4BAAgBV,SAAhB,CAA0B2B,WAAW3D,MAArC;AACA2C,4BAAgBX,SAAhB,CAA0BoE,WAAWpG,MAArC;;AAEA,gBAAIqG,MAAMC,OAAN,CAAcR,KAAd,CAAJ,EAA0B;;AAEtBvE,wBAAQC,IAAR,CAAa,+EAAb;AACAsE,wBAAQA,MAAM,CAAN,CAAR;AAEH;;AAED;AACA;AACA,gBAAIS,OAAO/D,SAASW,OAAT,EAAX;AACA,gBAAIuC,SAASlJ,UAAUgK,SAAV,EAAb;AACA,gBAAIC,UAAJ;AACA,gBAAIC,WAAJ;;AAEA,gBAAIhB,OAAOxG,MAAX,EAAmB;;AAEf,oBAAIyH,QAAQjB,OAAO,CAAP,CAAZ;;AAEAe,6BAAaE,MAAMF,UAAN,KAAqB,IAArB,IAA6BE,MAAMF,UAAN,CAAiBvH,MAAjB,KAA4B,CAAzD,GAA6DyH,MAAMF,UAAnE,GAAgFvC,iBAA7F;AACAwC,8BAAcC,MAAMD,WAAN,KAAsB,IAAtB,IAA8BC,MAAMD,WAAN,CAAkBxH,MAAlB,KAA6B,CAA3D,GAA+DyH,MAAMD,WAArE,GAAmFvC,kBAAjG;AAEH,aAPD,MAOO;;AAEHsC,6BAAavC,iBAAb;AACAwC,8BAAcvC,kBAAd;AAEH;;AAEDvB,0BAAc;AACVxD,mBAAGzB,KAAKiJ,KAAL,CAAWL,KAAK/C,KAAL,GAAaiD,WAAW,CAAX,CAAxB,CADO;AAEVpH,mBAAG1B,KAAKiJ,KAAL,CAAWL,KAAK9C,MAAL,GAAcgD,WAAW,CAAX,CAAzB,CAFO;AAGVjD,uBAAO7F,KAAKiJ,KAAL,CAAWL,KAAK/C,KAAL,GAAaiD,WAAW,CAAX,CAAxB,CAHG;AAIVhD,wBAAQ9F,KAAKiJ,KAAL,CAAWL,KAAK9C,MAAL,GAAcgD,WAAW,CAAX,CAAzB;AAJE,aAAd;AAMA5D,0BAAc;AACVzD,mBAAGzB,KAAKiJ,KAAL,CAAWL,KAAK/C,KAAL,GAAakD,YAAY,CAAZ,CAAxB,CADO;AAEVrH,mBAAG1B,KAAKiJ,KAAL,CAAWL,KAAK9C,MAAL,GAAciD,YAAY,CAAZ,CAAzB,CAFO;AAGVlD,uBAAO7F,KAAKiJ,KAAL,CAAWL,KAAK/C,KAAL,GAAakD,YAAY,CAAZ,CAAxB,CAHG;AAIVjD,wBAAQ9F,KAAKiJ,KAAL,CAAWL,KAAK9C,MAAL,GAAciD,YAAY,CAAZ,CAAzB;AAJE,aAAd;;AAOA,gBAAIV,YAAJ,EAAkB;;AAEdxD,yBAASqE,eAAT,CAAyBb,YAAzB;AACAA,6BAAac,WAAb,GAA2B,IAA3B;AAEH,aALD,MAKO;;AAEHtE,yBAASqE,eAAT,CAAyB,IAAzB;AACArE,yBAASuE,cAAT,CAAwB,IAAxB;AAEH;;AAED,gBAAIvE,SAASwE,SAAT,IAAsBf,UAA1B,EAAsCzD,SAASyE,KAAT;;AAEtC,gBAAIlB,OAAOmB,MAAP,KAAkB,IAAtB,EAA4BnB,OAAOI,iBAAP;;AAE5BJ,mBAAOoB,WAAP,CAAmBC,SAAnB,CAA6B5B,QAAQlK,QAArC,EAA+CkK,QAAQjI,UAAvD,EAAmEiI,QAAQzE,KAA3E;;AAEA6E,oBAAQtK,QAAR,CAAiByC,IAAjB,CAAsByH,QAAQlK,QAA9B;AACAsK,oBAAQrI,UAAR,CAAmBQ,IAAnB,CAAwByH,QAAQjI,UAAhC;AACAqI,oBAAQ7E,KAAR,CAAchD,IAAd,CAAmByH,QAAQzE,KAA3B;;AAEAyE,oBAAQ6B,eAAR,CAAwB3E,eAAxB,EAAyC8C,QAAQzE,KAAR,CAAc3B,CAAvD;AACAwG,oBAAQyB,eAAR,CAAwB1E,eAAxB,EAAyCiD,QAAQ7E,KAAR,CAAc3B,CAAvD;;AAEA,gBAAI5C,UAAUqF,YAAd,EAA4B;;AAExBrF,0BAAU8K,SAAV,GAAsBvB,OAAOwB,IAA7B;AACA/K,0BAAUgL,QAAV,GAAqBzB,OAAO0B,GAA5B;;AAEAjL,0BAAUqF,YAAV,CAAuBX,SAAvB;;AAEAsE,wBAAQkC,gBAAR,CAAyBC,QAAzB,GAAoCzG,UAAU0G,oBAA9C;AACAhC,wBAAQ8B,gBAAR,CAAyBC,QAAzB,GAAoCzG,UAAU2G,qBAA9C;AAEH,aAVD,MAUO;;AAEHrC,wBAAQkC,gBAAR,GAA2BI,gBAAgBnE,WAAWoE,WAA3B,EAAwC,IAAxC,EAA8ChC,OAAOwB,IAArD,EAA2DxB,OAAO0B,GAAlE,CAA3B;AACA7B,wBAAQ8B,gBAAR,GAA2BI,gBAAgB1B,WAAW2B,WAA3B,EAAwC,IAAxC,EAA8ChC,OAAOwB,IAArD,EAA2DxB,OAAO0B,GAAlE,CAA3B;AAEH;;AAED;AACA,gBAAIzB,YAAJ,EAAkB;;AAEdA,6BAAagC,QAAb,CAAsBjJ,GAAtB,CAA0B6D,YAAYxD,CAAtC,EAAyCwD,YAAYvD,CAArD,EAAwDuD,YAAYY,KAApE,EAA2EZ,YAAYa,MAAvF;AACAuC,6BAAaiC,OAAb,CAAqBlJ,GAArB,CAAyB6D,YAAYxD,CAArC,EAAwCwD,YAAYvD,CAApD,EAAuDuD,YAAYY,KAAnE,EAA0EZ,YAAYa,MAAtF;AAEH,aALD,MAKO;;AAEHjB,yBAAS0F,WAAT,CAAqBtF,YAAYxD,CAAjC,EAAoCwD,YAAYvD,CAAhD,EAAmDuD,YAAYY,KAA/D,EAAsEZ,YAAYa,MAAlF;AACAjB,yBAAS2F,UAAT,CAAoBvF,YAAYxD,CAAhC,EAAmCwD,YAAYvD,CAA/C,EAAkDuD,YAAYY,KAA9D,EAAqEZ,YAAYa,MAAjF;AAEH;AACDjB,qBAASqD,MAAT,CAAgBC,KAAhB,EAAuBN,OAAvB,EAAgCQ,YAAhC,EAA8CC,UAA9C;;AAEA;AACA,gBAAID,YAAJ,EAAkB;;AAEdA,6BAAagC,QAAb,CAAsBjJ,GAAtB,CAA0B8D,YAAYzD,CAAtC,EAAyCyD,YAAYxD,CAArD,EAAwDwD,YAAYW,KAApE,EAA2EX,YAAYY,MAAvF;AACAuC,6BAAaiC,OAAb,CAAqBlJ,GAArB,CAAyB8D,YAAYzD,CAArC,EAAwCyD,YAAYxD,CAApD,EAAuDwD,YAAYW,KAAnE,EAA0EX,YAAYY,MAAtF;AAEH,aALD,MAKO;;AAEHjB,yBAAS0F,WAAT,CAAqBrF,YAAYzD,CAAjC,EAAoCyD,YAAYxD,CAAhD,EAAmDwD,YAAYW,KAA/D,EAAsEX,YAAYY,MAAlF;AACAjB,yBAAS2F,UAAT,CAAoBtF,YAAYzD,CAAhC,EAAmCyD,YAAYxD,CAA/C,EAAkDwD,YAAYW,KAA9D,EAAqEX,YAAYY,MAAjF;AAEH;AACDjB,qBAASqD,MAAT,CAAgBC,KAAhB,EAAuBF,OAAvB,EAAgCI,YAAhC,EAA8CC,UAA9C;;AAEA,gBAAID,YAAJ,EAAkB;;AAEdA,6BAAagC,QAAb,CAAsBjJ,GAAtB,CAA0B,CAA1B,EAA6B,CAA7B,EAAgCwH,KAAK/C,KAArC,EAA4C+C,KAAK9C,MAAjD;AACAuC,6BAAaiC,OAAb,CAAqBlJ,GAArB,CAAyB,CAAzB,EAA4B,CAA5B,EAA+BwH,KAAK/C,KAApC,EAA2C+C,KAAK9C,MAAhD;AACAuC,6BAAac,WAAb,GAA2B,KAA3B;AACAtE,yBAASqE,eAAT,CAAyB,IAAzB;AAEH,aAPD,MAOO;;AAEHrE,yBAAS0F,WAAT,CAAqB,CAArB,EAAwB,CAAxB,EAA2B3B,KAAK/C,KAAhC,EAAuC+C,KAAK9C,MAA5C;AACAjB,yBAASuE,cAAT,CAAwB,KAAxB;AAEH;;AAED,gBAAIb,UAAJ,EAAgB;;AAEZJ,sBAAMI,UAAN,GAAmB,IAAnB;AAEH;;AAED,gBAAIjD,MAAMsC,eAAV,EAA2B;;AAEvBtC,sBAAMqC,WAAN;AAEH;;AAED;AAEH;;AAED;;AAEA9C,iBAASqD,MAAT,CAAgBC,KAAhB,EAAuBC,MAAvB,EAA+BC,YAA/B,EAA6CC,UAA7C;AAEH,KApKD;;AAsKA,SAAK3D,OAAL,GAAe,YAAY;;AAEvBjB,eAAO+G,mBAAP,CAA2B,wBAA3B,EAAqDhE,wBAArD,EAA+E,KAA/E;AAEH,KAJD;;AAMA;;AAEA,aAASiE,mBAAT,CAA6BC,GAA7B,EAAkC;;AAE9B,YAAIC,UAAU,OAAQD,IAAIE,OAAJ,GAAcF,IAAIG,QAA1B,CAAd;AACA,YAAIC,WAAW,CAAEJ,IAAIE,OAAJ,GAAcF,IAAIG,QAApB,IAAiCF,OAAjC,GAA2C,GAA1D;AACA,YAAII,UAAU,OAAQL,IAAIM,KAAJ,GAAYN,IAAIO,OAAxB,CAAd;AACA,YAAIC,WAAW,CAAER,IAAIM,KAAJ,GAAYN,IAAIO,OAAlB,IAA8BF,OAA9B,GAAwC,GAAvD;AACA,eAAO,EAAC5H,OAAO,CAACwH,OAAD,EAAUI,OAAV,CAAR,EAA4B3I,QAAQ,CAAC0I,QAAD,EAAWI,QAAX,CAApC,EAAP;AAEH;;AAED,aAASC,mBAAT,CAA6BT,GAA7B,EAAkCU,WAAlC,EAA+CC,KAA/C,EAAsDC,IAAtD,EAA4D;;AAExDF,sBAAcA,gBAAgBxO,SAAhB,GAA4B,IAA5B,GAAmCwO,WAAjD;AACAC,gBAAQA,UAAUzO,SAAV,GAAsB,IAAtB,GAA6ByO,KAArC;AACAC,eAAOA,SAAS1O,SAAT,GAAqB,OAArB,GAA+B0O,IAAtC;;AAEA,YAAIC,kBAAkBH,cAAc,CAAC,GAAf,GAAqB,GAA3C;;AAEA;AACA,YAAII,OAAO,IAAI1M,MAAMoE,OAAV,EAAX;AACA,YAAIuI,IAAID,KAAKzB,QAAb;;AAEA;AACA,YAAI2B,iBAAiBjB,oBAAoBC,GAApB,CAArB;;AAEA;AACAe,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAeC,eAAevI,KAAf,CAAqB,CAArB,CAAf;AACAsI,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAeC,eAAetJ,MAAf,CAAsB,CAAtB,IAA2BmJ,eAA1C;AACAE,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;;AAEA;AACA;AACA;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAeC,eAAevI,KAAf,CAAqB,CAArB,CAAf;AACAsI,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,CAACC,eAAetJ,MAAf,CAAsB,CAAtB,CAAD,GAA4BmJ,eAA3C;AACAE,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;;AAEA;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAeH,QAASD,QAAQC,IAAjB,IAA0B,CAACC,eAA1C;AACAE,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAiBH,OAAOD,KAAT,IAAqBA,QAAQC,IAA7B,CAAf;;AAEA;AACAG,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;AACAA,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAeF,eAAf;AACAE,UAAE,IAAI,CAAJ,GAAQ,CAAV,IAAe,GAAf;;AAEAD,aAAKG,SAAL;AACA,eAAOH,IAAP;AAEH;;AAED,aAAStB,eAAT,CAAyBQ,GAAzB,EAA8BU,WAA9B,EAA2CC,KAA3C,EAAkDC,IAAlD,EAAwD;;AAEpD,YAAIM,UAAU7L,KAAKC,EAAL,GAAU,KAAxB;;AAEA,YAAI6L,UAAU;AACVb,mBAAOjL,KAAK+L,GAAL,CAASpB,IAAIqB,SAAJ,GAAgBH,OAAzB,CADG;AAEVX,qBAASlL,KAAK+L,GAAL,CAASpB,IAAIsB,WAAJ,GAAkBJ,OAA3B,CAFC;AAGVhB,qBAAS7K,KAAK+L,GAAL,CAASpB,IAAIuB,WAAJ,GAAkBL,OAA3B,CAHC;AAIVf,sBAAU9K,KAAK+L,GAAL,CAASpB,IAAIwB,YAAJ,GAAmBN,OAA5B;AAJA,SAAd;;AAOA,eAAOT,oBAAoBU,OAApB,EAA6BT,WAA7B,EAA0CC,KAA1C,EAAiDC,IAAjD,CAAP;AAEH;AAEJ;;AAED,yDAAe3G,QAAf,E;;;;;;;;;;;;ACjrBA;AACA;AACA;AACA;;AAEA,IAAI,CAAC,0FAAAlI,EAAL,EAAyB;AACrBU,IAAA,+FAAAA,CAAuBgP,OAAD,IAAa;AAC/B5O,iBAAS6O,IAAT,CAAc1N,WAAd,CAA0ByN,OAA1B;AACH,KAFD;AAGH;;AAED,MAAMvH,WAAW,IAAI9F,MAAMuN,aAAV,CAAwB,EAAEC,WAAW,IAAb,EAAxB,CAAjB;AACA1H,SAAS2H,aAAT,CAAuB,QAAvB;AACA3H,SAASqB,aAAT,CAAuBxC,OAAO+I,gBAA9B;AACA5H,SAASe,OAAT,CAAiBlC,OAAOgJ,UAAxB,EAAoChJ,OAAOiJ,WAA3C;;AAEAnP,SAAS6O,IAAT,CAAc1N,WAAd,CAA0BkG,SAASyB,UAAnC;;AAEA,MAAM6B,QAAQ,IAAIpJ,MAAM6N,KAAV,EAAd;;AAEA;AACA,MAAMC,QAAQ,IAAI9N,MAAM+N,eAAV,CAA0B,QAA1B,EAAoC,QAApC,CAAd;AACAD,MAAMlP,QAAN,CAAeyD,GAAf,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB;AACA+G,MAAM3G,GAAN,CAAUqL,KAAV;;AAEA;AACA,MAAME,QAAQ,IAAIhO,MAAMiO,QAAV,EAAd;AACA7E,MAAM3G,GAAN,CAAUuL,KAAV;AACA,MAAM3E,SAAS,IAAIrJ,MAAM+I,iBAAV,CAA4B,EAA5B,EAAgCpE,OAAOgJ,UAAP,GAAoBhJ,OAAOiJ,WAA3D,EAAwE,GAAxE,EAA6E,GAA7E,CAAf;AACAI,MAAMvL,GAAN,CAAU4G,MAAV;;AAEA;AACA,MAAM7H,MAAMP,KAAKC,EAAL,GAAU,CAAtB;AACA,MAAMf,QAAQ,CAAC,MAAM;AACjB,UAAM+N,KAAK,IAAIlO,MAAMW,OAAV,EAAX;AACA,UAAMwN,KAAK,IAAInO,MAAMW,OAAV,EAAX;;AAEA,WAAO;AACHW,mBAAW8M,CAAX,EAAc;AACV,kBAAMC,IAAID,IAAI5M,GAAd;;AAEA,kBAAMkB,IAAIzB,KAAKa,GAAL,CAASuM,IAAI,CAAb,IAAkBpN,KAAKc,GAAL,CAASsM,IAAI,CAAb,CAAlB,GAAoC,EAA9C;AACA,kBAAM1L,IAAI1B,KAAKa,GAAL,CAASuM,IAAI,EAAb,IAAmB,CAAnB,GAAuBpN,KAAKc,GAAL,CAASsM,IAAI,EAAb,IAAmB,CAA1C,GAA8C,CAAxD;AACA,kBAAMzL,IAAI3B,KAAKa,GAAL,CAASuM,CAAT,IAAcpN,KAAKa,GAAL,CAASuM,IAAI,CAAb,CAAd,GAAgC,EAA1C;;AAEA,mBAAOH,GAAG7L,GAAH,CAAOK,CAAP,EAAUC,CAAV,EAAaC,CAAb,EAAgB0L,cAAhB,CAA+B,CAA/B,CAAP;AACH,SATE;;AAWHC,qBAAaH,CAAb,EAAgB;AACZ,kBAAMI,QAAQ,OAAd;;AAEA,kBAAMC,KAAKxN,KAAKyN,GAAL,CAAS,CAAT,EAAYN,IAAII,KAAhB,CAAX;AACA,kBAAMG,KAAK1N,KAAK2N,GAAL,CAAS,CAAT,EAAYR,IAAII,KAAhB,CAAX;;AAEA,mBAAOL,GACF9M,IADE,CACG,KAAKC,UAAL,CAAgBqN,EAAhB,CADH,EAEFE,GAFE,CAEE,KAAKvN,UAAL,CAAgBmN,EAAhB,CAFF,EAGF/K,SAHE,EAAP;AAIH;AArBE,KAAP;AAuBH,CA3Ba,GAAd;;AA6BA,MAAMoL,wBAAwB,IAAI,2EAAJ,CAA0B3O,KAA1B,EAAiC,IAAjC,CAA9B;AACA,MAAM4O,WAAW,IAAI/O,MAAMgP,iBAAV,CAA4B;AACzCC,kBAAcjP,MAAMkP;AADqB,CAA5B,CAAjB;AAGA,MAAMC,OAAO,IAAInP,MAAMoP,IAAV,CAAeN,qBAAf,EAAsCC,QAAtC,CAAb;AACA3F,MAAM3G,GAAN,CAAU0M,IAAV;;AAEA;AACA,MAAME,UAAU,IAAI,4DAAJ,CAAchG,MAAd,CAAhB;AACA,MAAMiG,SAAS,IAAI,2DAAJ,CAAaxJ,QAAb,CAAf;;AAEAuJ,QAAQ5K,IAAR;;AAEAE,OAAOmD,gBAAP,CAAwB,QAAxB,EAAkC,MAAM;AACpCuB,WAAOkG,MAAP,GAAgB5K,OAAOgJ,UAAP,GAAoBhJ,OAAOiJ,WAA3C;AACAvE,WAAOmG,sBAAP;AACAF,WAAOzI,OAAP,CAAelC,OAAOgJ,UAAtB,EAAkChJ,OAAOiJ,WAAzC;AACH,CAJD;;AAOA;AACA,MAAMhP,WAAW,IAAIoB,MAAMW,OAAV,EAAjB;AACA,MAAM8O,UAAU,IAAIzP,MAAMW,OAAV,EAAhB;AACA,MAAM+O,SAAS,IAAI1P,MAAMW,OAAV,EAAf;;AAEA,IAAIgP,WAAW,CAAf;AACA,IAAIC,WAAW,CAAf;AACA,IAAIC,WAAWlL,OAAOmL,WAAP,CAAmBC,GAAnB,EAAf;;AAEA,SAASC,OAAT,CAAiBC,IAAjB,EAAuB;AACnBX,WAAO9G,qBAAP,CAA6BwH,OAA7B;;AAEA,UAAMxB,QAAQyB,OAAOJ,QAArB;;AAEAD,gBAAYD,QAAZ;AACAC,eAAWA,WAAW,CAAtB;AACAhR,aAASyC,IAAT,CAAclB,MAAMmB,UAAN,CAAiBsO,QAAjB,CAAd;AACAhR,aAAS+D,CAAT,IAAc,GAAd;AACAqL,UAAMpP,QAAN,CAAeyC,IAAf,CAAoBzC,QAApB;AACA6Q,YAAQpO,IAAR,CAAalB,MAAMoO,YAAN,CAAmBqB,QAAnB,CAAb;AACAD,gBAAYF,QAAQ9M,CAAR,GAAY,SAAZ,GAAwB6L,KAApC;AACAmB,eAAW1O,KAAKyN,GAAL,CAAS,OAAT,EAAkBzN,KAAK2N,GAAL,CAAS,MAAT,EAAiBe,QAAjB,CAAlB,CAAX;AACA3B,UAAM0B,MAAN,CAAaA,OAAOrO,IAAP,CAAYzC,QAAZ,EAAsBiQ,GAAtB,CAA0BY,OAA1B,CAAb;;AAEAJ,YAAQnK,MAAR;AACAoK,WAAOnG,MAAP,CAAcC,KAAd,EAAqBC,MAArB;;AAEAwG,eAAWI,IAAX;AACH;;AAEDX,OAAO9G,qBAAP,CAA6BwH,OAA7B,E","file":"main.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap d0982c9a7eb45b007d23","export function isWebVRAvailable() {\n    return navigator.getVRDisplays !== undefined;\n}\n\nexport function getVRDisplay(callback) {\n    if (!isWebVRAvailable()) {\n        callback('browser not support vr display', null);\n        return;\n    }\n\n    navigator\n        .getVRDisplays()\n        .then((displays) => {\n            callback(null, displays[0]);\n        })\n        .catch((error) => {\n            callback(error, null);\n        });\n}\n\nexport function getHelpMessageElement(callback) {\n    const makeMessageElement = (message) => {\n        const container = document.createElement('div');\n        container.style.position = 'absolute';\n        container.style.left = '0';\n        container.style.top = '0';\n        container.style.right = '0';\n        container.style.zIndex = '999';\n        container.align = 'center';\n\n        const error = document.createElement('div');\n        error.style.fontFamily = 'sans-serif';\n        error.style.fontSize = '16px';\n        error.style.fontStyle = 'normal';\n        error.style.lineHeight = '26px';\n        error.style.backgroundColor = '#fff';\n        error.style.color = '#000';\n        error.style.padding = '10px 20px';\n        error.style.margin = '50px';\n        error.style.display = 'inline-block';\n        error.innerHTML = message;\n        container.appendChild(error);\n\n        callback(container);\n    };\n\n    getVRDisplay((err, vrDisplay) => {\n        if (err) {\n            makeMessageElement('Your browser does not support WebVR. See <a href=\"http://webvr.info\">webvr.info</a> for assistance.');\n        } else if (!vrDisplay) {\n            makeMessageElement('WebVR supported, but no VRDisplays found.');\n        } else {\n            callback(null);\n        }\n    });\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/vr/utils.js","class RollerCoasterGeometry extends THREE.BufferGeometry {\n    constructor(curve, divisions) {\n        super();\n\n        var vertices = [];\n        var normals = [];\n        var colors = [];\n\n        var color1 = [1, 1, 1];\n        var color2 = [1, 1, 0];\n\n        var up = new THREE.Vector3(0, 1, 0);\n        var forward = new THREE.Vector3();\n        var right = new THREE.Vector3();\n\n        var quaternion = new THREE.Quaternion();\n        var prevQuaternion = new THREE.Quaternion();\n        prevQuaternion.setFromAxisAngle(up, Math.PI / 2);\n\n        var point = new THREE.Vector3();\n        var prevPoint = new THREE.Vector3();\n        prevPoint.copy(curve.getPointAt(0));\n\n        // shapes\n\n        var step = [\n            new THREE.Vector3(-0.225, 0, 0),\n            new THREE.Vector3(0, -0.050, 0),\n            new THREE.Vector3(0, -0.175, 0),\n\n            new THREE.Vector3(0, -0.050, 0),\n            new THREE.Vector3(0.225, 0, 0),\n            new THREE.Vector3(0, -0.175, 0)\n        ];\n\n        var PI2 = Math.PI * 2;\n\n        var sides = 5;\n        var tube1 = [];\n\n        for (var i = 0; i < sides; i++) {\n\n            var angle = ( i / sides ) * PI2;\n            tube1.push(new THREE.Vector3(Math.sin(angle) * 0.06, Math.cos(angle) * 0.06, 0));\n\n        }\n\n        var sides = 6;\n        var tube2 = [];\n\n        for (var i = 0; i < sides; i++) {\n\n            var angle = ( i / sides ) * PI2;\n            tube2.push(new THREE.Vector3(Math.sin(angle) * 0.025, Math.cos(angle) * 0.025, 0));\n\n        }\n\n        var vector = new THREE.Vector3();\n        var normal = new THREE.Vector3();\n\n        function drawShape(shape, color) {\n\n            normal.set(0, 0, -1).applyQuaternion(quaternion);\n\n            for (var j = 0; j < shape.length; j++) {\n\n                vector.copy(shape[j]);\n                vector.applyQuaternion(quaternion);\n                vector.add(point);\n\n                vertices.push(vector.x, vector.y, vector.z);\n                normals.push(normal.x, normal.y, normal.z);\n                colors.push(color[0], color[1], color[2]);\n\n            }\n\n            normal.set(0, 0, 1).applyQuaternion(quaternion);\n\n            for (var j = 0; j < shape.length; j++) {\n\n                vector.copy(shape[j]);\n                vector.applyQuaternion(quaternion);\n                vector.add(point);\n\n                vertices.push(vector.x, vector.y, vector.z);\n                normals.push(normal.x, normal.y, normal.z);\n                colors.push(color[0], color[1], color[2]);\n\n            }\n\n        };\n\n        var vector1 = new THREE.Vector3();\n        var vector2 = new THREE.Vector3();\n        var vector3 = new THREE.Vector3();\n        var vector4 = new THREE.Vector3();\n\n        var normal1 = new THREE.Vector3();\n        var normal2 = new THREE.Vector3();\n        var normal3 = new THREE.Vector3();\n        var normal4 = new THREE.Vector3();\n\n        function extrudeShape(shape, offset, color) {\n\n            for (var j = 0, jl = shape.length; j < jl; j++) {\n\n                var point1 = shape[j];\n                var point2 = shape[( j + 1 ) % jl];\n\n                vector1.copy(point1).add(offset);\n                vector1.applyQuaternion(quaternion);\n                vector1.add(point);\n\n                vector2.copy(point2).add(offset);\n                vector2.applyQuaternion(quaternion);\n                vector2.add(point);\n\n                vector3.copy(point2).add(offset);\n                vector3.applyQuaternion(prevQuaternion);\n                vector3.add(prevPoint);\n\n                vector4.copy(point1).add(offset);\n                vector4.applyQuaternion(prevQuaternion);\n                vector4.add(prevPoint);\n\n                vertices.push(vector1.x, vector1.y, vector1.z);\n                vertices.push(vector2.x, vector2.y, vector2.z);\n                vertices.push(vector3.x, vector3.y, vector3.z);\n\n                vertices.push(vector1.x, vector1.y, vector1.z);\n                vertices.push(vector3.x, vector3.y, vector3.z);\n                vertices.push(vector4.x, vector4.y, vector4.z);\n\n                //\n\n                normal1.copy(point1);\n                normal1.applyQuaternion(quaternion);\n                normal1.normalize();\n\n                normal2.copy(point2);\n                normal2.applyQuaternion(quaternion);\n                normal2.normalize();\n\n                normal3.copy(point2);\n                normal3.applyQuaternion(prevQuaternion);\n                normal3.normalize();\n\n                normal4.copy(point1);\n                normal4.applyQuaternion(prevQuaternion);\n                normal4.normalize();\n\n                normals.push(normal1.x, normal1.y, normal1.z);\n                normals.push(normal2.x, normal2.y, normal2.z);\n                normals.push(normal3.x, normal3.y, normal3.z);\n\n                normals.push(normal1.x, normal1.y, normal1.z);\n                normals.push(normal3.x, normal3.y, normal3.z);\n                normals.push(normal4.x, normal4.y, normal4.z);\n\n\n                colors.push(color[0], color[1], color[2]);\n                colors.push(color[0], color[1], color[2]);\n                colors.push(color[0], color[1], color[2]);\n\n                colors.push(color[0], color[1], color[2]);\n                colors.push(color[0], color[1], color[2]);\n                colors.push(color[0], color[1], color[2]);\n\n            }\n\n        };\n\n        var offset = new THREE.Vector3();\n\n        for (var i = 1; i <= divisions; i++) {\n\n            point.copy(curve.getPointAt(i / divisions));\n\n            up.set(0, 1, 0);\n\n            forward.subVectors(point, prevPoint).normalize();\n            right.crossVectors(up, forward).normalize();\n            up.crossVectors(forward, right);\n\n            var angle = Math.atan2(forward.x, forward.z);\n\n            quaternion.setFromAxisAngle(up, angle);\n\n            if (i % 2 === 0) {\n\n                drawShape(step, color2);\n\n            }\n\n            extrudeShape(tube1, offset.set(0, -0.125, 0), color2);\n            extrudeShape(tube2, offset.set(0.2, 0, 0), color1);\n            extrudeShape(tube2, offset.set(-0.2, 0, 0), color1);\n\n            prevPoint.copy(point);\n            prevQuaternion.copy(quaternion);\n\n        }\n\n        // console.log( vertices.length );\n\n        this.addAttribute('position', new THREE.BufferAttribute(new Float32Array(vertices), 3));\n        this.addAttribute('normal', new THREE.BufferAttribute(new Float32Array(normals), 3));\n        this.addAttribute('color', new THREE.BufferAttribute(new Float32Array(colors), 3));\n    }\n}\n\nexport default RollerCoasterGeometry;\n\n\n\n// WEBPACK FOOTER //\n// ./src/geometries/roller-coaster.js","import { isWebVRAvailable, getVRDisplay } from './utils';\n\nclass VRControl {\n    constructor(object) {\n        this.object = object;\n\n        this.standingMatrix = new THREE.Matrix4();\n        this.scale = 1;\n        this.standing = false;\n        this.userHeight = 1.6;\n        this.frameData = null;\n    }\n\n    init(onError) {\n        if ('VRFrameData' in window) {\n            this.frameData = new window.VRFrameData();\n        }\n\n        if (isWebVRAvailable()) {\n            getVRDisplay((err, vrDisplay) => {\n                if (err) {\n                    console.warn(err);\n                } else if (!vrDisplay) {\n                    onError('VR input not available.');\n                } else {\n                    this.vrDisplay = vrDisplay;\n                }\n            });\n        }\n    }\n\n    getVRDisplay() {\n        return this.vrDisplay;\n    }\n\n    setVRDisplay(value) {\n        this.vrDisplay = value;\n    }\n\n    getStandingMaxtrix() {\n        return this.standingMatrix;\n    }\n\n    update() {\n        if (!this.vrDisplay) {\n            return;\n        }\n\n        this.vrDisplay.getFrameData(this.frameData);\n\n        const pose = this.frameData.pose;\n\n        if (pose.orientation !== null) {\n            this.object.quaternion.fromArray(pose.orientation);\n        }\n\n        if (pose.position !== null) {\n            this.object.position.fromArray(pose.position);\n        } else {\n            this.object.position.set(0, 0, 0);\n        }\n\n        if (this.standing) {\n            if (this.vrDisplay.stageParameters) {\n                this.object.updateMatrix();\n                this.standingMatrix.fromArray(this.vrDisplay.stageParameters.sittingToStandingTransform);\n                this.object.applyMatrix(this.standingMatrix);\n            } else {\n                this.object.position.setY(this.object.position.y + this.userHeight);\n            }\n        }\n    }\n\n    dispose() {\n        this.vrDisplay = null;\n    }\n}\n\nexport default VRControl;\n\n\n\n// WEBPACK FOOTER //\n// ./src/vr/control.js","/*\nclass VREffect {\n    constructor(renderer) {\n        this.renderer = renderer;\n\n        this.vrDisplay = null;\n        this.frameData = null;\n\n        this.eyeTranslationL = new THREE.Vector3();\n        this.eyeTranslationR = new THREE.Vector3();\n\n        this.isPresenting = false;\n\n        this.rendererSize = renderer.getSize();\n        this.rendererUpdateStyle = false;\n        this.rendererPixelRatio = renderer.getPixelRatio();\n\n        this.canvas = renderer.domElement;\n        this.defaultLeftBounds = [0.0, 0.0, 0.5, 1.0];\n        this.defaultRightBounds = [0.5, 0.0, 0.5, 1.0];\n\n        this.autoSubmitFrame = true;\n    }\n\n    _onVRDisplayPresentChange() {\n        const wasPresenting = this.isPresenting;\n        this.isPresenting = !!this.vrDisplay && this.vrDisplay.isPresenting;\n\n        if (this.isPresenting) {\n            const eyeParamsL = this.vrDisplay.getEyeParameters('left');\n            const eyeWidth = eyeParamsL.renderWidth;\n            const eyeHeight = eyeParamsL.renderHeight;\n\n            if (!wasPresenting) {\n                this.rendererPixelRatio = this.renderer.getPixelRatio();\n                this.rendererSize = this.renderer.getSize();\n\n                this.renderer.setPixelRatio(1);\n                this.renderer.setSize(eyeWidth * 2, eyeHeight, false);\n            }\n        } else if (wasPresenting) {\n            this.renderer.setPixelRatio(this.rendererPixelRatio);\n            this.renderer.setSize(this.rendererSize.width, this.rendererSize.height, this.rendererUpdateStyle);\n        }\n    }\n\n    init(onError) {\n        if ('VRFrameData' in window) {\n            this.frameData = new window.VRFrameData();\n        }\n\n        if (isWebVRAvailable()) {\n            getVRDisplay((err, vrDisplay) => {\n                if (err || !vrDisplay) {\n                    onError('HMD not available');\n                } else {\n                    this.vrDisplay = vrDisplay;\n                }\n            });\n        }\n\n        window.addEventListener('vrdisplaypresentchange', () => {\n            this._onVRDisplayPresentChange();\n        });\n    }\n\n    getVRDisplay() {\n        return this.vrDisplay;\n    }\n\n    setVRDisplay(value) {\n        this.vrDisplay = value;\n    }\n\n    setSize(width, height, updateStyle) {\n        this.rendererSize = { width, height };\n        this.rendererUpdateStyle = updateStyle;\n\n        if (this.isPresenting) {\n            const eyeParamsL = this.vrDisplay.getEyeParameters('left');\n\n            this.renderer.setPixelRatio(1);\n            this.renderer.setSize(eyeParamsL.renderWidth * 2, eyeParamsL.renderHeight, false);\n\n        } else {\n            this.renderer.setPixelRatio(this.rendererPixelRatio);\n            this.renderer.setSize(width, height, updateStyle);\n        }\n    }\n\n    setFullScreen(boolean) {\n        return new Promise((resolve) => {\n            if (this.isPresenting === boolean) {\n                resolve();\n                return;\n            }\n\n            if (boolean) {\n                resolve(this.vrDisplay.requestPresent({ source: this.canvas }));\n            } else {\n                resolve(this.vrDisplay.exitPresent());\n            }\n        });\n    }\n\n    requestPresent() {\n        return this.setFullScreen(true);\n    }\n\n    exitPresent() {\n        return this.setFullScreen(false);\n    }\n\n    requestAnimationFrame(f) {\n        if (this.vrDisplay) {\n            return this.vrDisplay.requestAnimationFrame(f);\n        }\n\n        return window.requestAnimationFrame(f);\n    }\n\n    cancelAnimationFrame(h) {\n        if (this.vrDisplay) {\n            this.vrDisplay.cancelAnimationFrame(h);\n        } else {\n            window.cancelAnimationFrame(h);\n        }\n    }\n\n    submitFrame() {\n        if (this.vrDisplay && this.isPresenting) {\n            this.vrDisplay.submitFrame();\n        }\n    }\n\n    render(scene, camera, renderTarget, forceClear) {\n        const cameraL = new THREE.PerspectiveCamera();\n        const cameraR = new THREE.PerspectiveCamera();\n\n        cameraL.layers.enable(1);\n        cameraR.layers.enable(2);\n\n        if (this.vrDisplay && this.isPresenting) {\n            const autoUpdate = scene.autoUpdate;\n\n            if (autoUpdate) {\n                scene.updateMatrixWorld();\n                scene.autoUpdate = false;\n            }\n\n            const eyeParamsL = this.vrDisplay.getEyeParameters('left');\n            const eyeParamsR = this.vrDisplay.getEyeParameters('right');\n\n            this.eyeTranslationL.fromArray(eyeParamsL.offset);\n            this.eyeTranslationR.fromArray(eyeParamsR.offset);\n\n            const size = this.renderer.getSize();\n            const layers = this.vrDisplay.getLayers();\n\n            let leftBounds;\n            let rightBounds;\n\n            if (layers.length) {\n                const layer = layers[0];\n\n                leftBounds = layer.leftBounds !== null && layer.leftBounds.length === 4 ? layer.leftBounds : this.defaultLeftBounds;\n                rightBounds = layer.rightBounds !== null && layer.rightBounds.length === 4 ? layer.rightBounds : this.defaultRightBounds;\n\n            } else {\n                leftBounds = defaultLeftBounds;\n                rightBounds = defaultRightBounds;\n            }\n\n            const renderReactL = {\n                x: Math.round(size.width * leftBounds[0]),\n                y: Math.round(size.height * leftBounds[1]),\n                width: Math.round(size.width * leftBounds[2]),\n                height: Math.round(size.height * leftBounds[3])\n            };\n\n            const renderRectR = {\n                x: Math.round(size.width * rightBounds[0]),\n                y: Math.round(size.height * rightBounds[1]),\n                width: Math.round(size.width * rightBounds[2]),\n                height: Math.round(size.height * rightBounds[3])\n            };\n\n            if (renderTarget) {\n                this.renderer.setRenderTarget(renderTarget);\n                renderTarget.scissorTest = true;\n            } else {\n                this.renderer.setRenderTarget(null);\n                this.renderer.setScissorTest(true);\n            }\n\n            if (this.renderer.autoClear || forceClear) {\n                this.renderer.clear();\n            }\n\n            if (camera.parent === null) {\n                camera.updateMatrixWorld();\n            }\n\n            camera.matrixWorld.decompose(cameraL.position, cameraL.quaternion, cameraL.scale);\n\n            cameraR.position.copy(cameraL.position);\n            cameraR.quaternion.copy(cameraL.quaternion);\n            cameraR.scale.copy(cameraL.scale);\n\n            cameraL.translateOnAxis(this.eyeTranslationL, cameraL.scale.x);\n            cameraR.translateOnAxis(this.eyeTranslationR, cameraR.scale.x);\n\n            if (this.vrDisplay.getFrameData) {\n\n            }\n        }\n    }\n}\n*/\n\nfunction VREffect(renderer, onError) {\n\n    var vrDisplay, vrDisplays;\n    var eyeTranslationL = new THREE.Vector3();\n    var eyeTranslationR = new THREE.Vector3();\n    var renderRectL, renderRectR;\n\n    var frameData = null;\n\n    if ('VRFrameData' in window) {\n\n        frameData = new window.VRFrameData();\n\n    }\n\n    function gotVRDisplays(displays) {\n\n        vrDisplays = displays;\n\n        if (displays.length > 0) {\n\n            vrDisplay = displays[0];\n\n        } else {\n\n            if (onError) onError('HMD not available');\n\n        }\n\n    }\n\n    console.log(navigator.getVRDisplays);\n\n    if (navigator.getVRDisplays) {\n\n        navigator.getVRDisplays().then(gotVRDisplays).catch(function () {\n\n            console.warn('THREE.VREffect: Unable to get VR Displays');\n\n        });\n\n    }\n\n    //\n\n    this.isPresenting = false;\n\n    var scope = this;\n\n    var rendererSize = renderer.getSize();\n    var rendererUpdateStyle = false;\n    var rendererPixelRatio = renderer.getPixelRatio();\n\n    this.getVRDisplay = function () {\n\n        return vrDisplay;\n\n    };\n\n    this.setVRDisplay = function (value) {\n\n        vrDisplay = value;\n\n    };\n\n    this.getVRDisplays = function () {\n\n        console.warn('THREE.VREffect: getVRDisplays() is being deprecated.');\n        return vrDisplays;\n\n    };\n\n    this.setSize = function (width, height, updateStyle) {\n\n        rendererSize = {width: width, height: height};\n        rendererUpdateStyle = updateStyle;\n\n        if (scope.isPresenting) {\n\n            var eyeParamsL = vrDisplay.getEyeParameters('left');\n            renderer.setPixelRatio(1);\n            renderer.setSize(eyeParamsL.renderWidth * 2, eyeParamsL.renderHeight, false);\n\n        } else {\n\n            renderer.setPixelRatio(rendererPixelRatio);\n            renderer.setSize(width, height, updateStyle);\n\n        }\n\n    };\n\n    // VR presentation\n\n    var canvas = renderer.domElement;\n    var defaultLeftBounds = [0.0, 0.0, 0.5, 1.0];\n    var defaultRightBounds = [0.5, 0.0, 0.5, 1.0];\n\n    function onVRDisplayPresentChange() {\n\n        var wasPresenting = scope.isPresenting;\n        scope.isPresenting = vrDisplay !== undefined && vrDisplay.isPresenting;\n\n        if (scope.isPresenting) {\n\n            var eyeParamsL = vrDisplay.getEyeParameters('left');\n            var eyeWidth = eyeParamsL.renderWidth;\n            var eyeHeight = eyeParamsL.renderHeight;\n\n            if (!wasPresenting) {\n\n                rendererPixelRatio = renderer.getPixelRatio();\n                rendererSize = renderer.getSize();\n\n                renderer.setPixelRatio(1);\n                renderer.setSize(eyeWidth * 2, eyeHeight, false);\n\n            }\n\n        } else if (wasPresenting) {\n\n            renderer.setPixelRatio(rendererPixelRatio);\n            renderer.setSize(rendererSize.width, rendererSize.height, rendererUpdateStyle);\n\n        }\n\n    }\n\n    window.addEventListener('vrdisplaypresentchange', onVRDisplayPresentChange, false);\n\n    this.setFullScreen = function (boolean) {\n\n        return new Promise(function (resolve, reject) {\n\n            if (vrDisplay === undefined) {\n\n                reject(new Error('No VR hardware found.'));\n                return;\n\n            }\n\n            if (scope.isPresenting === boolean) {\n\n                resolve();\n                return;\n\n            }\n\n            if (boolean) {\n\n                resolve(vrDisplay.requestPresent([{source: canvas}]));\n\n            } else {\n\n                resolve(vrDisplay.exitPresent());\n\n            }\n\n        });\n\n    };\n\n    this.requestPresent = function () {\n\n        return this.setFullScreen(true);\n\n    };\n\n    this.exitPresent = function () {\n\n        return this.setFullScreen(false);\n\n    };\n\n    this.requestAnimationFrame = function (f) {\n\n        if (vrDisplay !== undefined) {\n\n            return vrDisplay.requestAnimationFrame(f);\n\n        } else {\n\n            return window.requestAnimationFrame(f);\n\n        }\n\n    };\n\n    this.cancelAnimationFrame = function (h) {\n\n        if (vrDisplay !== undefined) {\n\n            vrDisplay.cancelAnimationFrame(h);\n\n        } else {\n\n            window.cancelAnimationFrame(h);\n\n        }\n\n    };\n\n    this.submitFrame = function () {\n\n        if (vrDisplay !== undefined && scope.isPresenting) {\n\n            vrDisplay.submitFrame();\n\n        }\n\n    };\n\n    this.autoSubmitFrame = true;\n\n    // render\n\n    var cameraL = new THREE.PerspectiveCamera();\n    cameraL.layers.enable(1);\n\n    var cameraR = new THREE.PerspectiveCamera();\n    cameraR.layers.enable(2);\n\n    this.render = function (scene, camera, renderTarget, forceClear) {\n\n        if (vrDisplay && scope.isPresenting) {\n\n            var autoUpdate = scene.autoUpdate;\n\n            if (autoUpdate) {\n\n                scene.updateMatrixWorld();\n                scene.autoUpdate = false;\n\n            }\n\n            var eyeParamsL = vrDisplay.getEyeParameters('left');\n            var eyeParamsR = vrDisplay.getEyeParameters('right');\n\n            eyeTranslationL.fromArray(eyeParamsL.offset);\n            eyeTranslationR.fromArray(eyeParamsR.offset);\n\n            if (Array.isArray(scene)) {\n\n                console.warn('THREE.VREffect.render() no longer supports arrays. Use object.layers instead.');\n                scene = scene[0];\n\n            }\n\n            // When rendering we don't care what the recommended size is, only what the actual size\n            // of the backbuffer is.\n            var size = renderer.getSize();\n            var layers = vrDisplay.getLayers();\n            var leftBounds;\n            var rightBounds;\n\n            if (layers.length) {\n\n                var layer = layers[0];\n\n                leftBounds = layer.leftBounds !== null && layer.leftBounds.length === 4 ? layer.leftBounds : defaultLeftBounds;\n                rightBounds = layer.rightBounds !== null && layer.rightBounds.length === 4 ? layer.rightBounds : defaultRightBounds;\n\n            } else {\n\n                leftBounds = defaultLeftBounds;\n                rightBounds = defaultRightBounds;\n\n            }\n\n            renderRectL = {\n                x: Math.round(size.width * leftBounds[0]),\n                y: Math.round(size.height * leftBounds[1]),\n                width: Math.round(size.width * leftBounds[2]),\n                height: Math.round(size.height * leftBounds[3])\n            };\n            renderRectR = {\n                x: Math.round(size.width * rightBounds[0]),\n                y: Math.round(size.height * rightBounds[1]),\n                width: Math.round(size.width * rightBounds[2]),\n                height: Math.round(size.height * rightBounds[3])\n            };\n\n            if (renderTarget) {\n\n                renderer.setRenderTarget(renderTarget);\n                renderTarget.scissorTest = true;\n\n            } else {\n\n                renderer.setRenderTarget(null);\n                renderer.setScissorTest(true);\n\n            }\n\n            if (renderer.autoClear || forceClear) renderer.clear();\n\n            if (camera.parent === null) camera.updateMatrixWorld();\n\n            camera.matrixWorld.decompose(cameraL.position, cameraL.quaternion, cameraL.scale);\n\n            cameraR.position.copy(cameraL.position);\n            cameraR.quaternion.copy(cameraL.quaternion);\n            cameraR.scale.copy(cameraL.scale);\n\n            cameraL.translateOnAxis(eyeTranslationL, cameraL.scale.x);\n            cameraR.translateOnAxis(eyeTranslationR, cameraR.scale.x);\n\n            if (vrDisplay.getFrameData) {\n\n                vrDisplay.depthNear = camera.near;\n                vrDisplay.depthFar = camera.far;\n\n                vrDisplay.getFrameData(frameData);\n\n                cameraL.projectionMatrix.elements = frameData.leftProjectionMatrix;\n                cameraR.projectionMatrix.elements = frameData.rightProjectionMatrix;\n\n            } else {\n\n                cameraL.projectionMatrix = fovToProjection(eyeParamsL.fieldOfView, true, camera.near, camera.far);\n                cameraR.projectionMatrix = fovToProjection(eyeParamsR.fieldOfView, true, camera.near, camera.far);\n\n            }\n\n            // render left eye\n            if (renderTarget) {\n\n                renderTarget.viewport.set(renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height);\n                renderTarget.scissor.set(renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height);\n\n            } else {\n\n                renderer.setViewport(renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height);\n                renderer.setScissor(renderRectL.x, renderRectL.y, renderRectL.width, renderRectL.height);\n\n            }\n            renderer.render(scene, cameraL, renderTarget, forceClear);\n\n            // render right eye\n            if (renderTarget) {\n\n                renderTarget.viewport.set(renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height);\n                renderTarget.scissor.set(renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height);\n\n            } else {\n\n                renderer.setViewport(renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height);\n                renderer.setScissor(renderRectR.x, renderRectR.y, renderRectR.width, renderRectR.height);\n\n            }\n            renderer.render(scene, cameraR, renderTarget, forceClear);\n\n            if (renderTarget) {\n\n                renderTarget.viewport.set(0, 0, size.width, size.height);\n                renderTarget.scissor.set(0, 0, size.width, size.height);\n                renderTarget.scissorTest = false;\n                renderer.setRenderTarget(null);\n\n            } else {\n\n                renderer.setViewport(0, 0, size.width, size.height);\n                renderer.setScissorTest(false);\n\n            }\n\n            if (autoUpdate) {\n\n                scene.autoUpdate = true;\n\n            }\n\n            if (scope.autoSubmitFrame) {\n\n                scope.submitFrame();\n\n            }\n\n            return;\n\n        }\n\n        // Regular render mode if not HMD\n\n        renderer.render(scene, camera, renderTarget, forceClear);\n\n    };\n\n    this.dispose = function () {\n\n        window.removeEventListener('vrdisplaypresentchange', onVRDisplayPresentChange, false);\n\n    };\n\n    //\n\n    function fovToNDCScaleOffset(fov) {\n\n        var pxscale = 2.0 / ( fov.leftTan + fov.rightTan );\n        var pxoffset = ( fov.leftTan - fov.rightTan ) * pxscale * 0.5;\n        var pyscale = 2.0 / ( fov.upTan + fov.downTan );\n        var pyoffset = ( fov.upTan - fov.downTan ) * pyscale * 0.5;\n        return {scale: [pxscale, pyscale], offset: [pxoffset, pyoffset]};\n\n    }\n\n    function fovPortToProjection(fov, rightHanded, zNear, zFar) {\n\n        rightHanded = rightHanded === undefined ? true : rightHanded;\n        zNear = zNear === undefined ? 0.01 : zNear;\n        zFar = zFar === undefined ? 10000.0 : zFar;\n\n        var handednessScale = rightHanded ? -1.0 : 1.0;\n\n        // start with an identity matrix\n        var mobj = new THREE.Matrix4();\n        var m = mobj.elements;\n\n        // and with scale/offset info for normalized device coords\n        var scaleAndOffset = fovToNDCScaleOffset(fov);\n\n        // X result, map clip edges to [-w,+w]\n        m[0 * 4 + 0] = scaleAndOffset.scale[0];\n        m[0 * 4 + 1] = 0.0;\n        m[0 * 4 + 2] = scaleAndOffset.offset[0] * handednessScale;\n        m[0 * 4 + 3] = 0.0;\n\n        // Y result, map clip edges to [-w,+w]\n        // Y offset is negated because this proj matrix transforms from world coords with Y=up,\n        // but the NDC scaling has Y=down (thanks D3D?)\n        m[1 * 4 + 0] = 0.0;\n        m[1 * 4 + 1] = scaleAndOffset.scale[1];\n        m[1 * 4 + 2] = -scaleAndOffset.offset[1] * handednessScale;\n        m[1 * 4 + 3] = 0.0;\n\n        // Z result (up to the app)\n        m[2 * 4 + 0] = 0.0;\n        m[2 * 4 + 1] = 0.0;\n        m[2 * 4 + 2] = zFar / ( zNear - zFar ) * -handednessScale;\n        m[2 * 4 + 3] = ( zFar * zNear ) / ( zNear - zFar );\n\n        // W result (= Z in)\n        m[3 * 4 + 0] = 0.0;\n        m[3 * 4 + 1] = 0.0;\n        m[3 * 4 + 2] = handednessScale;\n        m[3 * 4 + 3] = 0.0;\n\n        mobj.transpose();\n        return mobj;\n\n    }\n\n    function fovToProjection(fov, rightHanded, zNear, zFar) {\n\n        var DEG2RAD = Math.PI / 180.0;\n\n        var fovPort = {\n            upTan: Math.tan(fov.upDegrees * DEG2RAD),\n            downTan: Math.tan(fov.downDegrees * DEG2RAD),\n            leftTan: Math.tan(fov.leftDegrees * DEG2RAD),\n            rightTan: Math.tan(fov.rightDegrees * DEG2RAD)\n        };\n\n        return fovPortToProjection(fovPort, rightHanded, zNear, zFar);\n\n    }\n\n}\n\nexport default VREffect;\n\n\n\n// WEBPACK FOOTER //\n// ./src/vr/effect.js","import RollerCoasterGeometry from './geometries/roller-coaster';\nimport VRControl from './vr/control';\nimport VREffect from './vr/effect';\nimport { isWebVRAvailable, getHelpMessageElement } from './vr/utils';\n\nif (!isWebVRAvailable()) {\n    getHelpMessageElement((element) => {\n        document.body.appendChild(element);\n    });\n}\n\nconst renderer = new THREE.WebGLRenderer({ antialias: true });\nrenderer.setClearColor(0xf0f0ff);\nrenderer.setPixelRatio(window.devicePixelRatio);\nrenderer.setSize(window.innerWidth, window.innerHeight);\n\ndocument.body.appendChild(renderer.domElement);\n\nconst scene = new THREE.Scene();\n\n// Light\nconst light = new THREE.HemisphereLight(0xfff0f0, 0x606066);\nlight.position.set(1, 1, 1);\nscene.add(light);\n\n// Train\nconst train = new THREE.Object3D();\nscene.add(train);\nconst camera = new THREE.PerspectiveCamera(40, window.innerWidth / window.innerHeight, 0.1, 500);\ntrain.add(camera);\n\n// Roller coaster rail\nconst PI2 = Math.PI * 2;\nconst curve = (() => {\n    const v1 = new THREE.Vector3();\n    const v2 = new THREE.Vector3();\n\n    return {\n        getPointAt(t) {\n            const p = t * PI2;\n\n            const x = Math.sin(p * 3) * Math.cos(p * 4) * 50;\n            const y = Math.sin(p * 10) * 2 + Math.cos(p * 17) * 2 + 5;\n            const z = Math.sin(p) * Math.sin(p * 4) * 50;\n\n            return v1.set(x, y, z).multiplyScalar(2);\n        },\n\n        getTangentAt(t) {\n            const delta = 0.00001;\n\n            const t1 = Math.max(0, t - delta);\n            const t2 = Math.min(1, t + delta);\n\n            return v2\n                .copy(this.getPointAt(t2))\n                .sub(this.getPointAt(t1))\n                .normalize();\n        }\n    }\n})();\n\nconst rollerCoasterGeometry = new RollerCoasterGeometry(curve, 1500);\nconst material = new THREE.MeshPhongMaterial({\n    vertexColors: THREE.VertexColors\n});\nconst mesh = new THREE.Mesh(rollerCoasterGeometry, material);\nscene.add(mesh);\n\n// VR\nconst control = new VRControl(camera);\nconst effect = new VREffect(renderer);\n\ncontrol.init();\n\nwindow.addEventListener('resize', () => {\n    camera.aspect = window.innerWidth / window.innerHeight;\n    camera.updateProjectionMatrix();\n    effect.setSize(window.innerWidth, window.innerHeight);\n});\n\n\n// Animation\nconst position = new THREE.Vector3();\nconst tangent = new THREE.Vector3();\nconst lookAt = new THREE.Vector3();\n\nlet velocity = 0;\nlet progress = 0;\nlet prevTime = window.performance.now();\n\nfunction animate(time) {\n    effect.requestAnimationFrame(animate);\n\n    const delta = time - prevTime;\n\n    progress += velocity;\n    progress = progress % 1;\n    position.copy(curve.getPointAt(progress));\n    position.y += 0.3;\n    train.position.copy(position);\n    tangent.copy(curve.getTangentAt(progress));\n    velocity -= tangent.y * 0.0000001 * delta;\n    velocity = Math.max(0.00001, Math.min(0.0002, velocity));\n    train.lookAt(lookAt.copy(position).sub(tangent));\n\n    control.update();\n    effect.render(scene, camera);\n\n    prevTime = time;\n}\n\neffect.requestAnimationFrame(animate);\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}